//事前検証自動入力
javascript:(function(){
	/*問1.キーボード（Tabキー）でコンテンツ移動、フォーカスしただけで状況が変化するコンテンツがありますか？*/
	document.getElementsByName("16")[1].checked=true;
	/*問2.ページタイトルは適切ですか？*/
	document.getElementsByName("17")[0].checked=true;
	/*問3.言語属性は正しく設定されていますか？*/
	document.getElementsByName("18")[0].checked=true;
	/*問4.形、大きさ、位置、方向、又は音など、感覚的な特徴で情報を伝えているものはありますか？*/
	document.getElementsByName("19")[1].checked=true;
	/*問5.上下階層のページと比較して、サイト全体のナビゲーション位置が統一していますか？*/
	document.getElementsByName("20")[0].checked=true;
	/*問6.上下階層のページと比較して、ダウンロードアイコン、印刷アイコン、保存アイコンなどがサイトで統一（代替えテキスト）していますか？*/
	document.getElementsByName("21")[0].checked=true;
	/*問7.利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行うページですか？*/
	document.getElementsByName("22")[1].checked=true;
	/*問8.W3Cバリデータ等のツールを使用してHTML構文のチェックを行って下さい。その結果、問題は検知されましたか？*/
	document.getElementsByName("23")[0].checked=true;
	/*問9.リニアライズ（線形化）したときに、コンテンツは意味のある順序となっていますか？*/
	document.getElementsByName("24")[0].checked=true;
	/*問10.簡潔な代替えテキストに加え、長い説明が必要な非テキストコンテンツ（例えば、グラフやチャートなど）はありますか?*/
	document.getElementsByName("2")[0].checked=true;
	/*問11.ライブカメラの映像コンテンツを含んでいますか？*/
	document.getElementsByName("6")[1].checked=true;
	/*問12.実況による音声コンテンツを含んでいますか？*/
	document.getElementsByName("7")[1].checked=true;
	/*問13.画像のスライドショーやアニメーションGIFを含んでいますか？*/
	document.getElementsByName("5")[1].checked=true;
	/*問14.再生用の動画コンテンツを含んでいますか？*/
	document.getElementsByName("8")[1].checked=true;
	/*問15.再生用の音声コンテンツまたは自動再生のBGM音声を含んでいますか？*/
	document.getElementsByName("9")[1].checked=true;
	/*問16.スクロール・点滅・移動などをする情報を含んでいますか？*/
	document.getElementsByName("10")[1].checked=true;
	/*問17.時間の経過によってページが自動更新されたり、アラートが表示される、または制限時間付きのコンテンツを含んでいますか？*/
	document.getElementsByName("11")[1].checked=true;
	/*問18.検索キーワード入力欄（フィールド）を含んでいますか？*/
	document.getElementsByName("12")[0].checked=true;
	/*問19.テキスト入力フィールド(お問合せ登録・ログイン認証・申し込みなど)やラジオボタン、チェックボックス、またはセレクトリストなどの選択要素を含んでいますか？*/
	document.getElementsByName("13")[1].checked=true;
	/*問20.ユーザ登録時などに使用される、正しい回答を記入するためのCAPTCHAテストを含んでいますか？*/
	document.getElementsByName("14")[1].checked=true;
	/*問21.コンテンツがテキスト（非HTML）だけのページですか？*/
	document.getElementsByName("25")[1].checked=true;
})();

javascript:(function(){/*問1.キーボード（Tabキー）でコンテンツ移動、フォーカスしただけで状況が変化するコンテンツがありますか？*/document.getElementsByName("16")[1].checked=true;/*問2.ページタイトルは適切ですか？*/document.getElementsByName("17")[0].checked=true;/*問3.言語属性は正しく設定されていますか？*/document.getElementsByName("18")[0].checked=true;/*問4.形、大きさ、位置、方向、又は音など、感覚的な特徴で情報を伝えているものはありますか？*/document.getElementsByName("19")[1].checked=true;/*問5.上下階層のページと比較して、サイト全体のナビゲーション位置が統一していますか？*/document.getElementsByName("20")[0].checked=true;/*問6.上下階層のページと比較して、ダウンロードアイコン、印刷アイコン、保存アイコンなどがサイトで統一（代替えテキスト）していますか？*/document.getElementsByName("21")[0].checked=true;/*問7.利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行うページですか？*/document.getElementsByName("22")[1].checked=true;/*問8.W3Cバリデータ等のツールを使用してHTML構文のチェックを行って下さい。その結果、問題は検知されましたか？*/document.getElementsByName("23")[0].checked=true;/*問9.リニアライズ（線形化）したときに、コンテンツは意味のある順序となっていますか？*/document.getElementsByName("24")[0].checked=true;/*問10.簡潔な代替えテキストに加え、長い説明が必要な非テキストコンテンツ（例えば、グラフやチャートなど）はありますか?*/document.getElementsByName("2")[1].checked=true;/*問11.ライブカメラの映像コンテンツを含んでいますか？*/document.getElementsByName("6")[1].checked=true;/*問12.実況による音声コンテンツを含んでいますか？*/document.getElementsByName("7")[1].checked=true;/*問13.画像のスライドショーやアニメーションGIFを含んでいますか？*/document.getElementsByName("5")[1].checked=true;/*問14.再生用の動画コンテンツを含んでいますか？*/document.getElementsByName("8")[1].checked=true;/*問15.再生用の音声コンテンツまたは自動再生のBGM音声を含んでいますか？*/document.getElementsByName("9")[1].checked=true;/*問16.スクロール・点滅・移動などをする情報を含んでいますか？*/document.getElementsByName("10")[1].checked=true;/*問17.時間の経過によってページが自動更新されたり、アラートが表示される、または制限時間付きのコンテンツを含んでいますか？*/document.getElementsByName("11")[1].checked=true;/*問18.検索キーワード入力欄（フィールド）を含んでいますか？*/document.getElementsByName("12")[0].checked=true;/*問19.テキスト入力フィールド(お問合せ登録・ログイン認証・申し込みなど)やラジオボタン、チェックボックス、またはセレクトリストなどの選択要素を含んでいますか？*/document.getElementsByName("13")[0].checked=true;/*問20.ユーザ登録時などに使用される、正しい回答を記入するためのCAPTCHAテストを含んでいますか？*/document.getElementsByName("14")[1].checked=true;/*問21.コンテンツがテキスト（非HTML）だけのページですか？*/document.getElementsByName("25")[1].checked=true;})();


//事前検証個別
javascript:(function(){
	/*問13.画像のスライドショーやアニメーションGIFを含んでいますか？*/
document.getElementsByName("5")[0].checked=true;
})();

javascript:(function(){/*問13.画像のスライドショーやアニメーションGIFを含んでいますか？*/document.getElementsByName("5")[0].checked=true;})();

javascript:(function(){
	/*問8.W3Cバリデータ等のツールを使用してHTML構文のチェックを行って下さい。その結果、問題は検知されましたか？*/
	javascript:document.getElementsByName("23")[1].checked=true;
})();

javascript:(function(){/*問8.W3Cバリデータ等のツールを使用してHTML構文のチェックを行って下さい。その結果、問題は検知されましたか？*/javascript:document.getElementsByName("23")[1].checked=true;})();

javascript:(function(){
	javascript:document.getElementsByName("13")[0].checked=true;
	/*問19.テキスト入力フィールド(お問合せ登録・ログイン認証・申し込みなど)やラジオボタン、チェックボックス、またはセレクトリストなどの選択要素を含んでいますか？*/
})();

javascript:(function(){javascript:document.getElementsByName("13")[0].checked=true;/*問19.テキスト入力フィールド(お問合せ登録・ログイン認証・申し込みなど)やラジオボタン、チェックボックス、またはセレクトリストなどの選択要素を含んでいますか？*/})();
	

//LibraのプロジェクトIDを取得する
javascript:(function(){
	var%20url=window.location.href;
	var%20arr=url.match(/projID\/(.+)\/controlID/);
	alert(arr[1]);
})();

javascript:(function(){var%20url=window.location.href;var%20length=url.length;var%20pt=url.lastIndexOf("/controlID");var%20id=url.substr(pt+1);alert(id);})();


//PDFリンクであることが明示されていない自動判定
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){
			return document.getElementById("comments").value;
		},
		set_comment: function(str){
			document.getElementById("comments").value = str;
		},
		get_description: function(){
			return document.getElementById("description").value;
		},
		set_description: function(str){
			document.getElementById("description").value = str;
		},
		get_srccode: function(){
			return document.getElementById("srccode").value;
		},
		set_srccode: function(str){
			document.getElementById("srccode").value = str;
		},
		click_for: function(flag) {
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].value;
				if(obj==flag){
					form.elements[i].click();
					break;
				}
			}
		},
		click_for_submit: function(){
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].type;
				if(obj=="submit"){
					form.elements[i].click();
					break;
				}
			}
		},
		text_clean: function(str){
		    str=str.replace(/^ +/m,"");
		    str=str.replace(/\t+/m,"");
		    str=str.replace(/(\r\n|\r|\n)/g,""); 
		    return str;
		},
		set_height: function(tg, ht){
			var src = document.getElementById(tg);
			src.setAttribute("style", "height:"+ht+"em;");
		}
	};
	/* Dialog Class End */
	var RDMType = "icon";/*icon_text*/
	var MyDiag = Object(Diag);
	MyDiag.click_for("FAIL");
	MyDiag.set_comment("PDFリンクであることが明示されていない");
	var srccode = MyDiag.get_srccode();
	switch(RDMType){
		case "icon":
			srccode = srccode.replace('</a>','<img width="15" height="15" src="/main_content/000000011.gif" alt="PDF" /></a>');
			break;
		default:
			srccode = srccode.replace('</a>','(PDF)</a>');
			break;
	}
	MyDiag.set_srccode(srccode);
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},set_height: function(tg, ht){var src = document.getElementById(tg);src.setAttribute("style", "height:"+ht+"em;");}};/* Dialog Class End */var RDMType = "icon";/*icon_text*/var MyDiag = Object(Diag);MyDiag.click_for("FAIL");MyDiag.set_comment("PDFリンクであることが明示されていない");var srccode = MyDiag.get_srccode();switch(RDMType){case "icon":srccode = srccode.replace('</a>','<img width="15" height="15" src="/main_content/000000011.gif" alt="PDF" /></a>');break;default:srccode = srccode.replace('</a>','(PDF)</a>');break;}MyDiag.set_srccode(srccode);})();


//PDFアイコン・ラベルがリンク内に入っていない自動判定
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){
			return document.getElementById("comments").value;
		},
		set_comment: function(str){
			document.getElementById("comments").value = str;
		},
		get_description: function(){
			return document.getElementById("description").value;
		},
		set_description: function(str){
			document.getElementById("description").value = str;
		},
		get_srccode: function(){
			return document.getElementById("srccode").value;
		},
		set_srccode: function(str){
			document.getElementById("srccode").value = str;
		},
		click_for: function(flag) {
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].value;
				if(obj==flag){
					form.elements[i].click();
					break;
				}
			}
		},
		click_for_submit: function(){
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].type;
				if(obj=="submit"){
					form.elements[i].click();
					break;
				}
			}
		},
		text_clean: function(str){
		    str=str.replace(/^ +/m,"");
		    str=str.replace(/\t+/m,"");
		    str=str.replace(/(\r\n|\r|\n)/g,""); 
		    return str;
		},
		set_height: function(tg, ht){
			var src = document.getElementById(tg);
			src.setAttribute("style", "height:"+ht+"em;");
		}
	};
	/* Dialog Class End */
	var RDMType = "";
	var MyDiag = Object(Diag);
	MyDiag.click_for("FAIL");
	var srccode = MyDiag.get_srccode();
	switch(RDMType){
		case "icon":
			MyDiag.set_comment("PDFアイコンがリンクの中に含まれていない");
			srccode = srccode.replace('</a>','<img width="15" height="15" src="/main_content/000000011.gif" alt="PDF" /></a>');
			break;
		default:
			MyDiag.set_comment("PDFリンクを示すラベルがリンクの中に含まれていない");
			srccode = srccode.replace('</a>','(PDF)</a>');
			break;
	}
	MyDiag.set_srccode(srccode);
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},set_height: function(tg, ht){var src = document.getElementById(tg);src.setAttribute("style", "height:"+ht+"em;");}};/* Dialog Class End */var RDMType = "";var MyDiag = Object(Diag);MyDiag.click_for("FAIL");var srccode = MyDiag.get_srccode();switch(RDMType){case "icon":MyDiag.set_comment("PDFアイコンがリンクの中に含まれていない");srccode = srccode.replace('</a>','<img width="15" height="15" src="/main_content/000000011.gif" alt="PDF" /></a>');break;default:MyDiag.set_comment("PDFリンクを示すラベルがリンクの中に含まれていない");srccode = srccode.replace('</a>','(PDF)</a>');break;}MyDiag.set_srccode(srccode);})();

//xhtmlでtarget属性を使っている場合の自動判定
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){
			return document.getElementById("comments").value;
		},
		set_comment: function(str){
			document.getElementById("comments").value = str;
		},
		get_description: function(){
			return document.getElementById("description").value;
		},
		set_description: function(str){
			document.getElementById("description").value = str;
		},
		get_srccode: function(){
			return document.getElementById("srccode").value;
		},
		set_srccode: function(str){
			document.getElementById("srccode").value = str;
		},
		click_for: function(flag) {
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].value;
				if(obj==flag){
					form.elements[i].click();
					break;
				}
			}
		},
		click_for_submit: function(){
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].type;
				if(obj=="submit"){
					form.elements[i].click();
					break;
				}
			}
		},
		text_clean: function(str){
		    str=str.replace(/^ +/m,"");
		    str=str.replace(/\t+/m,"");
		    str=str.replace(/(\r\n|\r|\n)/g,""); 
		    return str;
		},
		set_height: function(tg, ht){
			var src = document.getElementById(tg);
			src.setAttribute("style", "height:"+ht+"em;");
		}
	};
	/* Dialog Class End */
	var RDMType = "";
	var MyDiag = Object(Diag);
	MyDiag.set_srccode("");
	MyDiag.click_for("FAIL");
	var srccode = MyDiag.get_srccode();
	MyDiag.set_comment("XHTML1.1ではtarget属性は無いため削除する（7.4.1.1参照）。リンクアイコンはCSS背景ではなくimg要素で埋め込むべき。");
	var pat = new RegExp(/ target=".+?"/);
	srccode = srccode.replace(pat, "");
	srccode = srccode.replace("（別ウィンドウで開きます）", "");
	MyDiag.set_srccode(srccode);
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},set_height: function(tg, ht){var src = document.getElementById(tg);src.setAttribute("style", "height:"+ht+"em;");}};/* Dialog Class End */var RDMType = "";var MyDiag = Object(Diag);MyDiag.set_srccode("");MyDiag.click_for("FAIL");var srccode = MyDiag.get_srccode();MyDiag.set_comment("XHTML1.1ではtarget属性は無いため削除する（7.4.1.1参照）。リンクアイコンはCSS背景ではなくimg要素で埋め込むべき。");var pat = new RegExp(/ target=".+?"/);srccode = srccode.replace(pat, "");srccode = srccode.replace("（別ウィンドウで開きます）", "");MyDiag.set_srccode(srccode);})();

//xhtm1．lでtarget属性を消し、コメントを差し替え
javascript:(function(){
	var comments = document.getElementById("comments").value;
	var srccode = document.getElementById("srccode").value;
	var pat = new RegExp(/ target=".+?"/);
	srccode = srccode.replace(pat, "");
	comments = comments.replace("別ウィンドウで開くことを説明していない", "XHTML1.1ではtarget属性は無いため削除する（7.4.1.1参照）");
	document.getElementById("comments").value = comments;
	document.getElementById("srccode").value = srccode;
})();

javascript:(function(){var comments = document.getElementById("comments").value;var srccode = document.getElementById("srccode").value;var pat = new RegExp(/ target=".+?"/);srccode = srccode.replace(pat, "");comments = comments.replace("別ウィンドウで開くことを説明していない", "XHTML1.1ではtarget属性は無いため削除する（7.4.1.1参照）");document.getElementById("comments").value = comments;document.getElementById("srccode").value = srccode;})();

//xhtmlでtarget属性を使っている場合＆alt空にすべきの自動判定
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){
			return document.getElementById("comments").value;
		},
		set_comment: function(str){
			document.getElementById("comments").value = str;
		},
		get_description: function(){
			return document.getElementById("description").value;
		},
		set_description: function(str){
			document.getElementById("description").value = str;
		},
		get_srccode: function(){
			return document.getElementById("srccode").value;
		},
		set_srccode: function(str){
			document.getElementById("srccode").value = str;
		},
		click_for: function(flag) {
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].value;
				if(obj==flag){
					form.elements[i].click();
					break;
				}
			}
		},
		click_for_submit: function(){
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].type;
				if(obj=="submit"){
					form.elements[i].click();
					break;
				}
			}
		},
		text_clean: function(str){
		    str=str.replace(/^ +/m,"");
		    str=str.replace(/\t+/m,"");
		    str=str.replace(/(\r\n|\r|\n)/g,""); 
		    return str;
		},
		set_height: function(tg, ht){
			var src = document.getElementById(tg);
			src.setAttribute("style", "height:"+ht+"em;");
		}
	};
	/* Dialog Class End */
	var RDMType = "";
	var MyDiag = Object(Diag);
	MyDiag.click_for("FAIL");
	var srccode = MyDiag.get_srccode();
	MyDiag.set_comment("XHTML1.1ではtarget属性は無いため削除する（7.4.1.1参照）。リンクアイコンはCSS背景ではなくimg要素で埋め込むべき。alt属性を空にすべき。");
	var pat = new RegExp(/ target=".+?"/);
	srccode = srccode.replace(pat, "");
	var patalt = new RegExp(/ alt=".+?"/);
	srccode = srccode.replace(patalt, ' alt=""');
	srccode = srccode.replace("（別ウィンドウで開きます）", "");
	MyDiag.set_srccode(srccode);
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},set_height: function(tg, ht){var src = document.getElementById(tg);src.setAttribute("style", "height:"+ht+"em;");}};/* Dialog Class End */var RDMType = "";var MyDiag = Object(Diag);MyDiag.click_for("FAIL");var srccode = MyDiag.get_srccode();MyDiag.set_comment("XHTML1.1ではtarget属性は無いため削除する（7.4.1.1参照）。リンクアイコンはCSS背景ではなくimg要素で埋め込むべき。alt属性を空にすべき。");var pat = new RegExp(/ target=".+?"/);srccode = srccode.replace(pat, "");var patalt = new RegExp(/ alt=".+?"/);srccode = srccode.replace(patalt, ' alt=""');srccode = srccode.replace("（別ウィンドウで開きます）", "");MyDiag.set_srccode(srccode);})();

//達成基準番号をコピペ
javascript:(function(){
	var%20element=document.getElementById("guideline");
	for(var%20i=0;i<element.options.length;i++){
		var%20url=element.options[i].text;
		if(element.options[i].selected){
			prompt("達成基準番号",element.options[i].text)
		}
	}
})();

javascript:(function(){var%20element=document.getElementById("guideline");for(var%20i=0;i<element.options.length;i++){var%20url=element.options[i].text;if(element.options[i].selected){prompt("達成基準番号",element.options[i].text)}}})();

//実装番号をコピペ
javascript:(function(){
	var%20element=document.getElementById("techList");
	for(var%20i=0;i<element.options.length;i++){
		var%20url=element.options[i].text;
		if(element.options[i].selected){
			prompt("実装番号",element.options[i].text);
			break;
		}
	}
})();

javascript:(function(){var%20element=document.getElementById("techList");for(var%20i=0;i<element.options.length;i++){var%20url=element.options[i].text;if(element.options[i].selected){prompt("実装番号",element.options[i].text);break;}}})();

//達成基準番号と実装番号をコピペ
javascript:(function(){
	var%20gtxt="";
	var%20ttxt="";
	var%20element=document.getElementById("guideline");
	for(var%20i=0;i<element.options.length;i++){
		var%20url=element.options[i].text;
		if(element.options[i].selected){
			gtxt=element.options[i].text;
			break;
		}
	}
	var%20element2=document.getElementById("techList");
	for(var%20i=0;i<element2.options.length;i++){
		var%20url=element2.options[i].text;
		if(element2.options[i].selected){
			ttxt=element2.options[i].text;
			break;
		}
	}
	var%20ret1=gtxt.match(/(.*)(【完】)/);
	prompt("達成基準：実装番号",ret1[0]+ttxt);
})();

javascript:(function(){var%20gtxt="";var%20ttxt="";var%20element=document.getElementById("guideline");for(var%20i=0;i<element.options.length;i++){var%20url=element.options[i].text;if(element.options[i].selected){gtxt=element.options[i].text;break;}}var%20element2=document.getElementById("techList");for(var%20i=0;i<element2.options.length;i++){var%20url=element2.options[i].text;if(element2.options[i].selected){ttxt=element2.options[i].text;break;}}var%20ret1=gtxt.match(/(.*)(【完】)/);prompt("達成基準：実装番号",ret1[0]+ttxt);})();


//番号を指定してURLを開く
javascript:(function(){
	var%20prmt=prompt("番号を入力");
	var%20tar=prmt.toString();
	var%20pat=new%20RegExp(".*was"+tar+".*");
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		var%20url=element.options[i].text;
		if(url.match(pat)){
			element.options[i].selected=true;
		}
	}
	document.getElementById("submitURL").click();
})();

javascript:(function(){var%20prmt=prompt("番号を入力");var%20tar=prmt.toString();var%20pat=new%20RegExp(".*was"+tar+".*");var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){var%20url=element.options[i].text;if(url.match(pat)){element.options[i].selected=true;}}document.getElementById("submitURL").click();})();


//V2
javascript:(function(){
	var prmt=prompt("URL番号を入力");
	var tar=prmt.toString();
	var pat=new RegExp("\[[a-zA-Z]*"+tar+"\]");
	var flg = false;
	var element = document.getElementById("urlList");
	for(var i=0;i<element.options.length;i++){
		var url=element.options[i].text;
		var url_nm = get_pageid(url);
		var arr = url_nm.match(pat);
		if(arr!=null){
			element.options[i].selected=true;
			flg = true;
			break;
		}
	}
	if(flg){
		document.getElementById("submitURL").click();
	}else{
		alert("存在しないURL番号です！");
	}
	function get_pageid(str){
		var new_str = "";
		var pat = new RegExp(/\[.*?\]/);
		var arr = str.match(pat);
		if(arr!=null){
			new_str += arr[0].toString();
		}
		return new_str;
	}
})();

javascript:(function(){var prmt=prompt("URL番号を入力");var tar=prmt.toString();var pat=new RegExp("\[[a-zA-Z]*"+tar+"\]");var flg = false;var element = document.getElementById("urlList");for(var i=0;i<element.options.length;i++){var url=element.options[i].text;var url_nm = get_pageid(url);var arr = url_nm.match(pat);if(arr!=null){element.options[i].selected=true;flg = true;break;}}if(flg){document.getElementById("submitURL").click();}else{alert("存在しないURL番号です！");}function get_pageid(str){var new_str = "";var pat = new RegExp(/\[.*?\]/);var arr = str.match(pat);if(arr!=null){new_str += arr[0].toString();}return new_str;}})();

//V3
javascript:(function(){
	var prmt=prompt("URL番号を入力");
	var tar=prmt.toString();
	var flg = false;
	var element = document.getElementById("urlList");
	for(var i=0;i<element.options.length;i++){
			var url=element.options[i].text;
			var url_nm = get_pageid(url);
			var pat=new RegExp("[a-zA-Z]*?"+tar);
			var arr = url_nm.match(pat);
			if(arr!==null){
				element.options[i].selected=true;
				flg = true;
				break;
			}
	}
	if(flg){
		document.getElementById("submitURL").click();
	}else{
		alert("存在しないURL番号です！");
	}
	function get_pageid(str){
		var new_str = "";
		var pat = new RegExp(/\[(.+?)\]/);
		var arr = str.match(pat);
		if(arr!=null){
			new_str += arr[1].toString();
		}
		return new_str;
	}
})();

javascript:(function(){var prmt=prompt("URL番号を入力");var tar=prmt.toString();var flg = false;var element = document.getElementById("urlList");for(var i=0;i<element.options.length;i++){var url=element.options[i].text;var url_nm = get_pageid(url);var pat=new RegExp("[a-zA-Z]*?"+tar);var arr = url_nm.match(pat);if(arr!==null){element.options[i].selected=true;flg = true;break;}}if(flg){document.getElementById("submitURL").click();}else{alert("存在しないURL番号です！");}function get_pageid(str){var new_str = "";var pat = new RegExp(/\[(.+?)\]/);var arr = str.match(pat);if(arr!=null){new_str += arr[1].toString();}return new_str;}})();


//診断対象ページを別タブで開く
javascript:(function(){
	var%20element=document.getElementById("urlList");
	var%20url="";
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			url=element.options[i].text;
		}
	}
	var%20arr=url.match(/(.*)(http.+)/);
	window.open(arr[2],"_blank");
})();

javascript:(function(){var%20element=document.getElementById("urlList");var%20url="";for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){url=element.options[i].text;}}var%20arr=url.match(/(.*)(http.+)/);window.open(arr[2],"_blank");})();


//V2
javascript:(function(){
	var%20url="";
	var%20element=document.getElementById("urlList");
	if(element){
		for(var%20i=0;i<element.options.length;i++){
			if(element.options[i].selected){
				url=element.options[i].text;
			}
		}
	}else{
		url=document.getElementById("url2").value;
	}
	var%20arr=url.match(/(.*)(http.+)/);
	window.open(arr[2],"_blank");
})();

javascript:(function(){var%20url="";var%20element=document.getElementById("urlList");if(element){for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){url=element.options[i].text;}}}else{url=document.getElementById("url2").value;}var%20arr=url.match(/(.*)(http.+)/);window.open(arr[2],"_blank");})();



//適合判定
javascript:(function(){
	var%20form=document.forms["diag_form"];
	form.elements["result"][0].checked=true;
	document.getElementById("comments").value="";
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var%20form=document.forms["diag_form"];form.elements["result"][0].checked=true;document.getElementById("comments").value="";for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

//V2
javascript:(function(){
	var%20form=document.forms["diag_form"];
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].value;
		if(obj=="PASS"){
			form.elements[i].click();
			break;
		}
	}
	document.getElementById("comments").value="";
	if(document.getElementById("srccode")!=null){
		document.getElementById("srccode").value="";
	}
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var%20form=document.forms["diag_form"];for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].value;if(obj=="PASS"){form.elements[i].click();break;}}document.getElementById("comments").value="";if(document.getElementById("srccode")!=null){document.getElementById("srccode").value="";}for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

//非適用判定
javascript:(function(){
	var%20form=document.forms["diag_form"];
	form.elements["result"][4].checked=true;
	document.getElementById("comments").value="判定すべき対象コンテンツが使用されていない";
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var%20form=document.forms["diag_form"];form.elements["result"][4].checked=true;document.getElementById("comments").value="判定すべき対象コンテンツが使用されていない";for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

//V2
javascript:(function(){
	var%20form=document.forms["diag_form"];
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].value;
		if(obj=="NA"){
			form.elements[i].click();
			break;
		}
	}
	document.getElementById("comments").value="判定すべき対象コンテンツが使用されていない";
	if(document.getElementById("srccode")!=null){
		document.getElementById("srccode").value="";
	}
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var%20form=document.forms["diag_form"];for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].value;if(obj=="NA"){form.elements[i].click();break;}}document.getElementById("comments").value="判定すべき対象コンテンツが使用されていない";for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

javascript:(function(){var%20form=document.forms["diag_form"];for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].value;if(obj=="NA"){form.elements[i].click();break;}}document.getElementById("comments").value="判定すべき対象コンテンツが使用されていない";if(document.getElementById("srccode")!=null){document.getElementById("srccode").value="";}for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

//適合注記判定
javascript:(function(){
	var%20form=document.forms["diag_form"];
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].value;
		if(obj=="PASS2"){
			form.elements[i].click();
			break;
		}
	}
	var msg = prompt("判定コメントを入力");
	document.getElementById("comments").value=msg;
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var%20form=document.forms["diag_form"];for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].value;if(obj=="PASS2"){form.elements[i].click();break;}}var msg = prompt("判定コメントを入力");document.getElementById("comments").value=msg;for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

//不適合判定
javascript:(function(){
	var%20form=document.forms["diag_form"];
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].value;
		if(obj=="FAIL"){
			form.elements[i].click();
			break;
		}
	}
	var msg = prompt("判定コメントを入力");
	document.getElementById("comments").value=msg;
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var%20form=document.forms["diag_form"];for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].value;if(obj=="FAIL"){form.elements[i].click();break;}}var msg = prompt("判定コメントを入力");document.getElementById("comments").value=msg;for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

//V2
javascript:(function(){
	var cmm="empty";
	var form=document.forms["diag_form"];
	for(var i=0;i<form.elements.length;i++){
		var obj=form.elements[i].value;
		if(obj=="FAIL"){
			form.elements[i].click();
			break;
		}
	}
	var msg = prompt("判定コメントを入力");
	document.getElementById("comments").value=msg;
	if(cmm=="empty") document.getElementById("srccode").value="";
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var cmm="empty";var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="FAIL"){form.elements[i].click();break;}}var msg = prompt("判定コメントを入力");document.getElementById("comments").value=msg;if(cmm=="empty") document.getElementById("srccode").value="";for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();


//G94ソースコードで選択imgタグの画像を別タブで開く
javascript:(function(){
	var%20urlval="";
	var%20url="";
	var%20imgtag="";
	var%20imgsrc="";
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;
			break;
		}
	}
	var%20a1=urlval.match(/http.*\/\/.*?\//);
	url=a1[0].toString();
	imgtag=window.getSelection().toString();
	var%20a2=imgtag.match(/src=\"*(.*?)\"/);
	imgsrc=a2[1].toString();
	if(imgsrc.match(/http.*/)){
		alert("src属性値がhttp、httpsで始まる場合、対応できません。手動で確認ください。");
	}else{
		window.open(url+imgsrc,"_blank");
	}
})();

javascript:(function(){var%20urlval="";var%20url="";var%20imgtag="";var%20imgsrc="";var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var%20a1=urlval.match(/http.*\/\/.*?\//);url=a1[0].toString();imgtag=window.getSelection().toString();var%20a2=imgtag.match(/src=\"*(.*?)\"/);imgsrc=a2[1].toString();if(imgsrc.match(/http.*/)){alert("src属性値がhttp、httpsで始まる場合、対応できません。手動で確認ください。");}else{window.open(url+imgsrc,"_blank");}})();


//alt属性の編集
javascript:(function(){
	var%20imgtag=document.getElementById("srccode").value;
	var%20a1=imgtag.match(/alt=\"*(.*?)\"/);
	var%20alttxt=a1[1].toString();
	var%20rdm=prompt("修正後のalt属性値を入力してください",alttxt);
	var%20rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');
	document.getElementById("srccode").value=rdmimgtag;
})();

javascript:(function(){var%20imgtag=document.getElementById("srccode").value;var%20a1=imgtag.match(/alt=\"*(.*?)\"/);var%20alttxt=a1[1].toString();var%20rdm=prompt("修正後のalt属性値を入力してください",alttxt);var%20rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');document.getElementById("srccode").value=rdmimgtag;})();

//V2
javascript:(function(){
	var%20imgtag=document.getElementById("srccode").value;
	var%20a1=imgtag.match(/alt=\"*(.*?)\"/);
	var%20alttxt="";
	var%20rdmimgtag="";
	var%20pat=new RegExp(/alt=\"\"/);
	if(imgtag.match(pat)==null){
		alttxt = a1[1].toString();
	}else{
		alttxt = "";
	}
	var%20rdm=prompt("修正後のalt属性値を入力してください",alttxt);
	if(imgtag.match(pat)==null){
		rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');
	}else{
		rdmimgtag=imgtag.replace(pat,'alt="'+rdm+'"');
	}
	document.getElementById("srccode").value=rdmimgtag;
})();

javascript:(function(){var%20imgtag=document.getElementById("srccode").value;var%20a1=imgtag.match(/alt=\"*(.*?)\"/);var%20alttxt="";var%20rdmimgtag="";var%20pat=new RegExp(/alt=\"\"/);if(imgtag.match(pat)==null){alttxt = a1[1].toString();}else{alttxt = "";}var%20rdm=prompt("修正後のalt属性値を入力してください",alttxt);if(imgtag.match(pat)==null){rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');}else{rdmimgtag=imgtag.replace(pat,'alt="'+rdm+'"');}document.getElementById("srccode").value=rdmimgtag;})();

//V3（alt属性が無くても自動挿入するよう修正）
javascript:(function(){
	var imgtag=document.getElementById("srccode").value;
	var pat1 = new RegExp(/alt=\"*(.*?)\"/);
	var pat2 = new RegExp(/alt=\"\"/);
	var alttxt="";
	var rdmimgtag="";
	if(imgtag.match(pat1)!==null){
    var a1 = imgtag.match(pat1);
		alttxt = a1[1].toString();
	}else if(imgtag.match(pat2)!==null){
		alttxt = "";
	}else{
		alttxt = "";
	}
	var rdm=prompt("修正後のalt属性値を入力してください",alttxt);
	if(imgtag.match(pat1)!==null){
		rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');
	}else if(imgtag.match(pat2)!==null){
		rdmimgtag=imgtag.replace(pat,'alt="'+rdm+'"');
	}else{
		var pat31 = new RegExp(/(<)(.*?)( \/*)(>)/);
		var pat32 = new RegExp(/(<)(.*?)(>)/);
		var arr31 = imgtag.match(pat31);
		var arr32 = imgtag.match(pat32);
		if(arr31!==null){
          rdmimgtag = arr31[1].toString()+arr31[2].toString()+' alt="'+rdm+'"'+arr31[3].toString()+arr31[4].toString();
		}else if(arr32!==null){
          rdmimgtag = arr32[1].toString()+arr32[2].toString()+' alt="'+rdm+'"'+arr32[3].toString();
		}
	}
	document.getElementById("srccode").value=rdmimgtag;
})();

javascript:(function(){var imgtag=document.getElementById("srccode").value;var pat1 = new RegExp(/alt=\"*(.*?)\"/);var pat2 = new RegExp(/alt=\"\"/);var alttxt="";var rdmimgtag="";if(imgtag.match(pat1)!==null){var a1 = imgtag.match(pat1);alttxt = a1[1].toString();}else if(imgtag.match(pat2)!==null){alttxt = "";}else{alttxt = "";}var rdm=prompt("修正後のalt属性値を入力してください",alttxt);if(imgtag.match(pat1)!==null){rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');}else if(imgtag.match(pat2)!==null){rdmimgtag=imgtag.replace(pat,'alt="'+rdm+'"');}else{var pat31 = new RegExp(/(<)(.*?)( \/*)(>)/);var pat32 = new RegExp(/(<)(.*?)(>)/);var arr31 = imgtag.match(pat31);var arr32 = imgtag.match(pat32);if(arr31!==null){rdmimgtag = arr31[1].toString()+arr31[2].toString()+' alt="'+rdm+'"'+arr31[3].toString()+arr31[4].toString();}else if(arr32!==null){rdmimgtag = arr32[1].toString()+arr32[2].toString()+' alt="'+rdm+'"'+arr32[3].toString();}}document.getElementById("srccode").value=rdmimgtag;})();

//（V3＋コメント付き）
javascript:(function(){
	var cmflg=true;
	var prflg=false;
	var svflg=false;
	var cm = "alt属性を空にすべき";
	click_for("FAIL");
	if(cmflg) document.getElementById("comments").value=cm;
	var imgtag=document.getElementById("srccode").value;
	var pat1 = new RegExp(/alt=\"*(.*?)\"/);
	var pat2 = new RegExp(/alt=\"\"/);
	var alttxt="";
	var rdmimgtag="";
	if(imgtag.match(pat1)!==null){
    var a1 = imgtag.match(pat1);
		alttxt = a1[1].toString();
	}else if(imgtag.match(pat2)!==null){
		alttxt = "";
	}else{
		alttxt = "";
	}
	var rdm="";
	if(prflg) rdm=prompt("修正後のalt属性値を入力してください",alttxt);
	if(imgtag.match(pat1)!==null){
		rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');
	}else if(imgtag.match(pat2)!==null){
		rdmimgtag=imgtag.replace(pat,'alt="'+rdm+'"');
	}else{
		var pat31 = new RegExp(/(<)(.*?)( \/*)(>)/);
		var pat32 = new RegExp(/(<)(.*?)(>)/);
		var arr31 = imgtag.match(pat31);
		var arr32 = imgtag.match(pat32);
		if(arr31!==null){
          rdmimgtag = arr31[1].toString()+arr31[2].toString()+' alt="'+rdm+'"'+arr31[3].toString()+arr31[4].toString();
		}else if(arr32!==null){
          rdmimgtag = arr32[1].toString()+arr32[2].toString()+' alt="'+rdm+'"'+arr32[3].toString();
		}
	}
	document.getElementById("srccode").value=rdmimgtag;
	if(svflg) click_for_submit();
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
	/*登録ボタンクリック関数*/
	function click_for_submit(){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].type;
			if(obj=="submit"){
				form.elements[i].click();
				break;
			}
		}
	}
})();

javascript:(function(){var cmflg=true;var prflg=false;var svflg=false;var cm = "alt属性を空にすべき";click_for("FAIL");if(cmflg) document.getElementById("comments").value=cm;var imgtag=document.getElementById("srccode").value;var pat1 = new RegExp(/alt=\"*(.*?)\"/);var pat2 = new RegExp(/alt=\"\"/);var alttxt="";var rdmimgtag="";if(imgtag.match(pat1)!==null){var a1 = imgtag.match(pat1);alttxt = a1[1].toString();}else if(imgtag.match(pat2)!==null){alttxt = "";}else{alttxt = "";}var rdm="";if(prflg) rdm=prompt("修正後のalt属性値を入力してください",alttxt);if(imgtag.match(pat1)!==null){rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');}else if(imgtag.match(pat2)!==null){rdmimgtag=imgtag.replace(pat,'alt="'+rdm+'"');}else{var pat31 = new RegExp(/(<)(.*?)( \/*)(>)/);var pat32 = new RegExp(/(<)(.*?)(>)/);var arr31 = imgtag.match(pat31);var arr32 = imgtag.match(pat32);if(arr31!==null){rdmimgtag = arr31[1].toString()+arr31[2].toString()+' alt="'+rdm+'"'+arr31[3].toString()+arr31[4].toString();}else if(arr32!==null){rdmimgtag = arr32[1].toString()+arr32[2].toString()+' alt="'+rdm+'"'+arr32[3].toString();}}document.getElementById("srccode").value=rdmimgtag;if(svflg) click_for_submit();/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}/*登録ボタンクリック関数*/function click_for_submit(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}}})();

//V4（H30にも対応）
javascript:(function(){
	var HtmlUtil = {
		target: "srccode",
		regexp_search: function(str, pat){
			var pat = new RegExp(pat);
			var arr = str.match(pat);
			if(arr != null){
				return arr;
			}else{
				return null;
			}
		},
		imgtag_only_check: function(){
			var tg = document.getElementById(this.target).value;
			var arr = this.regexp_search(tg, /^<img.*?>/);
			if(arr != null){
				return true;
			}else{
				return false;
			}
		},
		getInnerTag: function(){
			var tg = document.getElementById(this.target).value;
			var arr = this.regexp_search(tg, /(<a.+?>)(.+?)(<\/a>)/);
			if(arr != null) {
				return arr[2].toString();
			}else{
				return null;
			}
		},
		getOuterTag: function(){
			var tg = document.getElementById(this.target).value;
			var arr = this.regexp_search(tg, /(<a.+?>)(.+?)(<\/a>)/);
			var retarr = new Array();
			if(arr != null){
				retarr[0] = arr[1];
				retarr[1] = arr[3];
				return retarr;
			}else{
				return null;
			}
		},
		getAltAttr: function(str){
			var arr1 = this.regexp_search(str, /alt=\"(.*?)\"/);
			var arr2 = this.regexp_search(str, /alt=\"\"/);
			var alttxt = "";
			if(arr1 != null){
				alttxt = arr1[1].toString();
			}
			return alttxt;
		},
		check_tag_type: function(imgtag){
			if(this.regexp_search(imgtag, /<.*? \/>/) != null){
				return "xhtml";
			}else{
				return "html";
			}
		},
		getReplacedTag: function(imgtag, str){
			var arr1 = this.regexp_search(str, /alt=\"*(.*?)\"/);
			var arr2 = this.regexp_search(str, /alt=\"\"/);
			var ret = "";
			if(arr1 != null){
				ret = imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+str+'"');
			}
			else if(arr2 != null){
				ret = imgtag.replace(/alt=\"\"/,'alt="'+str+'"');
			}
			else{
				if(this.check_tag_type(imgtag) == "xhtml"){
					ret = imgtag.replace(" />", ' alt="'+str+'" />');
				}else{
					ret = imgtag.replace(">", ' alt="'+str+'">');
				}
			}
			return ret;
		},
	};
	var util = Object(HtmlUtil);
	var imgtag = "";
	var img_only = util.imgtag_only_check();
	if(img_only){
		imgtag = document.getElementById("srccode").value;
	}else{
		imgtag = util.getInnerTag();
	}
	var alttxt = util.getAltAttr(imgtag);
	var rdm = prompt("修正後のalt属性値を入力してください", alttxt);
	var rdmimgtag = util.getReplacedTag(imgtag, rdm);
	if(img_only){
		document.getElementById("srccode").value=rdmimgtag;
	}else{
		var outertag = util.getOuterTag();
		document.getElementById("srccode").value = outertag[0].toString() + rdmimgtag + outertag[1].toString();
	}
})();


javascript:(function(){var HtmlUtil = {target: "srccode",regexp_search: function(str, pat){var pat = new RegExp(pat);var arr = str.match(pat);if(arr != null){return arr;}else{return null;}},imgtag_only_check: function(){var tg = document.getElementById(this.target).value;var arr = this.regexp_search(tg, /^<img.*?>/);if(arr != null){return true;}else{return false;}},getInnerTag: function(){var tg = document.getElementById(this.target).value;var arr = this.regexp_search(tg, /(<a.+?>)(.+?)(<\/a>)/);if(arr != null) {return arr[2].toString();}else{return null;}},getOuterTag: function(){var tg = document.getElementById(this.target).value;var arr = this.regexp_search(tg, /(<a.+?>)(.+?)(<\/a>)/);var retarr = new Array();if(arr != null){retarr[0] = arr[1];retarr[1] = arr[3];return retarr;}else{return null;}},getAltAttr: function(str){var arr1 = this.regexp_search(str, /alt=\"(.*?)\"/);var arr2 = this.regexp_search(str, /alt=\"\"/);var alttxt = "";if(arr1 != null){alttxt = arr1[1].toString();}return alttxt;},check_tag_type: function(imgtag){if(this.regexp_search(imgtag, /<.*? \/>/) != null){return "xhtml";}else{return "html";}},getReplacedTag: function(imgtag, str){var arr1 = this.regexp_search(str, /alt=\"*(.*?)\"/);var arr2 = this.regexp_search(str, /alt=\"\"/);var ret = "";if(arr1 != null){ret = imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+str+'"');}else if(arr2 != null){ret = imgtag.replace(/alt=\"\"/,'alt="'+str+'"');}else{if(this.check_tag_type(imgtag) == "xhtml"){ret = imgtag.replace(" />", ' alt="'+str+'" />');}else{ret = imgtag.replace(">", ' alt="'+str+'">');}}return ret;},};var util = Object(HtmlUtil);var imgtag = "";var img_only = util.imgtag_only_check();if(img_only){imgtag = document.getElementById("srccode").value;}else{imgtag = util.getInnerTag();}var alttxt = util.getAltAttr(imgtag);var rdm = prompt("修正後のalt属性値を入力してください", alttxt);var rdmimgtag = util.getReplacedTag(imgtag, rdm);if(img_only){document.getElementById("srccode").value=rdmimgtag;}else{var outertag = util.getOuterTag();document.getElementById("srccode").value = outertag[0].toString() + rdmimgtag + outertag[1].toString();}})();




//title属性埋め込み
javascript:(function(){
	var%20tag=document.getElementById("srccode").value;
	var%20pat1=new%20RegExp(/ (.*?)\/>/);
	var%20pat2=new%20RegExp(/(.*")(>)/);
	var%20arr1=tag.match(pat1);
	var%20arr2=tag.match(pat2);
	var%20rdm=prompt("title属性値を指定してください","例　検索キーワードを入力");
	var%20rdmtag="";
	if(arr1==null){
      rdmtag=tag.replace(pat2,arr2[1].toString()+' title="'+rdm+'">');
	}else{
      rdmtag=tag.replace(pat1,' '+arr1[1].toString()+' title="'+rdm+'"'+' />');
	}
	document.getElementById("srccode").value=rdmtag;
})();

javascript:(function(){var%20tag=document.getElementById("srccode").value;var%20pat1=new%20RegExp(/ (.*?)\/>/);var%20pat2=new%20RegExp(/(.*")(>)/);var%20arr1=tag.match(pat1);var%20arr2=tag.match(pat2);/*var%20a1=tag.match(/ (.*?)\/>/);var%20tagattr=a1[1].toString();*/var%20rdm=prompt("title属性値を指定してください","例　検索キーワードを入力");var%20rdmtag="";if(arr1==null){rdmtag=tag.replace(pat2,arr2[1].toString()+' title="'+rdm+'">');}else{rdmtag=tag.replace(pat1,' '+arr1[1].toString()+' title="'+rdm+'"'+' />');}/*rdmtag=tag.replace(/ (.*?)>/, ' '+tagattr+' title="'+rdm+'"'+' />');*/document.getElementById("srccode").value=rdmtag;})();

//V2
javascript:(function(){
	click_for("FAIL");
	set_comment("title属性がない");
	var%20tag=document.getElementById("srccode").value;
	var%20pat1=new%20RegExp(/ (.*?)\/>/);
	var%20pat2=new%20RegExp(/(.*")(>)/);
	var%20arr1=tag.match(pat1);
	var%20arr2=tag.match(pat2);
	var%20rdm=prompt("title属性値を指定してください","例　検索キーワードを入力");
	var%20rdmtag="";
	if(arr1==null){
      rdmtag=tag.replace(pat2,arr2[1].toString()+' title="'+rdm+'">');
	}else{
      rdmtag=tag.replace(pat1,' '+arr1[1].toString()+' title="'+rdm+'"'+' />');
	}
	document.getElementById("srccode").value=rdmtag;
	click_for_submit();
	/*コメント挿入関数*/
	function set_comment(str){
		document.getElementById("comments").value = str;
	}
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
	/*登録ボタンクリック関数*/
	function click_for_submit(){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].type;
			if(obj=="submit"){
				form.elements[i].click();
				break;
			}
		}
	}
})();

javascript:(function(){click_for("FAIL");set_comment("title属性がない");var%20tag=document.getElementById("srccode").value;var%20pat1=new%20RegExp(/ (.*?)\/>/);var%20pat2=new%20RegExp(/(.*")(>)/);var%20arr1=tag.match(pat1);var%20arr2=tag.match(pat2);var%20rdm=prompt("title属性値を指定してください","例　検索キーワードを入力");var%20rdmtag="";if(arr1==null){rdmtag=tag.replace(pat2,arr2[1].toString()+' title="'+rdm+'">');}else{rdmtag=tag.replace(pat1,' '+arr1[1].toString()+' title="'+rdm+'"'+' />');}document.getElementById("srccode").value=rdmtag;click_for_submit();/*コメント挿入関数*/function set_comment(str){document.getElementById("comments").value = str;}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}/*登録ボタンクリック関数*/function click_for_submit(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}}})();

//空altの埋め込み
javascript:(function(){
	var%20tag=document.getElementById("srccode").value;
	document.getElementById("comments").value="支援技術が無視すべき画像にも、alt属性値を付与し値は空にする。";
	var%20pat1=new%20RegExp(/ (.*?)\/>/);
	var%20pat2=new%20RegExp(/(.*")(>)/);
	var%20arr1=tag.match(pat1);
	var%20arr2=tag.match(pat2);
	var%20rdm=" alt=\"\"";
	var%20rdmtag="";
	if(arr1==null){
      rdmtag=tag.replace(pat2,arr2[1].toString() + rdm + '">');
	}else{
      rdmtag=tag.replace(pat1,' '+arr1[1].toString() + rdm + ' />');
	}
	document.getElementById("srccode").value=rdmtag;
})();

javascript:(function(){var%20tag=document.getElementById("srccode").value;document.getElementById("comments").value="支援技術が無視すべき画像にも、alt属性値を付与し値は空にする。";var%20pat1=new%20RegExp(/ (.*?)\/>/);var%20pat2=new%20RegExp(/(.*")(>)/);var%20arr1=tag.match(pat1);var%20arr2=tag.match(pat2);var%20rdm=" alt=\"\"";var%20rdmtag="";if(arr1==null){rdmtag=tag.replace(pat2,arr2[1].toString() + rdm + '">');}else{rdmtag=tag.replace(pat1,' '+arr1[1].toString() + rdm + ' />');}document.getElementById("srccode").value=rdmtag;})();

//他言語選択ボタンのalt修正
javascript:(function(){
var%20imgtag=document.getElementById("srccode").value;
var%20a1=imgtag.match(/alt=\"*(.*?)\"/);
var%20alttxt=a1[1].toString();
var%20lang="";
if(alttxt.match(/.*中国語.*/)){
	lang="中文";
}else if(alttxt.match(/.*簡体.*/)){
	lang="中文(簡体)";
}else if(alttxt.match(/.*繁體.*/)||alttxt.match(/.*繁体.*/)){
	lang="中文(繁体)";
}else if(alttxt.match(/.*韓国語.*/)){
	lang="한국어";
}else if(alttxt.match(/.*ポルトガル語.*/)){
	lang="Português";
}else if(alttxt.match(/.*スペイン語.*/)){
	lang="Español";
}else if(alttxt.match(/.*英語.*/)){
	lang="English";
}else if(alttxt.match(/.*タイ語.*/)){
	lang="ไทย";
}else if(alttxt.match(/.*ベトナム語.*/)){
	lang="Việt";
}else{
	lang="その他言語";
}
var%20rdm=prompt("修正後のalt属性値を入力してください",lang+' '+alttxt);
var%20rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');
document.getElementById("comments").value="代替テキストが十分でない";
document.getElementById("srccode").value=rdmimgtag;
})();

javascript:(function(){var%20imgtag=document.getElementById("srccode").value;var%20a1=imgtag.match(/alt=\"*(.*?)\"/);var%20alttxt=a1[1].toString();var%20lang="";if(alttxt.match(/.*中国語.*/)){lang="中文";}else if(alttxt.match(/.*簡体.*/)){lang="中文(簡体)";}else if(alttxt.match(/.*繁體.*/)||alttxt.match(/.*繁体.*/)){lang="中文(繁体)";}else if(alttxt.match(/.*韓国語.*/)){lang="한국어";}else if(alttxt.match(/.*ポルトガル語.*/)){lang="Português";}else if(alttxt.match(/.*スペイン語.*/)){lang="Español";}else if(alttxt.match(/.*英語.*/)){lang="English";}else if(alttxt.match(/.*タイ語.*/)){lang="ไทย";}else if(alttxt.match(/.*ベトナム語.*/)){lang="Việt";}else{lang="その他言語";}var%20rdm=prompt("修正後のalt属性値を入力してください",lang+' '+alttxt);var%20rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');document.getElementById("comments").value="代替テキストが十分でない";document.getElementById("srccode").value=rdmimgtag;})();


//バナー不適合判定
javascript:(function(){
	document.getElementById("comments").value="代替テキストが十分でない";
	var%20imgtag=document.getElementById("srccode").value;
	var%20a1=imgtag.match(/alt=\"*(.*?)\"/);
	var%20alttxt=a1[1].toString();
	var%20rdm=prompt("修正後のalt属性値を入力してください",'広告：'+alttxt);
	var%20rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');
	document.getElementById("srccode").value=rdmimgtag;
})();

javascript:(function(){document.getElementById("comments").value="代替テキストが十分でない";var%20imgtag=document.getElementById("srccode").value;var%20a1=imgtag.match(/alt=\"*(.*?)\"/);var%20alttxt=a1[1].toString();var%20rdm=prompt("修正後のalt属性値を入力してください",'広告：'+alttxt);var%20rdmimgtag=imgtag.replace(/alt=\"*(.*?)\"/,'alt="'+rdm+'"');document.getElementById("srccode").value=rdmimgtag;})();

//次のURLに進む
javascript:(function(){
	var%20response=true;
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		var%20idx=i+1;
		if(idx==element.options.length){
			alert("これ以上進めません！");
			response=false;
			break;
		}
		if(element.options[i].selected){
			element.options[idx].selected = true;
			break;
		}
	}
	if(response)%20document.getElementById("submitURL").click();
})();

javascript:(function(){var%20response=true;var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){var%20idx=i+1;if(idx==element.options.length){alert("これ以上進めません！");response=false;break;}if(element.options[i].selected){element.options[idx].selected = true;break;}}if(response)%20document.getElementById("submitURL").click();})();


//前のURLに戻る
javascript:(function(){
	var%20response=true;
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			var%20idx=i-1;
			if(idx<0){
				alert("これ以上戻れません！");
				response=false;
				break;
			}else{
				element.options[idx].selected = true;
				break;
			}
		}
	}
	if(response)%20document.getElementById("submitURL").click();
})();

javascript:(function(){var%20response=true;var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){var%20idx=i-1;if(idx<0){alert("これ以上戻れません！");response=false;break;}else{element.options[idx].selected = true;break;}}}if(response)%20document.getElementById("submitURL").click();})();

//CSSを別タブで
javascript:(function(){
	var%20urlval="";
	var%20url="";
	var%20tag="";
	var%20href="";
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;
			break;
		}
	}
	var%20a1=urlval.match(/http.*\/\/.*?\//);
	url=a1[0].toString();
	tag=window.getSelection().toString();
	var%20a2=tag.match(/href=\"*(.*?)\"/);
	href=a2[1].toString();
	if(href.match(/http.*/)){
		alert("src属性値がhttp、httpsで始まる場合、対応できません。手動で確認ください。");
	}else{
		window.open(url+href,"_blank");
	}
})();

javascript:(function(){var%20urlval="";var%20url="";var%20tag="";var%20href="";var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var%20a1=urlval.match(/http.*\/\/.*?\//);url=a1[0].toString();tag=window.getSelection().toString();var%20a2=tag.match(/href=\"*(.*?)\"/);href=a2[1].toString();if(href.match(/http.*/)){alert("src属性値がhttp、httpsで始まる場合、対応できません。手動で確認ください。");}else{window.open(url+href,"_blank");}})();

//V2
javascript:(function(){
	var urlval="";
	var url="";
	var tag="";
	var href="";
	var element=document.getElementById("urlList");
	if(element==null){
		urlval=window.location.href;
		var a1=urlval.match(/http.*\/\/.*?\//);
		url=a1[0].toString();
		href=window.getSelection().toString();
		window.open(url+href,"_blank");
	}else{
		for(var i=0;i<element.options.length;i++){
			if(element.options[i].selected){
				urlval=element.options[i].text;
				break;
			}
		}
		var a1=urlval.match(/http.*\/\/.*?\//);
		url=a1[0].toString();
		tag=window.getSelection().toString();
		var a2=tag.match(/href=\"*(.*?)\"/);
		href=a2[1].toString();
		if(href.match(/http.*/)){
			window.open(href,"_blank");
		}else{
			window.open(url+href,"_blank");
		}
	}

})();

javascript:(function(){var urlval="";var url="";var tag="";var href="";var element=document.getElementById("urlList");if(element==null){urlval=window.location.href;var a1=urlval.match(/http.*\/\/.*?\//);url=a1[0].toString();href=window.getSelection().toString();window.open(url+href,"_blank");}else{for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var a1=urlval.match(/http.*\/\/.*?\//);url=a1[0].toString();tag=window.getSelection().toString();var a2=tag.match(/href=\"*(.*?)\"/);href=a2[1].toString();if(href.match(/http.*/)){window.open(href,"_blank");}else{window.open(url+href,"_blank");}}})();

//V3
javascript:(function(){
	var urlval="";
	var url="";
	var tag="";
	var href="";
	var element=document.getElementById("urlList");
	/*別タブの場合*/
	if(element==null){
		urlval=window.location.href;
		var a1=urlval.match(/http.*\/\/.*\//);
		url=a1[0].toString();
		filename=window.getSelection().toString();
		var a2=filename.match(/\.+.*/);
		if(a2==null) filename += ".css";
		window.open(url+filename,"_blank");
	/*Libra画面の場合*/	
	}else{
		for(var i=0;i<element.options.length;i++){
			if(element.options[i].selected){
				urlval=element.options[i].text;
				break;
			}
		}
		var a1=urlval.match(/http.*\/\/.*?\//);
		/*TOPページの場合*/
		if(a1==null){
			var a1x = urlval.match(/http.*/);
			url = a1x[0].toString();
		/*そうでない場合*/
		}else{
			url=a1[0].toString();
		}
		tag=window.getSelection().toString();
		var a2=tag.match(/href=\"*(.*?)\"/);
		href=a2[1].toString();
		/*絶対urlの場合*/
		if(href.match(/http.*/)){
			window.open(href,"_blank");
		/*そうでない場合*/
		}else{
			window.open(url+href,"_blank");
		}
	}
})();

javascript:(function(){var urlval="";var url="";var tag="";var href="";var element=document.getElementById("urlList");if(element==null){urlval=window.location.href;var a1=urlval.match(/http.*\/\/.*\//);url=a1[0].toString();filename=window.getSelection().toString();var a2=filename.match(/\.+.*/);if(a2==null) filename += ".css";window.open(url+filename,"_blank");		}else{for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var a1=urlval.match(/http.*\/\/.*?\//);if(a1==null){var a1x = urlval.match(/http.*/);url = a1x[0].toString();}else{url=a1[0].toString();}tag=window.getSelection().toString();var a2=tag.match(/href=\"*(.*?)\"/);href=a2[1].toString();if(href.match(/http.*/)){window.open(href,"_blank");}else{window.open(url+href,"_blank");}}})();

//診断対象ページを別タブで
javascript:(function(){
	var%20urlval="";
	var%20url="";
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;
			break;
		}
	}
	var%20a1=urlval.match(/http.*\/\/.*/);
	url=a1[0].toString();
	window.open(url,"_blank");
})();							

javascript:(function(){var%20urlval="";var%20url="";var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var%20a1=urlval.match(/http.*\/\/.*/);url=a1[0].toString();window.open(url,"_blank");})();

//V2
javascript:(function(){
	var urlval="";
	var url="";
	var element1=document.getElementById("urlList");
	var element2=document.getElementById("url2");
	if(element1!=null){
		for(var i=0;i<element1.options.length;i++){
			if(element1.options[i].selected){
				urlval=element1.options[i].text;
				break;
			}
		}
	}
	if(element2!=null){
		urlval=element2.value;
	}
	var a1=urlval.match(/http.*\/\/.*/);
	url=a1[0].toString();
	window.open(url,"_blank");
})();

javascript:(function(){var urlval="";var url="";var element1=document.getElementById("urlList");var element2=document.getElementById("url2");if(element1!=null){for(var i=0;i<element1.options.length;i++){if(element1.options[i].selected){urlval=element1.options[i].text;break;}}}if(element2!=null){urlval=element2.value;}var a1=urlval.match(/http.*\/\/.*/);url=a1[0].toString();window.open(url,"_blank");})();


//サイトトップに戻る
javascript:(function(){
	var%20flg=1;
	var%20urlval="";
	var%20url="";
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;
			break;
		}
	}
	var%20a1=urlval.match(/http.*\/\/.*?\//);
	url=a1[0].toString();
	if(flg==1){
	  url=url.replace("https","http");
	}
	var%20diff=new RegExp(url + "$");
	for(var%20i=0;i<element.options.length;i++){
	  var%20row=element.options[i].text;
	  var%20arr=row.match(/http.*\/\/.+/);
	  var%20chkstr=arr[0].toString();
	  if(chkstr==url){
	    element.options[i].selected=true;
	    break;
	  }
	}
	document.getElementById("submitURL").click();
})();

javascript:(function(){var%20flg=1;var%20urlval="";var%20url="";var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var%20a1=urlval.match(/http.*\/\/.*?\//);url=a1[0].toString();if(flg==1){url=url.replace("https","http");}var%20diff=new RegExp(url + "$");for(var%20i=0;i<element.options.length;i++){var%20row=element.options[i].text;var%20arr=row.match(/http.*\/\/.+/);var%20chkstr=arr[0].toString();if(chkstr==url){element.options[i].selected=true;break;}}document.getElementById("submitURL").click();})();

//V2
javascript:(function(){
	var%20flg=1;
    function trgr(){
      var d=window.open().document;
      d.write('<p><strong>移動前の番号（控え）</strong></p>');
      d.write('<dl><dt><strong><label for="num"><small>ページ番号</label></dt>');
      d.write('<dd style="margin-left:0"><input type="text" id="num" value="'+num_body+'" /></dd></dl>');
    }
	var%20urlval="";
	var%20url="";
    var%20num_all="";
    var%20num_body="";
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;
			break;
		}
	}

    var%20a1=urlval.match(/http.*\/\/.*?\//);
    var%20ara=urlval.match(/\[.*\]/);
    url=a1[0].toString();
    num_all=ara[0].toString();
    var%20arb=num_all.match(/([a-zA-Z]+)([0-9]+)/);
    num_body=arb[2].toString();
	if(flg==1){
	  url=url.replace("https","http");
	}
	var%20diff=new RegExp(url + "$");
	for(var%20i=0;i<element.options.length;i++){
	  var%20row=element.options[i].text;
	  var%20arr=row.match(/http.*\/\/.+/);
	  var%20chkstr=arr[0].toString();
	  if(chkstr==url){
	    element.options[i].selected=true;
	    break;
	  }
	}
	document.getElementById("submitURL").click();
    trgr();
})();

javascript:(function(){var%20flg=1;function trgr(){var d=window.open().document;d.write('<p><strong>移動前の番号（控え）</strong></p>');d.write('<dl><dt><strong><label for="num"><small>ページ番号</label></dt>');d.write('<dd style="margin-left:0"><input type="text" id="num" value="'+num_body+'" /></dd></dl>');}var%20urlval="";var%20url="";var%20num_all="";var%20num_body="";var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var%20a1=urlval.match(/http.*\/\/.*?\//);var%20ara=urlval.match(/\[.*\]/);url=a1[0].toString();num_all=ara[0].toString();var%20arb=num_all.match(/([a-zA-Z]+)([0-9]+)/);num_body=arb[2].toString();if(flg==1){url=url.replace("https","http");}var%20diff=new RegExp(url + "$");for(var%20i=0;i<element.options.length;i++){var%20row=element.options[i].text;var%20arr=row.match(/http.*\/\/.+/);var%20chkstr=arr[0].toString();if(chkstr==url){element.options[i].selected=true;break;}}document.getElementById("submitURL").click();trgr();})();

//strongタグで囲う
javascript:(function(){
	var%20tag="";
	var%20src=document.getElementById("description").value;
	src=src.replace(/^ +/m,"");
	src=src.replace(/\t+/m,"");
	src=src.replace(/(\r\n|\r|\n)/,"");
	var%20pt=new RegExp(/(<.*>)(.*)(<\/.*>)/);
	var%20arr=src.match(pt);
	if(arr==null){
		alert("不正なタグです。");
	}else{
		tag=arr[1].toString()+"<strong>"+arr[2].toString()+"</strong>"+arr[3].toString();
		document.getElementById("srccode").value=tag;
		document.getElementById("comments").value="強調を意図している、セマンティックなマークアップが必要。";
    }
})();

javascript:(function(){var%20tag="";var%20src=document.getElementById("description").value;src=src.replace(/^ +/m,"");src=src.replace(/\t+/m,"");src=src.replace(/(\r\n|\r|\n)/,"");var%20pt=new RegExp(/(<.*>)(.*)(<\/.*>)/);var%20arr=src.match(pt);if(arr==null){alert("不正なタグです。");}else{tag=arr[1].toString()+"<strong>"+arr[2].toString()+"</strong>"+arr[3].toString();document.getElementById("srccode").value=tag;}})();

//emタグで囲う
javascript:(function(){
	var%20tag="";
	var%20src=document.getElementById("description").value;
	src=src.replace(/^ +/m,"");
	src=src.replace(/\t+/m,"");
	src=src.replace(/(\r\n|\r|\n)/,"");
	var%20pt=new RegExp(/(<.*>)(.*)(<\/.*>)/);
	var%20arr=src.match(pt);
	if(arr==null){
		alert("不正なタグです。");
	}else{
		tag=arr[1].toString()+"<em style=\"font-style:normal;font-weight:bold\">"+arr[2].toString()+"</em>"+arr[3].toString();
		document.getElementById("srccode").value=tag;
		document.getElementById("comments").value="強調を意図している、セマンティックなマークアップが必要。";
    }
})();

javascript:(function(){var%20tag="";var%20src=document.getElementById("description").value;src=src.replace(/^ +/m,"");src=src.replace(/\t+/m,"");src=src.replace(/(\r\n|\r|\n)/,"");var%20pt=new RegExp(/(<.*>)(.*)(<\/.*>)/);var%20arr=src.match(pt);if(arr==null){alert("不正なタグです。");}else{tag=arr[1].toString()+"<em style=\"font-style:normal;font-weight:bold\">"+arr[2].toString()+"</em>"+arr[3].toString();document.getElementById("srccode").value=tag;document.getElementById("comments").value="強調を意図している、セマンティックなマークアップが必要。";}})();


//lang属性埋め込み
javascript:(function(){
	var%20tag=document.getElementById("description").value;
	var%20pat=new%20RegExp(/(.*")(>)/);
	var%20a1=tag.match(pat);
	var%20rdm=prompt("言語コードを入力","en");
	var%20rdmtag=tag.replace(pat,a1[1].toString()+' xml:lang="'+rdm+'" lang="'+rdm+'">');
	document.getElementById("srccode").value=rdmtag;
})();

javascript:(function(){var%20tag=document.getElementById("description").value;var%20pat=new%20RegExp(/(.*")(>)/);var%20a1=tag.match(pat);var%20rdm=prompt("言語コードを入力","en");var%20rdmtag=tag.replace(pat,a1[1].toString()+' xml:lang="'+rdm+'" lang="'+rdm+'">');document.getElementById("srccode").value=rdmtag;})();

//見出しのレベル修正
javascript:(function(){
  var%20opt="up";
  var%20src=document.getElementById("srccode").value;
  src=clean(src);
  var%20pt=new RegExp(/(<)(..)(.*)(>)(.*)(<\/.*>$)/);
  var%20arr=src.match(pt);
  var%20num=arr[2].toString().toLowerCase();
  num=num.replace("h","");
  num=Number(num);
  var tag="";
  if(opt=="down"){
    num++;
  }else%20if(opt=="up"){
    num--;
  }

  if(num<1 || num>6){
    alert("これ以上小さくまたは大きくできません");
  }else{
    tag="<h"+num.toString()+arr[3].toString()+arr[4].toString()+arr[5].toString()+"</h"+num+">";
    document.getElementById("srccode").value=tag;
    document.getElementById("comments").value="文書構造上、この見出しはh"+num+"要素にすべき";
  }
  /*行頭のspace,tab,改行除去関数*/
  function%20clean(str){
    str=str.replace(/^ +/m,"");
    str=str.replace(/\t+/m,"");
    str=str.replace(/(\r\n|\r|\n)/g,""); 
    return%20str;
  }
})();

javascript:(function(){var%20opt="up";var%20src=document.getElementById("srccode").value;src=clean(src);var%20pt=new RegExp(/(<)(..)(.*)(>)(.*)(<\/.*>$)/);var%20arr=src.match(pt);var%20num=arr[2].toString().toLowerCase();num=num.replace("h","");num=Number(num);var tag="";if(opt=="down"){num++;}else%20if(opt=="up"){num--;}if(num<1 || num>6){alert("これ以上小さくまたは大きくできません");}else{tag="<h"+num.toString()+arr[3].toString()+arr[4].toString()+arr[5].toString()+"</h"+num+">";document.getElementById("srccode").value=tag;document.getElementById("comments").value="文書構造上、この見出しはh"+num+"要素にすべき";}/*行頭のspace,tab,改行除去関数*/function%20clean(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return%20str;}})();

//V2
javascript:(function(){
  var opt="up";
  click_for("FAIL");
  var src=document.getElementById("srccode").value;
  src=clean(src);
  var pt=new RegExp(/(<)(..)(.*)(>)(.*)(<\/.*>$)/);
  var arr=src.match(pt);
  var num=arr[2].toString().toLowerCase();
  num=num.replace("h","");
  num=Number(num);
  var tag="";
  if(opt=="down"){
    num++;
  }else if(opt=="up"){
    num--;
  }

  if(num<1 || num>6){
    alert("これ以上小さくまたは大きくできません");
  }else{
    tag="<h"+num.toString()+arr[3].toString()+arr[4].toString()+arr[5].toString()+"</h"+num+">";
    document.getElementById("srccode").value=tag;
    document.getElementById("comments").value="文書構造上、この見出しはh"+num+"要素にすべき";
  }
  /*ボタンクリック関数*/
  function click_for(flag){
  	var form=document.forms["diag_form"];
	for(var i=0;i<form.elements.length;i++){
		var obj=form.elements[i].value;
		if(obj==flag){
			form.elements[i].click();
			break;
		}
	}
  }
  /*行頭のspace,tab,改行除去関数*/
  function clean(str){
    str=str.replace(/^ +/m,"");
    str=str.replace(/\t+/m,"");
    str=str.replace(/(\r\n|\r|\n)/g,""); 
    return str;
  }
})();

javascript:(function(){var opt="up";click_for("FAIL");var src=document.getElementById("srccode").value;src=clean(src);var pt=new RegExp(/(<)(..)(.*)(>)(.*)(<\/.*>$)/);var arr=src.match(pt);var num=arr[2].toString().toLowerCase();num=num.replace("h","");num=Number(num);var tag="";if(opt=="down"){num++;}else if(opt=="up"){num--;}if(num<1 || num>6){alert("これ以上小さくまたは大きくできません");}else{tag="<h"+num.toString()+arr[3].toString()+arr[4].toString()+arr[5].toString()+"</h"+num+">";document.getElementById("srccode").value=tag;document.getElementById("comments").value="文書構造上、この見出しはh"+num+"要素にすべき";}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}/*行頭のspace,tab,改行除去関数*/function clean(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;}})();

//診断箇所を一覧する
javascript:(function(){
	function%20trgr(){
	  var%20d=window.open().document;
	  d.write('<!DOCTYPE html><head>');
	  d.write('<title>診断箇所一覧</title>');
	  d.write('<style>textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}</style>');
	  d.write('</head><body>');
	  d.write('<p><strong>診断箇所一覧</strong></p>');
	  d.write('<textarea id="code">'+str+'</textarea>');
	  d.write('</body></html>');
	}
	var%20d=document.getElementById("source");
	var%20dch=d.childNodes;
	var%20str="";
	for(var%20i=0;i<dch.length;i++){
	  if(dch.item(i).id){
	    var%20j=i+1;
	    if(dch.item(j).nodeValue!=null){
	      str+="▼"+"\r\n";
	      str+=dch.item(j).nodeValue+"\r\n";
	    }
	  }
	}
	trgr();
})();

javascript:(function(){function%20trgr(){var%20d=window.open().document;d.write('<!DOCTYPE html><head>');d.write('<title>診断箇所一覧</title>');d.write('<style>textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}</style>');d.write('</head><body>');d.write('<p><strong>診断箇所一覧</strong></p>');d.write('<textarea id="code">'+str+'</textarea>');d.write('</body></html>');}var%20d=document.getElementById("source");var%20dch=d.childNodes;var%20str="";for(var%20i=0;i<dch.length;i++){if(dch.item(i).id){var%20j=i+1;if(dch.item(j).nodeValue!=null){str+="▼"+"\r\n";str+=dch.item(j).nodeValue+"\r\n";}}}trgr();})();

//V2
javascript:(function(){
	function trgr(){
	  var d=window.open().document;
	  d.write('<!DOCTYPE html>');
	  d.write('<html lang="ja">');
	  d.write('<head>');
	  d.write('<meta charset="utf-8">');
	  d.write('<title>診断箇所一覧</title>');
	  d.write('<style>');
	  d.write('h1{font-size:160%;font-family:"メイリオ",Meiryo;}');
	  d.write('textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}');
	  d.write('</style>');
	  d.write('</head>');
	  d.write('<body>');
	  d.write('<h1>診断箇所一覧</h1>');
	  d.write('</body></html>');
	  var bd = d.getElementsByTagName("body").item(0);
	  var ta = d.createElement("textarea");
	  ta.textContent = str;
	  bd.appendChild(ta);
	}
	var d=document.getElementById("source");
	var dch=d.childNodes;
	var str="";
	for(var i=0;i<dch.length;i++){
	  if(dch.item(i).id){
	    var j=i+1;
	    if(dch.item(j).nodeValue!=null){
	      str+="▼"+"\r\n";
	      str+=dch.item(j).nodeValue+"\r\n";
	    }
	  }
	}
	trgr();
})();

javascript:(function(){function trgr(){var d=window.open().document;d.write('<!DOCTYPE html>');d.write('<html lang="ja">');d.write('<head>');d.write('<meta charset="utf-8">');d.write('<title>診断箇所一覧</title>');d.write('<style>');d.write('h1{font-size:160%;font-family:"メイリオ",Meiryo;}');d.write('textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}');d.write('</style>');d.write('</head>');d.write('<body>');d.write('<h1>診断箇所一覧</h1>');d.write('</body></html>');var bd = d.getElementsByTagName("body").item(0);var ta = d.createElement("textarea");ta.textContent = str;bd.appendChild(ta);}var d=document.getElementById("source");var dch=d.childNodes;var str="";for(var i=0;i<dch.length;i++){if(dch.item(i).id){var j=i+1;if(dch.item(j).nodeValue!=null){str+="▼"+"\r\n";str+=dch.item(j).nodeValue+"\r\n";}}}trgr();})();

//V3
javascript:(function(){
	function trgr(){
		var d=window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>診断箇所一覧</title>');
		d.writeln('<style>');
		d.writeln('h1{font-size:160%;font-family:"メイリオ",Meiryo;}');
		d.writeln('textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:35em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script>');
		d.writeln('function win_close(){');
		d.writeln('window.close();');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('function export_data(){');
		d.writeln('var src = document.getElementById("ta").value;');
		d.writeln('var d = window.open().document;');
		d.writeln('d.writeln(\'<!DOCTYPE html>\');');
		d.writeln('d.writeln(\'<html lang="ja"><head><meta charset="utf-8">\');');
		d.writeln('d.writeln(\'<title>Export</title>\');');
		d.writeln('d.writeln(\'<style>h1{font-size:160%;font-family:"メイリオ",Meiryo;}\');');
		d.writeln('d.writeln(\'pre{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}\');');
		d.writeln('d.writeln(\'</style></head>\');');
		d.writeln('d.writeln(\'<body>\');');
		d.writeln('d.writeln(\'<h1>Export</h1>\');');
		d.writeln('d.writeln(\'</body>\');');
		d.writeln('d.writeln(\'</html>\');');
		d.writeln('var pr = d.createElement("pre");');
		d.writeln('pr.textContent = src;');
		d.writeln('var bd = d.getElementsByTagName("body").item(0);');
		d.writeln('bd.appendChild(pr);');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>診断箇所一覧</h1>');
		d.writeln('<button onclick="export_data()">Export</button>');
		d.writeln('<button onclick="win_close()">Close</button><br>');
		d.writeln('</body></html>');
		var bd = d.getElementsByTagName("body").item(0);
		var ta = d.createElement("textarea");
		ta.setAttribute("id", "ta");
		ta.textContent = str;
		bd.appendChild(ta);
	}
	var d=document.getElementById("source");
	var dch=d.childNodes;
	var str="";
	for(var i=0;i<dch.length;i++){
	  if(dch.item(i).id){
	    var j=i+1;
	    if(dch.item(j).nodeValue!=null){
	      str+="▼"+"\r\n";
	      str+=dch.item(j).nodeValue+"\r\n";
	    }
	  }
	}
	trgr();
})();

javascript:(function(){function trgr(){var d=window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>診断箇所一覧</title>');d.writeln('<style>');d.writeln('h1{font-size:160%;font-family:"メイリオ",Meiryo;}');d.writeln('textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:35em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script>');d.writeln('function win_close(){');d.writeln('window.close();');d.writeln('return false;');d.writeln('}');d.writeln('function export_data(){');d.writeln('var src = document.getElementById("ta").value;');d.writeln('var d = window.open().document;');d.writeln('d.writeln(\'<!DOCTYPE html>\');');d.writeln('d.writeln(\'<html lang="ja"><head><meta charset="utf-8">\');');d.writeln('d.writeln(\'<title>Export</title>\');');d.writeln('d.writeln(\'<style>h1{font-size:160%;font-family:"メイリオ",Meiryo;}\');');d.writeln('d.writeln(\'pre{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}\');');d.writeln('d.writeln(\'</style></head>\');');d.writeln('d.writeln(\'<body>\');');d.writeln('d.writeln(\'<h1>Export</h1>\');');d.writeln('d.writeln(\'</body>\');');d.writeln('d.writeln(\'</html>\');');d.writeln('var pr = d.createElement("pre");');d.writeln('pr.textContent = src;');d.writeln('var bd = d.getElementsByTagName("body").item(0);');d.writeln('bd.appendChild(pr);');d.writeln('}');d.writeln('</script>');d.writeln('<h1>診断箇所一覧</h1>');d.writeln('<button onclick="export_data()">Export</button>');d.writeln('<button onclick="win_close()">Close</button><br>');d.writeln('</body></html>');var bd = d.getElementsByTagName("body").item(0);var ta = d.createElement("textarea");ta.setAttribute("id", "ta");ta.textContent = str;bd.appendChild(ta);}var d=document.getElementById("source");var dch=d.childNodes;var str="";for(var i=0;i<dch.length;i++){if(dch.item(i).id){var j=i+1;if(dch.item(j).nodeValue!=null){str+="▼"+"\r\n";str+=dch.item(j).nodeValue+"\r\n";}}}trgr();})();

//labelタグ自動挿入
javascript:(function(){
  var%20src=document.getElementById("srccode").value;
  src=clean(src);

  /*周辺のタグを抽出*/
  var%20pt1=new RegExp(/(><.*)(.*type=.*text.*>)/);
  var%20arr1=src.match(pt1);
  var%20srch1=arr1[1].toString();

  /*周辺のタグからテキストフィールドタグだけを抽出*/
  var%20pt2=new RegExp(/(<input.*type=.*text.*?>)/);
  var%20arr2=srch1.match(pt2);
  var%20srch2=arr2[1].toString();
  var%20srch2all=arr2[0].toString();

  var%20setid="";
  var%20rdmtag="";

  /*id属性を抽出*/
  var%20idpt=new RegExp(/id=\"(.*?)\" /);
  var%20iarr=srch2.match(idpt);
  if(iarr==null){
    setid="q";
    rdmtag=srch2.replace('<input ','<input id="'+setid+'" ');
  }else{
    setid=iarr[1].toString();
    rdmtag=srch2;
  }

  /*ラベルタグの中身を指定*/
  var%20cont=prompt("ラベルの内容を入力","サイト内検索");

  /*修正後タグ*/
  rdmtag=rdmtag.replace('<input ','<label for="'+setid+'">'+cont+'</label><input ');

  src=src.replace(srch2all,rdmtag);
  document.getElementById("srccode").value=src;
  document.getElementById("comments").value="label要素が存在しない";

  /*行頭のspace,tab,改行除去関数*/
  function%20clean(str){
    str=str.replace(/^ +/m,"");
    str=str.replace(/\t+/m,"");
    str=str.replace(/(\r\n|\r|\n)/g,""); 
    return%20str;
  }

})();


javascript:(function(){var%20src=document.getElementById("srccode").value;src=clean(src);/*周辺のタグを抽出*/var%20pt1=new RegExp(/(><.*)(.*type=.*text.*>)/);var%20arr1=src.match(pt1);var%20srch1=arr1[1].toString();/*周辺のタグからテキストフィールドタグだけを抽出*/var%20pt2=new RegExp(/(<input.*type=.*text.*?>)/);var%20arr2=srch1.match(pt2);var%20srch2=arr2[1].toString();var%20srch2all=arr2[0].toString();var%20setid="";var%20rdmtag="";/*id属性を抽出*/var%20idpt=new RegExp(/id=\"(.*?)\" /);var%20iarr=srch2.match(idpt);if(iarr==null){setid="q";rdmtag=srch2.replace('<input ','<input id="'+setid+'" ');}else{setid=iarr[1].toString();rdmtag=srch2;}/*ラベルタグの中身を指定*/var%20cont=prompt("ラベルの内容を入力","サイト内検索");/*修正後タグ*/rdmtag=rdmtag.replace('<input ','<label for="'+setid+'">'+cont+'</label><input ');src=src.replace(srch2all,rdmtag);document.getElementById("srccode").value=src;document.getElementById("comments").value="label要素が存在しない";/*行頭のspace,tab,改行除去関数*/function%20clean(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return%20str;}})();

//CCAコメントエディタ
javascript:(function(){
	function trgr(){
		d=window.open().document;
		d.write('<!DOCTYPE html>');
		d.write('<html lang="ja">');
		d.write('<head>');
		d.write('<meta charset="utf-8">');
		d.write('<title>CCA Comment-Editor</title>	');
		d.write('<style type="text/css">');
		d.write('* {font-family: "メイリオ",Meiryo,sans-serif; }');
		d.write('#source { width: 450px; height: 10em; font-size: 90%; margin-bottom: 15px; }');
		d.write('#source2 { width: 450px; height: 8em; font-size: 90%; margin-bottom: 15px; }');
		d.write('</style>');
		d.write('</head>');
		d.write('<body>');
		d.write('<script type="text/javascript">');
		d.write('function get_text(){');
		d.write('return document.getElementById("source").value;');
		d.write('}');
		d.write('function set_text(str){');
		d.write('document.getElementById("source").value = str;');
		d.write('}');
		d.write('function delete_text(){');
		d.write('document.getElementById("source").value = "";');
		d.write('}');
		d.write('function delete_subtext(){');
		d.write('document.getElementById("source2").value = "";');
		d.write('}');
		d.write('function copy_bottom(){');
		d.write('var str = get_text();');
		d.write('if(document.getElementById("source2")==null){');
		d.write('alert("サブテキスト欄がありません");');
		d.write('}else{');
		d.write('document.getElementById("source2").value = str;');
		d.write('}');
		d.write('}');
		d.write('function copy_up(){');
		d.write('var str = document.getElementById("source2").value;');
		d.write('set_text(str);');
		d.write('}');
		d.write('function clean(){');
		d.write('var src = get_text();');
		d.write('src=src.replace(/\\n\\n/g, "\\n");');
		d.write('set_text(src);');
		d.write('}');
		d.write('function write_comment(){');
		d.write('var src = get_text();');
		d.write('if(get_radio_val()=="G18"){');
		d.write('src = "以下のコンテンツがコントラスト比4.5:1以上を満たさない\\n" + src;');
		d.write('} else {');
		d.write('src = "以下のコンテンツがコントラスト比3:1以上を満たさない\\n" + src;');
		d.write('}');
		d.write('set_text(src);');
		d.write('}');
		d.write('function enterkey(){');
		d.write('var src = get_text();');
		d.write('src = src += "\\n";');
		d.write('set_text(src);');
		d.write('}');
		d.write('function get_radio_val(){');
		d.write('var ret = "";');
		d.write('var arr = document.getElementsByName("cd");');
		d.write('for(var i=0; i<arr.length; i++){');
		d.write('if(arr[i].checked){');
		d.write('ret = arr[i].value;');
		d.write('break;');
		d.write('}');
		d.write('}');
		d.write('return ret;');
		d.write('}');
		d.write('function create_textarea(){');
		d.write('if(document.getElementById("source2")==null){');
		d.write('b = document.getElementsByTagName("body").item(0);');
		d.write('bt1 = document.createElement("button");');
		d.write('bt1.setAttribute("onclick", "delete_subtext()");');
		d.write('bt1.innerHTML="delete";');
		d.write('b.appendChild(bt1);');
		d.write('bt2 = document.createElement("button");');
		d.write('bt2.setAttribute("onclick", "copy_up()");');
		d.write('bt2.innerHTML="cpUp";');
		d.write('b.appendChild(bt2);');
		d.write('br = document.createElement("br");');
		d.write('b.appendChild(br);');
		d.write('e = document.createElement("textarea");');
		d.write('e.setAttribute("id", "source2");');
		d.write('b.appendChild(e);');
		d.write('}');
		d.write('}');
		d.write('</script>');
		d.write('<h1>CCA Comment-Editor</h1>');
		d.write('<label><input type="radio" name="cd" id="cd18" value="G18" checked="checked">G18</label>');
		d.write('<label><input type="radio" name="cd" id="cd145" value="G145">G145</label><br>');
		d.write('<button onclick="clean()">clean</button>');
		d.write('<button onclick="enterkey()">enter</button>');
		d.write('<button onclick="write_comment()">comment</button>');
		d.write('<button onclick="delete_text()">delete</button>');
		d.write('<button onclick="create_textarea()">SubText</button>');
		d.write('<button onclick="copy_bottom()">CpBottom</button><br>');
		d.write('<textarea id="source"></textarea><br>');
		d.write('</body>');
		d.write('</html>');
	}
	trgr();
})();

javascript:(function(){function trgr(){d=window.open().document;d.write('<!DOCTYPE html>');d.write('<html lang="ja">');d.write('<head>');d.write('<meta charset="utf-8">');d.write('<title>CCA Comment-Editor</title>	');d.write('<style type="text/css">');d.write('* {font-family: "メイリオ",Meiryo,sans-serif; }');d.write('#source { width: 450px; height: 10em; font-size: 90%; margin-bottom: 15px; }');d.write('#source2 { width: 450px; height: 8em; font-size: 90%; margin-bottom: 15px; }');d.write('</style>');d.write('</head>');d.write('<body>');d.write('<script type="text/javascript">');d.write('function get_text(){');d.write('return document.getElementById("source").value;');d.write('}');d.write('function set_text(str){');d.write('document.getElementById("source").value = str;');d.write('}');d.write('function delete_text(){');d.write('document.getElementById("source").value = "";');d.write('}');d.write('function delete_subtext(){');d.write('document.getElementById("source2").value = "";');d.write('}');d.write('function copy_bottom(){');d.write('var str = get_text();');d.write('if(document.getElementById("source2")==null){');d.write('alert("サブテキスト欄がありません");');d.write('}else{');d.write('document.getElementById("source2").value = str;');d.write('}');d.write('}');d.write('function copy_up(){');d.write('var str = document.getElementById("source2").value;');d.write('set_text(str);');d.write('}');d.write('function clean(){');d.write('var src = get_text();');d.write('src=src.replace(/\\n\\n/g, "\\n");');d.write('set_text(src);');d.write('}');d.write('function write_comment(){');d.write('var src = get_text();');d.write('if(get_radio_val()=="G18"){');d.write('src = "以下のコンテンツがコントラスト比4.5:1以上を満たさない\\n" + src;');d.write('} else {');d.write('src = "以下のコンテンツがコントラスト比3:1以上を満たさない\\n" + src;');d.write('}');d.write('set_text(src);');d.write('}');d.write('function enterkey(){');d.write('var src = get_text();');d.write('src = src += "\\n";');d.write('set_text(src);');d.write('}');d.write('function get_radio_val(){');d.write('var ret = "";');d.write('var arr = document.getElementsByName("cd");');d.write('for(var i=0; i<arr.length; i++){');d.write('if(arr[i].checked){');d.write('ret = arr[i].value;');d.write('break;');d.write('}');d.write('}');d.write('return ret;');d.write('}');d.write('function create_textarea(){');d.write('if(document.getElementById("source2")==null){');d.write('b = document.getElementsByTagName("body").item(0);');d.write('bt1 = document.createElement("button");');d.write('bt1.setAttribute("onclick", "delete_subtext()");');d.write('bt1.innerHTML="delete";');d.write('b.appendChild(bt1);');d.write('bt2 = document.createElement("button");');d.write('bt2.setAttribute("onclick", "copy_up()");');d.write('bt2.innerHTML="cpUp";');d.write('b.appendChild(bt2);');d.write('br = document.createElement("br");');d.write('b.appendChild(br);');d.write('e = document.createElement("textarea");');d.write('e.setAttribute("id", "source2");');d.write('b.appendChild(e);');d.write('}');d.write('}');d.write('</script>');d.write('<h1>CCA Comment-Editor</h1>');d.write('<label><input type="radio" name="cd" id="cd18" value="G18" checked="checked">G18</label>');d.write('<label><input type="radio" name="cd" id="cd145" value="G145">G145</label><br>');d.write('<button onclick="clean()">clean</button>');d.write('<button onclick="enterkey()">enter</button>');d.write('<button onclick="write_comment()">comment</button>');d.write('<button onclick="delete_text()">delete</button>');d.write('<button onclick="create_textarea()">SubText</button>');d.write('<button onclick="copy_bottom()">CpBottom</button><br>');d.write('<textarea id="source"></textarea><br>');d.write('</body>');d.write('</html>');}trgr();})();

//V2
javascript:(function(){
	var keylist = "～のバナー|～のメニュー|～のボタン|～の文字|～の文字画像|h1要素|h2要素|h3要素|h4要素|「 」|（　）|【 】|上の|下の|左の|右の|上下左右";
	trgr();
	function trgr(){
		d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>CCA CE(V2)</title>	');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif; }');
		d.writeln('label {font-size: 90%;}');
		d.writeln('#source { width: 450px; height: 10em; font-size: 90%; margin-bottom: 15px; }');
		d.writeln('#source2 { width: 450px; height: 8em; font-size: 90%; margin-bottom: 15px; }');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function get_text(){');
		d.writeln('return document.getElementById("source").value;');
		d.writeln('}');
		d.writeln('function set_text(str){');
		d.writeln('document.getElementById("source").value = str;');
		d.writeln('}');
		d.writeln('function delete_text(){');
		d.writeln('document.getElementById("source").value = "";');
		d.writeln('}');
		d.writeln('function delete_subtext(){');
		d.writeln('document.getElementById("source2").value = "";');
		d.writeln('}');
		d.writeln('function copy_bottom(){');
		d.writeln('var str = get_text();');
		d.writeln('if(document.getElementById("source2")==null){');
		d.writeln('alert("サブテキスト欄がありません");');
		d.writeln('}else{');
		d.writeln('document.getElementById("source2").value = str;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function copy_up(){');
		d.writeln('var str = document.getElementById("source2").value;');
		d.writeln('set_text(str);');
		d.writeln('}');
		d.writeln('function clean(){');
		d.writeln('var src = get_text();');
		d.writeln('src=src.replace(/\\n\\n/g, "\\n");');
		d.writeln('set_text(src);');
		d.writeln('}');
		d.writeln('function write_comment(){');
		d.writeln('var src = get_text();');
		d.writeln('if(get_radio_val()=="G18"){');
		d.writeln('src = "以下のコンテンツがコントラスト比4.5:1以上を満たさない\\n" + src;');
		d.writeln('} else {');
		d.writeln('src = "以下のコンテンツがコントラスト比3:1以上を満たさない\\n" + src;');
		d.writeln('}');
		d.writeln('set_text(src);');
		d.writeln('}');
		d.writeln('function get_radio_val(){');
		d.writeln('var ret = "";');
		d.writeln('var arr = document.getElementsByName("cd");');
		d.writeln('for(var i=0; i<arr.length; i++){');
		d.writeln('if(arr[i].checked){');
		d.writeln('ret = arr[i].value;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('return ret;');
		d.writeln('}');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function this_text_insert(src, target){');
		d.writeln('var sc = document.getElementById(src);');
		d.writeln('var text = sc.value;');
		d.writeln('text_insert(target, text);');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function create_textarea(){');
		d.writeln('if(document.getElementById("source2")==null){');
		d.writeln('b = document.getElementsByTagName("body").item(0);');
		d.writeln('bt1 = document.createElement("button");');
		d.writeln('bt1.setAttribute("onclick", "br_insert(\'source2\')");');
		d.writeln('bt1.textContent = "Br";');
		d.writeln('b.appendChild(bt1);');
		d.writeln('bt2 = document.createElement("button");');
		d.writeln('bt2.setAttribute("onclick", "delete_subtext()");');
		d.writeln('bt2.textContent="Del";');
		d.writeln('b.appendChild(bt2);');
		d.writeln('bt3 = document.createElement("button");');
		d.writeln('bt3.setAttribute("onclick", "copy_up()");');
		d.writeln('bt3.textContent = "CopyUp";');
		d.writeln('b.appendChild(bt3);');
		d.writeln('br = document.createElement("br");');
		d.writeln('b.appendChild(br);');
		d.writeln('e = document.createElement("textarea");');
		d.writeln('e.setAttribute("id", "source2");');
		d.writeln('b.appendChild(e);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>CCA Comment-Editor <small>(V2)</small></h1>');
		d.writeln('<label><input type="radio" name="cd" id="cd18" value="G18" checked="checked">G18</label>');
		d.writeln('<label><input type="radio" name="cd" id="cd145" value="G145">G145</label>');
		d.writeln('<select id="snippet"></select>');
		d.writeln('<button onclick="this_text_insert(\'snippet\',\'source\')">Insert</button>');
		d.writeln('<br>');
		d.writeln('<button onclick="clean()">Clean</button>');
		d.writeln('<button onclick="br_insert(\'source\')">Br</button>');
		d.writeln('<button onclick="write_comment()">Comment</button>');
		d.writeln('<button onclick="delete_text()">Del</button>');
		d.writeln('<button onclick="create_textarea()">SubText</button>');
		d.writeln('<button onclick="copy_bottom()">CpBottom</button><br>');
		d.writeln('<textarea id="source"></textarea><br>');
		d.writeln('</body>');
		d.writeln('</html>');
		var keyarr = keylist.split("|");
		var target = d.getElementById("snippet");
		for(var i=0; i<keyarr.length; i++){
		var opt = d.createElement("option");
			opt.setAttribute("id", i);
			opt.textContent = keyarr[i].toString();
			target.appendChild(opt);
		}
	}
})();

javascript:(function(){var keylist = "～のバナー|～のメニュー|～のボタン|～の文字|～の文字画像|h1要素|h2要素|h3要素|h4要素|「 」|（　）|【 】|上の|下の|左の|右の|上下左右";trgr();function trgr(){d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>CCA CE(V2)</title>	');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif; }');d.writeln('label {font-size: 90%;}');d.writeln('#source { width: 450px; height: 10em; font-size: 90%; margin-bottom: 15px; }');d.writeln('#source2 { width: 450px; height: 8em; font-size: 90%; margin-bottom: 15px; }');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function get_text(){');d.writeln('return document.getElementById("source").value;');d.writeln('}');d.writeln('function set_text(str){');d.writeln('document.getElementById("source").value = str;');d.writeln('}');d.writeln('function delete_text(){');d.writeln('document.getElementById("source").value = "";');d.writeln('}');d.writeln('function delete_subtext(){');d.writeln('document.getElementById("source2").value = "";');d.writeln('}');d.writeln('function copy_bottom(){');d.writeln('var str = get_text();');d.writeln('if(document.getElementById("source2")==null){');d.writeln('alert("サブテキスト欄がありません");');d.writeln('}else{');d.writeln('document.getElementById("source2").value = str;');d.writeln('}');d.writeln('}');d.writeln('function copy_up(){');d.writeln('var str = document.getElementById("source2").value;');d.writeln('set_text(str);');d.writeln('}');d.writeln('function clean(){');d.writeln('var src = get_text();');d.writeln('src=src.replace(/\\n\\n/g, "\\n");');d.writeln('set_text(src);');d.writeln('}');d.writeln('function write_comment(){');d.writeln('var src = get_text();');d.writeln('if(get_radio_val()=="G18"){');d.writeln('src = "以下のコンテンツがコントラスト比4.5:1以上を満たさない\\n" + src;');d.writeln('} else {');d.writeln('src = "以下のコンテンツがコントラスト比3:1以上を満たさない\\n" + src;');d.writeln('}');d.writeln('set_text(src);');d.writeln('}');d.writeln('function get_radio_val(){');d.writeln('var ret = "";');d.writeln('var arr = document.getElementsByName("cd");');d.writeln('for(var i=0; i<arr.length; i++){');d.writeln('if(arr[i].checked){');d.writeln('ret = arr[i].value;');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('return ret;');d.writeln('}');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function this_text_insert(src, target){');d.writeln('var sc = document.getElementById(src);');d.writeln('var text = sc.value;');d.writeln('text_insert(target, text);');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function create_textarea(){');d.writeln('if(document.getElementById("source2")==null){');d.writeln('b = document.getElementsByTagName("body").item(0);');d.writeln('bt1 = document.createElement("button");');d.writeln('bt1.setAttribute("onclick", "br_insert(\'source2\')");');d.writeln('bt1.textContent = "Br";');d.writeln('b.appendChild(bt1);');d.writeln('bt2 = document.createElement("button");');d.writeln('bt2.setAttribute("onclick", "delete_subtext()");');d.writeln('bt2.textContent="Del";');d.writeln('b.appendChild(bt2);');d.writeln('bt3 = document.createElement("button");');d.writeln('bt3.setAttribute("onclick", "copy_up()");');d.writeln('bt3.textContent = "CopyUp";');d.writeln('b.appendChild(bt3);');d.writeln('br = document.createElement("br");');d.writeln('b.appendChild(br);');d.writeln('e = document.createElement("textarea");');d.writeln('e.setAttribute("id", "source2");');d.writeln('b.appendChild(e);');d.writeln('}');d.writeln('}');d.writeln('</script>');d.writeln('<h1>CCA Comment-Editor <small>(V2)</small></h1>');d.writeln('<label><input type="radio" name="cd" id="cd18" value="G18" checked="checked">G18</label>');d.writeln('<label><input type="radio" name="cd" id="cd145" value="G145">G145</label>');d.writeln('<select id="snippet"></select>');d.writeln('<button onclick="this_text_insert(\'snippet\',\'source\')">Insert</button>');d.writeln('<br>');d.writeln('<button onclick="clean()">Clean</button>');d.writeln('<button onclick="br_insert(\'source\')">Br</button>');d.writeln('<button onclick="write_comment()">Comment</button>');d.writeln('<button onclick="delete_text()">Del</button>');d.writeln('<button onclick="create_textarea()">SubText</button>');d.writeln('<button onclick="copy_bottom()">CpBottom</button><br>');d.writeln('<textarea id="source"></textarea><br>');d.writeln('</body>');d.writeln('</html>');var keyarr = keylist.split("|");var target = d.getElementById("snippet");for(var i=0; i<keyarr.length; i++){var opt = d.createElement("option");opt.setAttribute("id", i);opt.textContent = keyarr[i].toString();target.appendChild(opt);}}})();


//ソースHTMLエディタ
javascript:(function(){
	function trgr(){
		d=window.open().document;
		d.write('<!DOCTYPE html>');
		d.write('<html lang="ja">');
		d.write('<head>');
		d.write('<meta charset="utf-8">');
		d.write('<title>SourceHTML-Editor</title>	');
		d.write('<style type="text/css">');
		d.write('* {font-family: "メイリオ",Meiryo,sans-serif; }');
		d.write('#source { width: 650px; height: 15em; font-size: 90%; }');
		d.write('#subsource { width: 650px; height: 5em; font-size: 90%; }');
		d.write('#htmlsrc { width: 334px; height: 5em; font-size: 90%; }');
		d.write('#attrsrc { width: 334px; height: 5em; font-size: 90%; }');
		d.write('</style>');
		d.write('</head>');
		d.write('<body>');
		d.write('<script type="text/javascript">');
		d.write('function get_text(){');
		d.write('return document.getElementById("source").value;');
		d.write('}');
		d.write('function set_text(str){');
		d.write('document.getElementById("source").value = str;');
		d.write('}');
		d.write('function delete_this_text(id){');
		d.write('document.getElementById(id).value = "";');
		d.write('}');
		d.write('function copy_bottom(){');
		d.write('var str = get_text();');
		d.write('if(document.getElementById("subsource")==null){');
		d.write('alert("サブテキスト欄がありません");');
		d.write('}else{');
		d.write('document.getElementById("subsource").value = str;');
		d.write('}');
		d.write('}');
		d.write('function copy_up(){');
		d.write('var str = document.getElementById("subsource").value;');
		d.write('set_text(str);');
		d.write('}');
		d.write('function clean(){');
		d.write('var src = get_text();');
		d.write('src=src.replace(/\\n\\n/g, "\\n");');
		d.write('set_text(src);');
		d.write('}');
		d.write('function write_comment(){');
		d.write('}');
		d.write('function enterkey(){');
		d.write('var src = get_text();');
		d.write('src = src += "\\n";');
		d.write('set_text(src);');
		d.write('}');
		d.write('function get_radio_val(){');
		d.write('var ret = "";');
		d.write('var arr = document.getElementsByName("cd");');
		d.write('for(var i=0; i<arr.length; i++){');
		d.write('if(arr[i].checked){');
		d.write('ret = arr[i].value;');
		d.write('break;');
		d.write('}');
		d.write('}');
		d.write('return ret;');
		d.write('}');
		d.write('function create_subtext(){');
		d.write('if(document.getElementById("subsource")==null){');
		d.write('b = document.getElementsByTagName("body").item(0);');
		d.write('e = document.createElement("textarea");');
		d.write('e.setAttribute("id", "subsource");');
		d.write('b.appendChild(e);');
		d.write('br = document.createElement("br");');
		d.write('b.appendChild(br);');
		d.write('bt1 = document.createElement("button");');
		d.write('bt1.setAttribute("onclick", "delete_this_text(\'subsource\')");');
		d.write('bt1.innerHTML="delete";');
		d.write('b.appendChild(bt1);');
		d.write('bt2 = document.createElement("button");');
		d.write('bt2.setAttribute("onclick", "copy_up()");');
		d.write('bt2.innerHTML="CpUp";');
		d.write('b.appendChild(bt2);');
		d.write('br2 = document.createElement("br");');
		d.write('b.appendChild(br2);');
		d.write('}');
		d.write('}');
		d.write('function create_tag_creator(){');
		d.write('if(document.getElementById("htmlsrc")==null){');
		d.write('b = document.getElementsByTagName("body").item(0);');
		d.write('lbl = document.createElement("label");');
		d.write('lbl.setAttribute("for","tag");');
		d.write('lbl.innerHTML = "Tag:";');
		d.write('b.appendChild(lbl);');
		d.write('ipt = document.createElement("input");');
		d.write('ipt.setAttribute("type","text");');
		d.write('ipt.setAttribute("size","5");');
		d.write('ipt.setAttribute("id","tag");');
		d.write('b.appendChild(ipt);');
		d.write('btn1 = document.createElement("button");');
		d.write('btn1.setAttribute("onclick","tag_create()");');
		d.write('btn1.innerHTML = "Create";');
		d.write('b.appendChild(btn1);');
		d.write('btn2 = document.createElement("button");');
		d.write('btn2.setAttribute("onclick","delete_this_text(\'tag\')");');
		d.write('btn2.innerHTML = "Delete";');
		d.write('b.appendChild(btn2);');
		d.write('br1 = document.createElement("br");');
		d.write('b.appendChild(br1);');
		d.write('tarea = document.createElement("textarea");');
		d.write('tarea.setAttribute("id", "htmlsrc");');
		d.write('b.appendChild(tarea);');
		d.write('br2 = document.createElement("br");');
		d.write('b.appendChild(br2);');
		d.write('bt3 = document.createElement("button");');
		d.write('bt3.setAttribute("onclick", "delete_this_text(\'htmlsrc\')");');
		d.write('bt3.innerHTML="Delete";');
		d.write('b.appendChild(bt3);');
		d.write('br3 = document.createElement("br");');
		d.write('b.appendChild(br3);');
		d.write('}');
		d.write('}');
		d.write('function create_attr_creator(){');
		d.write('if(document.getElementById("attrsrc")==null){');
		d.write('b = document.getElementsByTagName("body").item(0);');
		d.write('lbl = document.createElement("label");');
		d.write('lbl.setAttribute("for","tag");');
		d.write('lbl.innerHTML = "Attribure:";');
		d.write('b.appendChild(lbl);');
		d.write('ipt = document.createElement("input");');
		d.write('ipt.setAttribute("type","text");');
		d.write('ipt.setAttribute("size","5");');
		d.write('ipt.setAttribute("id","attr");');
		d.write('b.appendChild(ipt);');
		d.write('btn1 = document.createElement("button");');
		d.write('btn1.setAttribute("onclick","attr_create()");');
		d.write('btn1.innerHTML = "Create";');
		d.write('b.appendChild(btn1);');
		d.write('btn2 = document.createElement("button");');
		d.write('btn2.setAttribute("onclick","delete_this_text(\'attr\')");');
		d.write('btn2.innerHTML = "Delete";');
		d.write('b.appendChild(btn2);');
		d.write('br1 = document.createElement("br");');
		d.write('b.appendChild(br1);');
		d.write('tarea = document.createElement("textarea");');
		d.write('tarea.setAttribute("id", "attrsrc");');
		d.write('b.appendChild(tarea);');
		d.write('br2 = document.createElement("br");');
		d.write('b.appendChild(br2);');
		d.write('bt3 = document.createElement("button");');
		d.write('bt3.setAttribute("onclick", "delete_this_text(\'attrsrc\')");');
		d.write('bt3.innerHTML="Delete";');
		d.write('b.appendChild(bt3);');
		d.write('br3 = document.createElement("br");');
		d.write('b.appendChild(br3);');
		d.write('}');
		d.write('}');
		d.write('function send_text(){');
		d.write('var str = get_text();');
		d.write('window.opener.document.getElementById("srccode").value=str;');
		d.write('}');
		d.write('function tag_create(){');
		d.write('if(document.getElementById("tag").value==""){');
		d.write('alert("要素名を入力してください！");');
		d.write('}else{');
		d.write('var str = document.getElementById("tag").value;');
		d.write('var tag = "<"+str+">"+"</"+str+">";');
		d.write('if(str=="label"){');
		d.write('tag = tag.replace("<label>","<label for=\\"\\">");');
		d.write('}');
		d.write('var src = document.getElementById("htmlsrc").value;');
		d.write('src = src + tag + "\\n";');
		d.write('document.getElementById("htmlsrc").value=src;');
		d.write('}');
		d.write('}');
		d.write('function attr_create(){');
		d.write('if(document.getElementById("attr").value==""){');
		d.write('alert("属性名を入力してください！");');
		d.write('}else{');
		d.write('var str = document.getElementById("attr").value;');
		d.write('var attr = str + "=\\"\\"";');
		d.write('var src = document.getElementById("attrsrc").value;');
		d.write('src = src + attr + "\\n";');
		d.write('document.getElementById("attrsrc").value=src;');
		d.write('}');
		d.write('}');
		d.write('</script>');
		d.write('<h1>SourceHTML-Editor</h1>');
		d.write('<button onclick="send_text()">Send</button>');
		d.write('<button onclick="clean()">Clean</button>');
		d.write('<button onclick="enterkey()">Enter</button>');
		d.write('<button onclick="delete_this_text(\'source\')">Delete</button>');
		d.write('<button onclick="create_subtext()">Subtext</button>');
		d.write('<button onclick="create_tag_creator()">Tag</button>');
		d.write('<button onclick="create_attr_creator()">Attr</button>');
		d.write('<button onclick="copy_bottom()">CpDown</button><br>');
		d.write('<textarea id="source"></textarea><br>');
		d.write('</body>');
		d.write('</html>');
		d.getElementById("source").value=src;
	}
	var%20src=document.getElementById("description").value;
	trgr();
})();

javascript:(function(){function trgr(){d=window.open().document;d.write('<!DOCTYPE html>');d.write('<html lang="ja">');d.write('<head>');d.write('<meta charset="utf-8">');d.write('<title>SourceHTML-Editor</title>	');d.write('<style type="text/css">');d.write('* {font-family: "メイリオ",Meiryo,sans-serif; }');d.write('#source { width: 650px; height: 15em; font-size: 90%; }');d.write('#subsource { width: 650px; height: 5em; font-size: 90%; }');d.write('#htmlsrc { width: 334px; height: 5em; font-size: 90%; }');d.write('#attrsrc { width: 334px; height: 5em; font-size: 90%; }');d.write('</style>');d.write('</head>');d.write('<body>');d.write('<script type="text/javascript">');d.write('function get_text(){');d.write('return document.getElementById("source").value;');d.write('}');d.write('function set_text(str){');d.write('document.getElementById("source").value = str;');d.write('}');d.write('function delete_this_text(id){');d.write('document.getElementById(id).value = "";');d.write('}');d.write('function copy_bottom(){');d.write('var str = get_text();');d.write('if(document.getElementById("subsource")==null){');d.write('alert("サブテキスト欄がありません");');d.write('}else{');d.write('document.getElementById("subsource").value = str;');d.write('}');d.write('}');d.write('function copy_up(){');d.write('var str = document.getElementById("subsource").value;');d.write('set_text(str);');d.write('}');d.write('function clean(){');d.write('var src = get_text();');d.write('src=src.replace(/\\n\\n/g, "\\n");');d.write('set_text(src);');d.write('}');d.write('function write_comment(){');d.write('}');d.write('function enterkey(){');d.write('var src = get_text();');d.write('src = src += "\\n";');d.write('set_text(src);');d.write('}');d.write('function get_radio_val(){');d.write('var ret = "";');d.write('var arr = document.getElementsByName("cd");');d.write('for(var i=0; i<arr.length; i++){');d.write('if(arr[i].checked){');d.write('ret = arr[i].value;');d.write('break;');d.write('}');d.write('}');d.write('return ret;');d.write('}');d.write('function create_subtext(){');d.write('if(document.getElementById("subsource")==null){');d.write('b = document.getElementsByTagName("body").item(0);');d.write('e = document.createElement("textarea");');d.write('e.setAttribute("id", "subsource");');d.write('b.appendChild(e);');d.write('br = document.createElement("br");');d.write('b.appendChild(br);');d.write('bt1 = document.createElement("button");');d.write('bt1.setAttribute("onclick", "delete_this_text(\'subsource\')");');d.write('bt1.innerHTML="delete";');d.write('b.appendChild(bt1);');d.write('bt2 = document.createElement("button");');d.write('bt2.setAttribute("onclick", "copy_up()");');d.write('bt2.innerHTML="CpUp";');d.write('b.appendChild(bt2);');d.write('br2 = document.createElement("br");');d.write('b.appendChild(br2);');d.write('}');d.write('}');d.write('function create_tag_creator(){');d.write('if(document.getElementById("htmlsrc")==null){');d.write('b = document.getElementsByTagName("body").item(0);');d.write('lbl = document.createElement("label");');d.write('lbl.setAttribute("for","tag");');d.write('lbl.innerHTML = "Tag:";');d.write('b.appendChild(lbl);');d.write('ipt = document.createElement("input");');d.write('ipt.setAttribute("type","text");');d.write('ipt.setAttribute("size","5");');d.write('ipt.setAttribute("id","tag");');d.write('b.appendChild(ipt);');d.write('btn1 = document.createElement("button");');d.write('btn1.setAttribute("onclick","tag_create()");');d.write('btn1.innerHTML = "Create";');d.write('b.appendChild(btn1);');d.write('btn2 = document.createElement("button");');d.write('btn2.setAttribute("onclick","delete_this_text(\'tag\')");');d.write('btn2.innerHTML = "Delete";');d.write('b.appendChild(btn2);');d.write('br1 = document.createElement("br");');d.write('b.appendChild(br1);');d.write('tarea = document.createElement("textarea");');d.write('tarea.setAttribute("id", "htmlsrc");');d.write('b.appendChild(tarea);');d.write('br2 = document.createElement("br");');d.write('b.appendChild(br2);');d.write('bt3 = document.createElement("button");');d.write('bt3.setAttribute("onclick", "delete_this_text(\'htmlsrc\')");');d.write('bt3.innerHTML="Delete";');d.write('b.appendChild(bt3);');d.write('br3 = document.createElement("br");');d.write('b.appendChild(br3);');d.write('}');d.write('}');d.write('function create_attr_creator(){');d.write('if(document.getElementById("attrsrc")==null){');d.write('b = document.getElementsByTagName("body").item(0);');d.write('lbl = document.createElement("label");');d.write('lbl.setAttribute("for","tag");');d.write('lbl.innerHTML = "Attribure:";');d.write('b.appendChild(lbl);');d.write('ipt = document.createElement("input");');d.write('ipt.setAttribute("type","text");');d.write('ipt.setAttribute("size","5");');d.write('ipt.setAttribute("id","attr");');d.write('b.appendChild(ipt);');d.write('btn1 = document.createElement("button");');d.write('btn1.setAttribute("onclick","attr_create()");');d.write('btn1.innerHTML = "Create";');d.write('b.appendChild(btn1);');d.write('btn2 = document.createElement("button");');d.write('btn2.setAttribute("onclick","delete_this_text(\'attr\')");');d.write('btn2.innerHTML = "Delete";');d.write('b.appendChild(btn2);');d.write('br1 = document.createElement("br");');d.write('b.appendChild(br1);');d.write('tarea = document.createElement("textarea");');d.write('tarea.setAttribute("id", "attrsrc");');d.write('b.appendChild(tarea);');d.write('br2 = document.createElement("br");');d.write('b.appendChild(br2);');d.write('bt3 = document.createElement("button");');d.write('bt3.setAttribute("onclick", "delete_this_text(\'attrsrc\')");');d.write('bt3.innerHTML="Delete";');d.write('b.appendChild(bt3);');d.write('br3 = document.createElement("br");');d.write('b.appendChild(br3);');d.write('}');d.write('}');d.write('function send_text(){');d.write('var str = get_text();');d.write('window.opener.document.getElementById("srccode").value=str;');d.write('}');d.write('function tag_create(){');d.write('if(document.getElementById("tag").value==""){');d.write('alert("要素名を入力してください！");');d.write('}else{');d.write('var str = document.getElementById("tag").value;');d.write('var tag = "<"+str+">"+"</"+str+">";');d.write('if(str=="label"){');d.write('tag = tag.replace("<label>","<label for=\\"\\">");');d.write('}');d.write('var src = document.getElementById("htmlsrc").value;');d.write('src = src + tag + "\\n";');d.write('document.getElementById("htmlsrc").value=src;');d.write('}');d.write('}');d.write('function attr_create(){');d.write('if(document.getElementById("attr").value==""){');d.write('alert("属性名を入力してください！");');d.write('}else{');d.write('var str = document.getElementById("attr").value;');d.write('var attr = str + "=\\"\\"";');d.write('var src = document.getElementById("attrsrc").value;');d.write('src = src + attr + "\\n";');d.write('document.getElementById("attrsrc").value=src;');d.write('}');d.write('}');d.write('</script>');d.write('<h1>SourceHTML-Editor</h1>');d.write('<button onclick="send_text()">Send</button>');d.write('<button onclick="clean()">Clean</button>');d.write('<button onclick="enterkey()">Enter</button>');d.write('<button onclick="delete_this_text(\'source\')">Delete</button>');d.write('<button onclick="create_subtext()">Subtext</button>');d.write('<button onclick="create_tag_creator()">Tag</button>');d.write('<button onclick="create_attr_creator()">Attr</button>');d.write('<button onclick="copy_bottom()">CpDown</button><br>');d.write('<textarea id="source"></textarea><br>');d.write('</body>');d.write('</html>');d.getElementById("source").value=src;}var%20src=document.getElementById("description").value;trgr();})();


//V2
javascript:(function(){
	var tags = {
	  strong: "<strong></strong>",
	  em: "<em></em>",
	  span: "<span></span>",
	  label: "<label></label>",
	  caption: "<caption></caption>",
	  p: "<p></p>",
	  div: "<div></div>",
	  th: "<th></th>"
	};
	var stylesets = {
	  font_size: "font-size:",
	  color: "color:",
	  background: "background:",
	  font_family: "font-family:",
	  text_align: "text-align:",
	  text_decoration: "text-decoration:",
	  position: "position:",
	  left: "left:",
	  margin: "margin:"
	};
	var attrs = {
	  style: "style",
	  title: "title",
	  _for: "for",
	  id: "id",
	  summary: "summary",
	  scope: "scope"
	};
	var comms = [
	  "強調を意図している、セマンティックなマークアップが必要",
	  "周囲の色と異なる文字で強調をしている箇所がセマンティックな要素でマークアップされていない",
	  "非推奨タグが使用されている",
	  "取り消し線はdel要素でマークアップする。",
	  "title属性が無い",
	  "label要素は存在するがinput要素と関連付けられていない",
	  "th要素が使用されていない"
	];
	var snippets = [
	  " を入力",
	  " を選択"
	];
	var srccode = document.getElementById("srccode").value;
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>SourceHTML-Editor</title>	');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif; }');
		d.writeln('label {font-size: 90%; font-weight: bold;}');
		d.writeln('textarea { width: 100%; height: 15em; font-size: 90%; }');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function insert_tag(){');
		d.writeln('var target = document.getElementById("tag_select");');
		d.writeln('var idx = target.selectedIndex;');
		d.writeln('var tarval = target.options[idx].value;');
		d.writeln('text_insert("ta_main", tarval);');
		d.writeln('}');
		d.writeln('function insert_attr(){');
		d.writeln('var target = document.getElementById("attr_select");');
		d.writeln('var idx = target.selectedIndex;');
		d.writeln('var tarval = target.options[idx].value;');
		d.writeln('tarval = " " + tarval + \'=""\';');
		d.writeln('text_insert("ta_main", tarval);');
		d.writeln('}');
		d.writeln('function insert_styleset(){');
		d.writeln('var target = document.getElementById("styleset_select");');
		d.writeln('var idx = target.selectedIndex;');
		d.writeln('var tarval = target.options[idx].value;');
		d.writeln('tarval = tarval + " ;";');
		d.writeln('text_insert("ta_main", tarval);');
		d.writeln('}');
		d.writeln('function insert_snippet(){');
		d.writeln('var target = document.getElementById("snippet_select");');
		d.writeln('var idx = target.selectedIndex;');
		d.writeln('var tarval = target.options[idx].text;');
		d.writeln('text_insert("ta_main", tarval);');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function tag_clean(target){');
		d.writeln('var str = "";');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('var pat = new RegExp(/(<.*?>)(.+?)(<.*?>)/);');
		d.writeln('var arr = src.match(pat);');
		d.writeln('if(arr!==null){');
		d.writeln('str = arr[2].toString();');
		d.writeln('}');
		d.writeln('document.getElementById(target).value = str;');
		d.writeln('}');
		d.writeln('function delete_this_text(target){');
		d.writeln('document.getElementById(target).value = "";');
		d.writeln('}');
		d.writeln('function clean(str){');
		d.writeln('str=str.replace(/^ +/m,"");');
		d.writeln('str=str.replace(/\\t+/m,"");');
		d.writeln('str=str.replace(/(\\r\\n|\\r|\\n)/g,""); ');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function send_text(){');
		d.writeln('var src = document.getElementById("ta_main").value;');
		d.writeln('window.opener.document.getElementById("srccode").value = src;');
		d.writeln('}');
		d.writeln('function send_description(){');
		d.writeln('var src = document.getElementById("ta_main").value;');
		d.writeln('window.opener.document.getElementById("description").value = src;');
		d.writeln('}');
		d.writeln('function send_comment(){');
		d.writeln('var src = document.getElementById("comment_select");');
		d.writeln('var idx = src.selectedIndex;');
		d.writeln('var str = src.options[idx].text;');
		d.writeln('window.opener.document.getElementById("comments").value = str;');
		d.writeln('}');
		d.writeln('function load_srccode(){');
		d.writeln('var src = window.opener.document.getElementById("srccode").value;');
		d.writeln('document.getElementById("ta_main").value = src;');
		d.writeln('}');
		d.writeln('function copy_bottom(){');
		d.writeln('var src = document.getElementById("ta_main").value;');
		d.writeln('text_insert("ta_sub", src);');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>SourceHTML-Editor <small>(V2)</small></h1>');
		d.writeln('<label for="ta_main">Main Text: </label>');
		d.writeln('<button onclick="load_srccode()">Load</button>');
		d.writeln('<button onclick="tag_clean(\'ta_main\')">TagClean</button>');
		d.writeln('<button onclick="br_insert(\'ta_main\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_main\')">Del</button>');
		d.writeln('<button onclick="send_text()">Send</button>');
		d.writeln('<button onclick="send_description()">SendDesc</button>');
		d.writeln('<label>Tag: </label>');
		d.writeln('<select id="tag_select"></select>');
		d.writeln('<button onclick="insert_tag()">Insert</button>');
		d.writeln('<label>Attribute: </label>');
		d.writeln('<select id="attr_select"></select>');
		d.writeln('<button onclick="insert_attr()">Insert</button>');
		d.writeln('<label>StyleSet: </label>');
		d.writeln('<select id="styleset_select"></select>');
		d.writeln('<button onclick="insert_styleset()">Insert</button>');
		d.writeln('<br>');
		d.writeln('<label>Snippet: </label>');
		d.writeln('<select id="snippet_select"></select>');
		d.writeln('<button onclick="insert_snippet()">Insert</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_main"></textarea><br>');
		d.writeln('<label for="ta_sub">Sub Text: </label>');
		d.writeln('<button onclick="copy_bottom()">CpBottom</button>');
		d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Del</button>');
		d.writeln('<label>Comments: </label>');
		d.writeln('<select id="comment_select"></select>');
		d.writeln('<button onclick="send_comment()">Send</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_sub"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
		var select1 = d.getElementById("tag_select");
		for(var key in tags){
		var opt = d.createElement("option");
			opt.setAttribute("value", tags[key]);
			opt.textContent = key;
			select1.appendChild(opt);
		}
		var select2 = d.getElementById("attr_select");
		for(var key in attrs){
			var opt = d.createElement("option");
			opt.setAttribute("value", attrs[key]);
			opt.textContent = key;
			select2.appendChild(opt);
		}
		var select3 = d.getElementById("styleset_select");
		for(var key in stylesets){
			var opt = d.createElement("option");
			opt.setAttribute("value", stylesets[key]);
			opt.textContent = key;
			select3.appendChild(opt);
		}
		var select4 = d.getElementById("snippet_select");
		for(var i=0; i<snippets.length; i++){
			var opt = d.createElement("option");
			opt.setAttribute("value",i);
			opt.textContent = snippets[i].toString();
			select4.appendChild(opt);
		}
		var select5 = d.getElementById("comment_select");
		for(var i=0; i<comms.length; i++){
			var opt = d.createElement("option");
			opt.setAttribute("value",i);
			opt.textContent = comms[i].toString();
			select5.appendChild(opt);
		}
		d.getElementById("ta_main").value = srccode;
	}
})();

javascript:(function(){var tags = {strong: "<strong></strong>",em: "<em></em>",span: "<span></span>",label: "<label></label>",caption: "<caption></caption>",p: "<p></p>",div: "<div></div>",th: "<th></th>"};var stylesets = {font_size: "font-size:",color: "color:",background: "background:",font_family: "font-family:",text_align: "text-align:",text_decoration: "text-decoration:",position: "position:",left: "left:",margin: "margin:"};var attrs = {style: "style",title: "title",_for: "for",id: "id",summary: "summary",scope: "scope"};var comms = ["強調を意図している、セマンティックなマークアップが必要","周囲の色と異なる文字で強調をしている箇所がセマンティックな要素でマークアップされていない","非推奨タグが使用されている","取り消し線はdel要素でマークアップする。","title属性が無い","label要素は存在するがinput要素と関連付けられていない","th要素が使用されていない"];var snippets = [" を入力"," を選択"];var srccode = document.getElementById("srccode").value;trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>SourceHTML-Editor</title>	');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif; }');d.writeln('label {font-size: 90%; font-weight: bold;}');d.writeln('textarea { width: 100%; height: 15em; font-size: 90%; }');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function insert_tag(){');d.writeln('var target = document.getElementById("tag_select");');d.writeln('var idx = target.selectedIndex;');d.writeln('var tarval = target.options[idx].value;');d.writeln('text_insert("ta_main", tarval);');d.writeln('}');d.writeln('function insert_attr(){');d.writeln('var target = document.getElementById("attr_select");');d.writeln('var idx = target.selectedIndex;');d.writeln('var tarval = target.options[idx].value;');d.writeln('tarval = " " + tarval + \'=""\';');d.writeln('text_insert("ta_main", tarval);');d.writeln('}');d.writeln('function insert_styleset(){');d.writeln('var target = document.getElementById("styleset_select");');d.writeln('var idx = target.selectedIndex;');d.writeln('var tarval = target.options[idx].value;');d.writeln('tarval = tarval + " ;";');d.writeln('text_insert("ta_main", tarval);');d.writeln('}');d.writeln('function insert_snippet(){');d.writeln('var target = document.getElementById("snippet_select");');d.writeln('var idx = target.selectedIndex;');d.writeln('var tarval = target.options[idx].text;');d.writeln('text_insert("ta_main", tarval);');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function tag_clean(target){');d.writeln('var str = "";');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('var pat = new RegExp(/(<.*?>)(.+?)(<.*?>)/);');d.writeln('var arr = src.match(pat);');d.writeln('if(arr!==null){');d.writeln('str = arr[2].toString();');d.writeln('}');d.writeln('document.getElementById(target).value = str;');d.writeln('}');d.writeln('function delete_this_text(target){');d.writeln('document.getElementById(target).value = "";');d.writeln('}');d.writeln('function clean(str){');d.writeln('str=str.replace(/^ +/m,"");');d.writeln('str=str.replace(/\\t+/m,"");');d.writeln('str=str.replace(/(\\r\\n|\\r|\\n)/g,""); ');d.writeln('return str;');d.writeln('}');d.writeln('function send_text(){');d.writeln('var src = document.getElementById("ta_main").value;');d.writeln('window.opener.document.getElementById("srccode").value = src;');d.writeln('}');d.writeln('function send_description(){');d.writeln('var src = document.getElementById("ta_main").value;');d.writeln('window.opener.document.getElementById("description").value = src;');d.writeln('}');d.writeln('function send_comment(){');d.writeln('var src = document.getElementById("comment_select");');d.writeln('var idx = src.selectedIndex;');d.writeln('var str = src.options[idx].text;');d.writeln('window.opener.document.getElementById("comments").value = str;');d.writeln('}');d.writeln('function load_srccode(){');d.writeln('var src = window.opener.document.getElementById("srccode").value;');d.writeln('document.getElementById("ta_main").value = src;');d.writeln('}');d.writeln('function copy_bottom(){');d.writeln('var src = document.getElementById("ta_main").value;');d.writeln('text_insert("ta_sub", src);');d.writeln('}');d.writeln('</script>');d.writeln('<h1>SourceHTML-Editor <small>(V2)</small></h1>');d.writeln('<label for="ta_main">Main Text: </label>');d.writeln('<button onclick="load_srccode()">Load</button>');d.writeln('<button onclick="tag_clean(\'ta_main\')">TagClean</button>');d.writeln('<button onclick="br_insert(\'ta_main\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_main\')">Del</button>');d.writeln('<button onclick="send_text()">Send</button>');d.writeln('<button onclick="send_description()">SendDesc</button>');d.writeln('<label>Tag: </label>');d.writeln('<select id="tag_select"></select>');d.writeln('<button onclick="insert_tag()">Insert</button>');d.writeln('<label>Attribute: </label>');d.writeln('<select id="attr_select"></select>');d.writeln('<button onclick="insert_attr()">Insert</button>');d.writeln('<label>StyleSet: </label>');d.writeln('<select id="styleset_select"></select>');d.writeln('<button onclick="insert_styleset()">Insert</button>');d.writeln('<br>');d.writeln('<label>Snippet: </label>');d.writeln('<select id="snippet_select"></select>');d.writeln('<button onclick="insert_snippet()">Insert</button>');d.writeln('<br>');d.writeln('<textarea id="ta_main"></textarea><br>');d.writeln('<label for="ta_sub">Sub Text: </label>');d.writeln('<button onclick="copy_bottom()">CpBottom</button>');d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Del</button>');d.writeln('<label>Comments: </label>');d.writeln('<select id="comment_select"></select>');d.writeln('<button onclick="send_comment()">Send</button>');d.writeln('<br>');d.writeln('<textarea id="ta_sub"></textarea>');d.writeln('</body>');d.writeln('</html>');var select1 = d.getElementById("tag_select");for(var key in tags){var opt = d.createElement("option");opt.setAttribute("value", tags[key]);opt.textContent = key;select1.appendChild(opt);}var select2 = d.getElementById("attr_select");for(var key in attrs){var opt = d.createElement("option");opt.setAttribute("value", attrs[key]);opt.textContent = key;select2.appendChild(opt);}var select3 = d.getElementById("styleset_select");for(var key in stylesets){var opt = d.createElement("option");opt.setAttribute("value", stylesets[key]);opt.textContent = key;select3.appendChild(opt);}var select4 = d.getElementById("snippet_select");for(var i=0; i<snippets.length; i++){var opt = d.createElement("option");opt.setAttribute("value",i);opt.textContent = snippets[i].toString();select4.appendChild(opt);}var select5 = d.getElementById("comment_select");for(var i=0; i<comms.length; i++){var opt = d.createElement("option");opt.setAttribute("value",i);opt.textContent = comms[i].toString();select5.appendChild(opt);}d.getElementById("ta_main").value = srccode;}})();

//選択aタグのリンク先を別タブで
javascript:(function(){
	var%20urlval="";
	var%20url="";
	var%20imgtag="";
	var%20imgsrc="";
	var%20element=document.getElementById("urlList");
	for(var%20i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;
			break;
		}
	}
	var%20a1=urlval.match(/http.*\/\/.*?\//);
	url=a1[0].toString();
	imgtag=window.getSelection().toString();
	var%20a2=imgtag.match(/href=\"*(.*?)\"/);
	imgsrc=a2[1].toString();
	if(imgsrc.match(/http.*/)){
		var%20a3=imgsrc.match(/http.*/);
		window.open(a3[0].toString(),"_blank");
	}else{
		window.open(url+imgsrc,"_blank");
	}
})();

javascript:(function(){var%20urlval="";var%20url="";var%20imgtag="";var%20imgsrc="";var%20element=document.getElementById("urlList");for(var%20i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var%20a1=urlval.match(/http.*\/\/.*?\//);url=a1[0].toString();imgtag=window.getSelection().toString();var%20a2=imgtag.match(/href=\"*(.*?)\"/);imgsrc=a2[1].toString();if(imgsrc.match(/http.*/)){var%20a3=imgsrc.match(/http.*/);window.open(a3[0].toString(),"_blank");}else{window.open(url+imgsrc,"_blank");}})();

//不適合箇所の一覧を別タブで
javascript:(function(){
	var tbls = document.getElementById("myTable");
	var trs = tbls.rows;
	var arr = new Array();
	for(var i=0;i<trs.length;i++){
	  var tds = trs.item(i).cells;
	  if(i==0){continue;}
	  var iarr = new Array();
	  for(var j=0;j<tds.length;j++){
	    var td = tds.item(j);
	    if(j==1){continue;}
	    if(trs.item(i).cells.item(2).firstChild.nodeValue=="不適合"){
	      iarr[j] = new Array();
	      if(td.firstChild!=null){
	        if(td.firstChild.nodeValue!=null){
	          var tdval = td.firstChild.nodeValue;
	      	  iarr[j] = tdval;
	        }
	      }else{
	        iarr[j] = " ";
	      }
	      if(j==tds.length-1){
	        var jx = arr.length;
	        arr[jx] = new Array();
	        arr[jx].push(iarr[2],iarr[3],iarr[4],iarr[5],iarr[6]);
	      }
	    }

	  }
	}

	trgr();
	function trgr(){
		d = window.open().document;
		d.write('<!DOCTYPE html>');
		d.write('<head>');
		d.write('<title>不適合箇所一覧</title>');
		d.write('<style>textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}</style>');
		d.write('</head><body></body></html>');
		b = d.getElementsByTagName("body").item(0);
		var str = "";
		var obj = d.createElement("textarea");
		for(var i=0; i<arr.length; i++){
			var row = arr[i];
			str += "("+ (i + 1).toString() + ")";
			for(var j=0; j<arr[i].length;j++){
				str += arr[i][j] + "\n";
		  		if(j==arr[i].length-1){
		    	str += "\n";
		  		}
			}
		}
		obj.textContent = str;
		b.appendChild(obj);
	}
})();

javascript:(function(){var tbls = document.getElementById("myTable");var trs = tbls.rows;var arr = new Array();for(var i=0;i<trs.length;i++){var tds = trs.item(i).cells;if(i==0){continue;}var iarr = new Array();for(var j=0;j<tds.length;j++){var td = tds.item(j);if(j==1){continue;}if(trs.item(i).cells.item(2).firstChild.nodeValue=="不適合"){iarr[j] = new Array();if(td.firstChild!=null){if(td.firstChild.nodeValue!=null){var tdval = td.firstChild.nodeValue;iarr[j] = tdval;}}else{iarr[j] = " ";}if(j==tds.length-1){var jx = arr.length;arr[jx] = new Array();arr[jx].push(iarr[2],iarr[3],iarr[4],iarr[5],iarr[6]);}}}}trgr();function trgr(){d = window.open().document;d.write('<!DOCTYPE html>');d.write('<head>');d.write('<title>不適合箇所一覧</title>');d.write('<style>textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}</style>');d.write('</head><body></body></html>');b = d.getElementsByTagName("body").item(0);var str = "";var obj = d.createElement("textarea");for(var i=0; i<arr.length; i++){var row = arr[i];str += "("+ (i + 1).toString() + ")";for(var j=0; j<arr[i].length;j++){str += arr[i][j] + "\n";if(j==arr[i].length-1){str += "\n";}}}obj.textContent = str;b.appendChild(obj);}})();

//H30自動判定
javascript:(function(){
	document.getElementById("comments").value="代替テキストが十分でなく、リンク目的が伝わらない";
	var imgtag=document.getElementById("srccode").value;
	var pat=new RegExp(/<img.*?>/);
	var rdm=prompt("修正後のimgタグを貼り付けてください");
	var rdmtag=imgtag.replace(pat,rdm);
	document.getElementById("srccode").value=rdmtag;
})();

javascript:(function(){document.getElementById("comments").value="代替テキストが十分でなく、リンク目的が伝わらない";var imgtag=document.getElementById("srccode").value;var pat=new RegExp(/<img.*?>/);var rdm=prompt("修正後のimgタグを貼り付けてください");var rdmtag=imgtag.replace(pat,rdm);document.getElementById("srccode").value=rdmtag;})();

//一発CSSカット
javascript:(function(){
	var link = document.getElementsByTagName("link");
	var style = document.getElementsByTagName("style");
	var span = document.getElementsByTagName("span");
	var pr = document.getElementsByTagName("p");
	var head = document.getElementsByTagName("head").item(0);
	var bd = document.getElementsByTagName("body").item(0);
	var str = "";
	for(var i=0; i<link.length; i++){
	  var row = link.item(i);
	  try{row.setAttribute("href", "");}finally{}
	}
	for(var i=0; i<style.length; i++){
	  var row = style.item(i);
	  try{head.removeChild(row);}finally{}
	  try{bd.removeChild(row);}finally{}
	}
	for(var i=0; i<span.length; i++){
		var row = span.item(i);
		try{row.setAttribute("style","");}finally{}
	}
	for(var i=0; i<pr.length; i++){
		var row = pr.item(i);
		try{row.setAttribute("style","");}finally{}
	}
})();

javascript:(function(){var link = document.getElementsByTagName("link");var style = document.getElementsByTagName("style");var span = document.getElementsByTagName("span");var pr = document.getElementsByTagName("p");var head = document.getElementsByTagName("head").item(0);var bd = document.getElementsByTagName("body").item(0);var str = "";for(var i=0; i<link.length; i++){var row = link.item(i);try{row.setAttribute("href", "");}finally{}}for(var i=0; i<style.length; i++){var row = style.item(i);try{head.removeChild(row);}finally{}try{bd.removeChild(row);}finally{}}for(var i=0; i<span.length; i++){var row = span.item(i);try{row.setAttribute("style","");}finally{}}for(var i=0; i<pr.length; i++){var row = pr.item(i);try{row.setAttribute("style","");}finally{}}})();


//V2
javascript:(function(){
	var head = document.getElementsByTagName("head").item(0);
	var bd = document.getElementsByTagName("body").item(0);
	var link = document.getElementsByTagName("link");
	var style = document.getElementsByTagName("style");
	var scp = document.getElementsByTagName("script");
	for(var i=0; i<link.length; i++){
	  var row = link.item(i);
	  row.setAttribute("href","");
	}
	for(var i=0; i<style.length; i++){
	  var row = style.item(i);
	  row.innerHTML="";
	}
	for(var i=0; i<scp.length; i++){
	  var row = scp.item(i);
	  row.setAttribute("src","");
	}
	element_style_clear("div");
	element_style_clear("p");
	element_style_clear("span");
	element_style_clear("img");
	element_style_clear("label");
	function element_style_clear(obj){
		var bd = document.getElementsByTagName("body").item(0);
		var tobj = document.getElementsByTagName(obj);
		if(tobj !== null){
			for(var i=0; i<tobj.length; i++){
				var row = tobj.item(i);
				row.removeAttribute("style");
			}
		}
	}
})();

javascript:(function(){var head = document.getElementsByTagName("head").item(0);var bd = document.getElementsByTagName("body").item(0);var link = document.getElementsByTagName("link");var style = document.getElementsByTagName("style");var scp = document.getElementsByTagName("script");for(var i=0; i<link.length; i++){var row = link.item(i);row.setAttribute("href","");}for(var i=0; i<style.length; i++){var row = style.item(i);row.innerHTML="";}for(var i=0; i<scp.length; i++){var row = scp.item(i);row.setAttribute("src","");}element_style_clear("div");element_style_clear("p");element_style_clear("span");element_style_clear("img");element_style_clear("label");function element_style_clear(obj){var bd = document.getElementsByTagName("body").item(0);var tobj = document.getElementsByTagName(obj);if(tobj !== null){for(var i=0; i<tobj.length; i++){var row = tobj.item(i);row.removeAttribute("style");}}}})();

//G148ユーザスタイルシート
javascript:(function(){
	var hd = document.getElementsByTagName("head").item(0);
	var us = document.createElement("style");
	us.setAttribute("type","text/css");
	us.textContent = "*{color:#ffffff!important;background:#000000!important;}";
	hd.appendChild(us);
})();

javascript:(function(){var hd = document.getElementsByTagName("head").item(0);var us = document.createElement("style");us.setAttribute("type","text/css");us.textContent = "*{color:#ffffff!important;background:#000000!important;}";hd.appendChild(us);})();

//G179フォントサイズ
javascript:(function(){
	var hd = document.getElementsByTagName("head").item(0);
	var us = document.createElement("style");
	us.setAttribute("type","text/css");
	us.textContent = "*{font-size:32px!important;}";
	hd.appendChild(us);
})();

javascript:(function(){var hd = document.getElementsByTagName("head").item(0);var us = document.createElement("style");us.setAttribute("type","text/css");us.textContent = "*{font-size:32px!important;}";hd.appendChild(us);})();

//タグリファレンス
javascript:(function(){
	var base_url = "http://www.tohoho-web.com/html/";
	var tag = prompt("Enter a tag name without　<>");
	var pat = new RegExp(/[a-zA-Z]+/);
	if(tag !== ""){
		if(tag.match(pat)!==null){
			window.open(base_url+tag+".htm", "_blank");
		}else{
			alert("入力されたタグ文字列に誤りがあります！");
		}
	}
})();

javascript:(function(){var base_url = "http://www.tohoho-web.com/html/";var tag = prompt("Enter a tag name without　<>");var pat = new RegExp(/[a-zA-Z]+/);if(tag !== ""){if(tag.match(pat)!==null){window.open(base_url+tag+".htm", "_blank");}else{alert("入力されたタグ文字列に誤りがあります！");}}})();


//リンク検査
javascript:(function(){
	var atags = document.getElementsByTagName("a");
	var str = "";
	for(var i=0; i<atags.length; i++){
	  var atag = atags.item(i);
	  var cnt = atag.childElementCount;
	  if(cnt > 0){
	    if(atag.lastChild.alt==undefined){
	       if(atag.firstChild!=null){
	         str += "[テキストリンク]  "+atag.firstChild.innerHTML;
	       }else{
	         str += "[画像リンク]  "+atag.firstChild.nextSibling.alt;
	       }
	    }else{
	      str += "[画像リンク]  "+atag.lastChild.alt;
	    }
	  }else{
	    if(atag.firstChild==null){
	       str += "[空リンク]  ";
	    }
	    if(atag.firstChild!=null){
	      str += "[テキストリンク]  "+atag.firstChild.nodeValue;
	    }
	  }
	  var ataghref = atag.href;
	  if(ataghref == ""){
		  str += "  "+"(非リンク)"+"\n";
	  }else{
	    str += "  "+"("+ataghref+")"+"\n";
	  }
	}
	trgr();
	function trgr(){
	  d = window.open().document;
	  d.write('<!DOCTYPE html><head>');
	  d.write('<title>リンク一覧</title>');
	  d.write('<style>textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}</style>');
	  d.write('</head><body>');
	  d.write('<p><strong>リンク一覧</strong></p>');
	  d.write('<textarea id="code">'+str+'</textarea>');
	  d.write('</body></html>');
	}
})();

javascript:(function(){var atags = document.getElementsByTagName("a");var str = "";for(var i=0; i<atags.length; i++){var atag = atags.item(i);var cnt = atag.childElementCount;if(cnt > 0){if(atag.lastChild.alt==undefined){if(atag.firstChild!=null){str += "[テキストリンク]  "+atag.firstChild.innerHTML;}else{str += "[画像リンク]  "+atag.firstChild.nextSibling.alt;}}else{str += "[画像リンク]  "+atag.lastChild.alt;}}else{if(atag.firstChild==null){str += "[空リンク]  ";}if(atag.firstChild!=null){str += "[テキストリンク]  "+atag.firstChild.nodeValue;}}var ataghref = atag.href;if(ataghref == ""){str += "  "+"(非リンク)"+"\n";}else{str += "  "+"("+ataghref+")"+"\n";}}trgr();function trgr(){d = window.open().document;d.write('<!DOCTYPE html><head>');d.write('<title>リンク一覧</title>');d.write('<style>textarea{font-size:80%;font-family:"メイリオ",Meiryo;width:100%;height:20em;}</style>');d.write('</head><body>');d.write('<p><strong>リンク一覧</strong></p>');d.write('<textarea id="code">'+str+'</textarea>');d.write('</body></html>');}})();

//リンクレポート
javascript:(function(){
	var atags = document.getElementsByTagName("a");
	var str = "";
	var link_data = new Array();
	for(var i=0; i<atags.length; i++){
	  var atag = atags.item(i);
	  var childlist = atag.childNodes;
	  var cnt = childlist.length;
	  var n = link_data.length;
	  link_data[n] = new Array();

	  if(cnt > 0){
	    var childs = new Array();
	    for(var ax=0; ax<cnt; ax++){
	      var axdata = atag.childNodes[ax];
	      if(axdata.tagName=="IMG"){
	        childs.push('[画像リンク]  <span class="pickup">'+axdata.alt+'</span>');
	      }else if(axdata.tagName=="SPAN"){
        	childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
	      }else if(axdata.tagName=="P"){
	        childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
	      }else if(axdata.tagName=="DIV"){
	        childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
	      }else if(axdata.tagName=="STRONG"){
	    	childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
	      }else if(axdata.tagName=="BR"){
	        childs.push(' ');
	      }else{
	        childs.push('[テキストリンク]  <span class="pickup">'+axdata.nodeValue+'</span>');
	      }
	    }
	    var settext = "";
	    for(var cx=0; cx<childs.length; cx++){
	      settext += childs[cx].toString();
	    }
	    link_data[n].push(settext);

	  }else{
	    if(atag.firstChild==null){
	    	link_data[n].push('[空リンク]  ');
	       str += "[空リンク]  ";
	    }
	    if(atag.firstChild!=null){
	    	link_data[n].push('[テキストリンク]  <span class="pickup">'+atag.firstChild.nodeValue+'</span>');
	      str += "[テキストリンク]  "+atag.firstChild.nodeValue;
	    }
	  }
	  
	  var ataghref = atag.href;
	  if(ataghref == ""){
	  	link_data[n].push("  "+"(非リンク)");
		  str += "  "+"(非リンク)"+"\n";
	  }else{
	  	var atagtarget = atag.target;
	  	var atagdoc_label = "";
	  	var atagtext = "";
	  	var docpat = new RegExp(/(\.)(pdf|PDF|doc.*|DOC.*|xls.*|XLS.*)/);
		var docarr = ataghref.match(docpat);
		if(docarr!=null){
			var docext = docarr[2].toString();
			switch(docext){
				case "pdf":
				case "PDF":
				  atagdoc_label = '<span class="docpickup">[PDFリンク]</span>';
				  break;
				case "doc":
				case "DOC":
				case "docx":
				case "DOCX":
				  atagdoc_label = '<span class="docpickup">[WORDリンク]</span>';
				  break;
				case "xls":
				case "XLS":
				case "xlsx":
				case "XLSX":
				  atagdoc_label = '<span class="docpickup">[EXCELリンク]</span>';
				  break;
				default:
				  break;
			}
		}
	  	if(atagtarget == ""){
	  		link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);
	    	str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";
		}else if(atagtarget == "_blank"){
	  		link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>');
	    	str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>'+"\n";
		}else{
	  		link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);
	    	str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";			
		}
	  }
	}

	trgr();

	function trgr(){
	  var d = window.open().document;
	  d.write('<!DOCTYPE html><head>');
	  d.write('<title>リンクレポート</title>');
	  d.write('<style>');
	  d.write('h1 {font-family:"メイリオ",Meiryo;}');
	  d.write('.pickup { background:#ffeecc;font-weight:bold;}');
	  d.write('.caution {color:red;font-size:90%;font-weight:bold;background:yellow;}');
	  d.write('.docpickup {color:red;font-size:90%;font-weight:bold;background:#C0FFFF;}');
	  d.write('#linkrepo {font-family:"メイリオ",Meiryo;}');
	  d.write('#linkrepo dt {margin-bottom:8px; font-size:96%;}');
	  d.write('#linkrepo dd {font-size:80%;background:#FFFFC0;margin:0 0 8px 20px;}');
	  d.write('</style>');
	  d.write('</head><body>');
	  d.write('<h1>リンクレポート<h1>');
	  d.write('</body></html>');
	  var bd = d.getElementsByTagName("body").item(0);
	  var wrap = d.createElement("div");
	  wrap.setAttribute("id", "wrap");
	  bd.appendChild(wrap);
	  var wrapdoc = d.getElementById("wrap");
	  var dltag = d.createElement("dl");
	  dltag.setAttribute("id", "linkrepo");
	  wrapdoc.appendChild(dltag);
	  var dl = d.getElementsByTagName("dl").item(0);
	  for(var i=0;i<link_data.length; i++){
			var data1 = link_data[i][0].toString();
			var data2 = link_data[i][1].toString();
			var dt = d.createElement("dt");
			dt.innerHTML = "[" + (i + 1) + "] " + data1;
			dl.appendChild(dt);
			var dd = d.createElement("dd");
			dd.innerHTML = data2;
			dl.appendChild(dd);
	  }
	}
})();

javascript:(function(){var atags = document.getElementsByTagName("a");var str = "";var link_data = new Array();for(var i=0; i<atags.length; i++){var atag = atags.item(i);var childlist = atag.childNodes;var cnt = childlist.length;var n = link_data.length;link_data[n] = new Array();if(cnt > 0){var childs = new Array();for(var ax=0; ax<cnt; ax++){var axdata = atag.childNodes[ax];if(axdata.tagName=="IMG"){childs.push('[画像リンク]  <span class="pickup">'+axdata.alt+'</span>');}else if(axdata.tagName=="SPAN"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');}else if(axdata.tagName=="P"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');}else if(axdata.tagName=="DIV"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');}else if(axdata.tagName=="STRONG"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');}else if(axdata.tagName=="BR"){childs.push(' ');}else{childs.push('[テキストリンク]  <span class="pickup">'+axdata.nodeValue+'</span>');}}var settext = "";for(var cx=0; cx<childs.length; cx++){settext += childs[cx].toString();}link_data[n].push(settext);}else{if(atag.firstChild==null){link_data[n].push('[空リンク]  ');str += "[空リンク]  ";}if(atag.firstChild!=null){link_data[n].push('[テキストリンク]  <span class="pickup">'+atag.firstChild.nodeValue+'</span>');str += "[テキストリンク]  "+atag.firstChild.nodeValue;}}var ataghref = atag.href;if(ataghref == ""){link_data[n].push("  "+"(非リンク)");str += "  "+"(非リンク)"+"\n";}else{var atagtarget = atag.target;var atagdoc_label = "";var atagtext = "";var docpat = new RegExp(/(\.)(pdf|PDF|doc.*|DOC.*|xls.*|XLS.*)/);var docarr = ataghref.match(docpat);if(docarr!=null){var docext = docarr[2].toString();switch(docext){case "pdf":case "PDF":atagdoc_label = '<span class="docpickup">[PDFリンク]</span>';break;case "doc":case "DOC":case "docx":case "DOCX":atagdoc_label = '<span class="docpickup">[WORDリンク]</span>';break;case "xls":case "XLS":case "xlsx":case "XLSX":atagdoc_label = '<span class="docpickup">[EXCELリンク]</span>';break;default:break;}}if(atagtarget == ""){link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";}else if(atagtarget == "_blank"){link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>');str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>'+"\n";}else{link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";			}}}trgr();function trgr(){var d = window.open().document;d.write('<!DOCTYPE html><head>');d.write('<title>リンクレポート</title>');d.write('<style>');d.write('h1 {font-family:"メイリオ",Meiryo;}');d.write('.pickup { background:#ffeecc;font-weight:bold;}');d.write('.caution {color:red;font-size:90%;font-weight:bold;background:yellow;}');d.write('.docpickup {color:red;font-size:90%;font-weight:bold;background:#C0FFFF;}');d.write('#linkrepo {font-family:"メイリオ",Meiryo;}');d.write('#linkrepo dt {margin-bottom:8px; font-size:96%;}');d.write('#linkrepo dd {font-size:80%;background:#FFFFC0;margin:0 0 8px 20px;}');d.write('</style>');d.write('</head><body>');d.write('<h1>リンクレポート<h1>');d.write('</body></html>');var bd = d.getElementsByTagName("body").item(0);var wrap = d.createElement("div");wrap.setAttribute("id", "wrap");bd.appendChild(wrap);var wrapdoc = d.getElementById("wrap");var dltag = d.createElement("dl");dltag.setAttribute("id", "linkrepo");wrapdoc.appendChild(dltag);var dl = d.getElementsByTagName("dl").item(0);for(var i=0;i<link_data.length; i++){var data1 = link_data[i][0].toString();var data2 = link_data[i][1].toString();var dt = d.createElement("dt");dt.innerHTML = "[" + (i + 1) + "] " + data1;dl.appendChild(dt);var dd = d.createElement("dd");dd.innerHTML = data2;dl.appendChild(dd);}}})();


//V2
javascript:(function(){
	var atags = document.getElementsByTagName("a");
	var str = "";
	var link_data = new Array();
	var newwin_cnt = 0;
	var media_cnt = 0;
	var url_cnt = 0;
	var email_cnt = 0;
	for(var i=0; i<atags.length; i++){
	  var atag = atags.item(i);
	  var childlist = atag.childNodes;
	  var cnt = childlist.length;
	  var n = link_data.length;
	  link_data[n] = new Array();

	  if(cnt > 0){
	    var childs = new Array();
	    for(var ax=0; ax<cnt; ax++){
	      var axdata = atag.childNodes[ax];
	      if(axdata.tagName=="IMG"){
	        childs.push('[画像リンク]  <span class="pickup">'+axdata.alt+'</span>');
	      }else if(axdata.tagName=="SPAN"){
        	childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
        	if(is_url(axdata.innerHTML)) url_cnt += 1;
        	if(is_email(axdata.innerHTML)) email_cnt += 1;
	      }else if(axdata.tagName=="P"){
	        childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
        	if(is_url(axdata.innerHTML)) url_cnt += 1;
        	if(is_email(axdata.innerHTML)) email_cnt += 1;
	      }else if(axdata.tagName=="DIV"){
	        childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
        	if(is_url(axdata.innerHTML)) url_cnt += 1;
        	if(is_email(axdata.innerHTML)) email_cnt += 1;
	      }else if(axdata.tagName=="STRONG"){
	    	childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');
        	if(is_url(axdata.innerHTML)) url_cnt += 1;
        	if(is_email(axdata.innerHTML)) email_cnt += 1;
	      }else if(axdata.tagName=="BR"){
	        childs.push(' ');
	      }else{
	        childs.push('[テキストリンク]  <span class="pickup">'+axdata.nodeValue+'</span>');
	        if(axdata.nodeValue!==null){
	        	if(is_url(axdata.nodeValue)) url_cnt += 1;
	        	if(is_email(axdata.nodeValue)) email_cnt += 1;
        	}
	      }
	    }
	    var settext = "";
	    for(var cx=0; cx<childs.length; cx++){
	      settext += childs[cx].toString();
	    }
	    link_data[n].push(settext);

	  }else{
	    if(atag.firstChild==null){
	    	link_data[n].push('[空リンク]  ');
	       str += "[空リンク]  ";
	    }
	    if(atag.firstChild!=null){
	    	link_data[n].push('[テキストリンク]  <span class="pickup">'+atag.firstChild.nodeValue+'</span>');
	    	str += "[テキストリンク]  "+atag.firstChild.nodeValue;
	        if(atag.firstChild.nodeValue!==null){
	        	if(is_url(atag.firstChild.nodeValue)) url_cnt += 1;
	        	if(is_email(atag.firstChild.nodeValue)) email_cnt += 1;
        	}
	    }
	  }
	  
	  var ataghref = atag.href;
	  if(ataghref == ""){
	  	link_data[n].push("  "+"(非リンク)");
		  str += "  "+"(非リンク)"+"\n";
	  }else{
	  	var atagtarget = atag.target;
	  	var atagdoc_label = "";
	  	var atagtext = "";
	  	var docpat = new RegExp(/(\.)(pdf|PDF|doc.*|DOC.*|xls.*|XLS.*)/);
		var docarr = ataghref.match(docpat);
		if(docarr!=null){
			var docext = docarr[2].toString();
			switch(docext){
				case "pdf":
				case "PDF":
				  atagdoc_label = '<span class="docpickup">[PDFリンク]</span>';
				  break;
				case "doc":
				case "DOC":
				case "docx":
				case "DOCX":
				  atagdoc_label = '<span class="docpickup">[WORDリンク]</span>';
				  break;
				case "xls":
				case "XLS":
				case "xlsx":
				case "XLSX":
				  atagdoc_label = '<span class="docpickup">[EXCELリンク]</span>';
				  break;
				default:
				  break;
			}
			media_cnt += 1;
		}
	  	if(atagtarget == ""){
	  		link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);
	    	str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";
		}else if(atagtarget == "_blank"){
	  		link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>');
	    	str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>'+"\n";
	    	newwin_cnt += 1;
		}else{
	  		link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);
	    	str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";			
		}
	  }
	}

	trgr();

	function is_url(str){
		var pat = new RegExp(/http.*/);
		var arr = str.match(pat);
		if(arr!==null){
			return true;
		}else{
			return false;
		}
	}
	function is_email(str){
		var pat = new RegExp(/.+?@.*/);
		var arr = str.match(pat);
		if(arr!==null){
			return true;
		}else{
			return false;
		}
	}


	function trgr(){
	  var d = window.open().document;
	  d.write('<!DOCTYPE html><head>');
	  d.write('<title>リンクレポート</title>');
	  d.write('<style>');
	  d.write('h1 {font-family:"メイリオ",Meiryo;}');
	  d.write('#summary {font-family:"メイリオ",Meiryo; font-size:90%;}');
	  d.write('.pickup { background:#ffeecc;font-weight:bold;}');
	  d.write('.caution {color:red;font-size:90%;font-weight:bold;background:yellow;}');
	  d.write('.docpickup {color:red;font-size:90%;font-weight:bold;background:#C0FFFF;}');
	  d.write('#linkrepo {font-family:"メイリオ",Meiryo;}');
	  d.write('#linkrepo dt {margin-bottom:8px; font-size:96%;}');
	  d.write('#linkrepo dd {font-size:80%;background:#FFFFC0;margin:0 0 8px 20px;}');
	  d.write('</style>');
	  d.write('</head><body>');
	  d.write('<h1>リンクレポート</h1>');
	  d.write('<p id="summary"><strong>別ウィンドウリンク:  </strong>'+newwin_cnt);
	  d.write('&nbsp;&nbsp;&nbsp;&nbsp;<strong>ドキュメントリンク:  </strong>'+media_cnt);
	  d.write('&nbsp;&nbsp;&nbsp;&nbsp;<strong>URLリンク:  </strong>'+url_cnt);
	  d.write('&nbsp;&nbsp;&nbsp;&nbsp;<strong>MAILリンク:  </strong>'+email_cnt+'</p>');
	  d.write('</body></html>');
	  var bd = d.getElementsByTagName("body").item(0);
	  var wrap = d.createElement("div");
	  wrap.setAttribute("id", "wrap");
	  bd.appendChild(wrap);
	  var wrapdoc = d.getElementById("wrap");
	  var dltag = d.createElement("dl");
	  dltag.setAttribute("id", "linkrepo");
	  wrapdoc.appendChild(dltag);
	  var dl = d.getElementsByTagName("dl").item(0);
	  for(var i=0;i<link_data.length; i++){
			var data1 = link_data[i][0].toString();
			var data2 = link_data[i][1].toString();
			var dt = d.createElement("dt");
			dt.innerHTML = "[" + (i + 1) + "] " + data1;
			dl.appendChild(dt);
			var dd = d.createElement("dd");
			dd.innerHTML = data2;
			dl.appendChild(dd);
	  }
	}
})();

javascript:(function(){var atags = document.getElementsByTagName("a");var str = "";var link_data = new Array();var newwin_cnt = 0;var media_cnt = 0;var url_cnt = 0;var email_cnt = 0;for(var i=0; i<atags.length; i++){var atag = atags.item(i);var childlist = atag.childNodes;var cnt = childlist.length;var n = link_data.length;link_data[n] = new Array();if(cnt > 0){var childs = new Array();for(var ax=0; ax<cnt; ax++){var axdata = atag.childNodes[ax];if(axdata.tagName=="IMG"){childs.push('[画像リンク]  <span class="pickup">'+axdata.alt+'</span>');}else if(axdata.tagName=="SPAN"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');if(is_url(axdata.innerHTML)) url_cnt += 1;if(is_email(axdata.innerHTML)) email_cnt += 1;}else if(axdata.tagName=="P"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');if(is_url(axdata.innerHTML)) url_cnt += 1;if(is_email(axdata.innerHTML)) email_cnt += 1;}else if(axdata.tagName=="DIV"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');if(is_url(axdata.innerHTML)) url_cnt += 1;if(is_email(axdata.innerHTML)) email_cnt += 1;}else if(axdata.tagName=="STRONG"){childs.push('[テキストリンク]  <span class="pickup">'+axdata.innerHTML+'</span>');if(is_url(axdata.innerHTML)) url_cnt += 1;if(is_email(axdata.innerHTML)) email_cnt += 1;}else if(axdata.tagName=="BR"){childs.push(' ');}else{childs.push('[テキストリンク]  <span class="pickup">'+axdata.nodeValue+'</span>');if(axdata.nodeValue!==null){if(is_url(axdata.nodeValue)) url_cnt += 1;if(is_email(axdata.nodeValue)) email_cnt += 1;}}}var settext = "";for(var cx=0; cx<childs.length; cx++){settext += childs[cx].toString();}link_data[n].push(settext);}else{if(atag.firstChild==null){link_data[n].push('[空リンク]  ');str += "[空リンク]  ";}if(atag.firstChild!=null){link_data[n].push('[テキストリンク]  <span class="pickup">'+atag.firstChild.nodeValue+'</span>');str += "[テキストリンク]  "+atag.firstChild.nodeValue;if(atag.firstChild.nodeValue!==null){if(is_url(atag.firstChild.nodeValue)) url_cnt += 1;if(is_email(atag.firstChild.nodeValue)) email_cnt += 1;}}}var ataghref = atag.href;if(ataghref == ""){link_data[n].push("  "+"(非リンク)");str += "  "+"(非リンク)"+"\n";}else{var atagtarget = atag.target;var atagdoc_label = "";var atagtext = "";var docpat = new RegExp(/(\.)(pdf|PDF|doc.*|DOC.*|xls.*|XLS.*)/);var docarr = ataghref.match(docpat);if(docarr!=null){var docext = docarr[2].toString();switch(docext){case "pdf":case "PDF":atagdoc_label = '<span class="docpickup">[PDFリンク]</span>';break;case "doc":case "DOC":case "docx":case "DOCX":atagdoc_label = '<span class="docpickup">[WORDリンク]</span>';break;case "xls":case "XLS":case "xlsx":case "XLSX":atagdoc_label = '<span class="docpickup">[EXCELリンク]</span>';break;default:break;}media_cnt += 1;}if(atagtarget == ""){link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";}else if(atagtarget == "_blank"){link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>');str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+'<span class="caution">[別ウィンドウ]</span>'+"\n";newwin_cnt += 1;}else{link_data[n].push('  '+'(<a href="'+ataghref+'" target="_blank">'+ataghref+'</a>)'+atagdoc_label);str += '  '+'(<a href="'+ataghref+'">'+ataghref+'</a>)'+atagdoc_label+"\n";			}}}trgr();function is_url(str){var pat = new RegExp(/http.*/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function is_email(str){var pat = new RegExp(/.+?@.*/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function trgr(){var d = window.open().document;d.write('<!DOCTYPE html><head>');d.write('<title>リンクレポート</title>');d.write('<style>');d.write('h1 {font-family:"メイリオ",Meiryo;}');d.write('#summary {font-family:"メイリオ",Meiryo; font-size:90%;}');d.write('.pickup { background:#ffeecc;font-weight:bold;}');d.write('.caution {color:red;font-size:90%;font-weight:bold;background:yellow;}');d.write('.docpickup {color:red;font-size:90%;font-weight:bold;background:#C0FFFF;}');d.write('#linkrepo {font-family:"メイリオ",Meiryo;}');d.write('#linkrepo dt {margin-bottom:8px; font-size:96%;}');d.write('#linkrepo dd {font-size:80%;background:#FFFFC0;margin:0 0 8px 20px;}');d.write('</style>');d.write('</head><body>');d.write('<h1>リンクレポート</h1>');d.write('<p id="summary"><strong>別ウィンドウリンク:  </strong>'+newwin_cnt);d.write('&nbsp;&nbsp;&nbsp;&nbsp;<strong>ドキュメントリンク:  </strong>'+media_cnt);d.write('&nbsp;&nbsp;&nbsp;&nbsp;<strong>URLリンク:  </strong>'+url_cnt);d.write('&nbsp;&nbsp;&nbsp;&nbsp;<strong>MAILリンク:  </strong>'+email_cnt+'</p>');d.write('</body></html>');var bd = d.getElementsByTagName("body").item(0);var wrap = d.createElement("div");wrap.setAttribute("id", "wrap");bd.appendChild(wrap);var wrapdoc = d.getElementById("wrap");var dltag = d.createElement("dl");dltag.setAttribute("id", "linkrepo");wrapdoc.appendChild(dltag);var dl = d.getElementsByTagName("dl").item(0);for(var i=0;i<link_data.length; i++){var data1 = link_data[i][0].toString();var data2 = link_data[i][1].toString();var dt = d.createElement("dt");dt.innerHTML = "[" + (i + 1) + "] " + data1;dl.appendChild(dt);var dd = d.createElement("dd");dd.innerHTML = data2;dl.appendChild(dd);}}})();


//IFC1015 別ウィンドウ不適合
javascript:(function(){
	var msg = "別ウィンドウで開くことを説明していない";
	var rdmtag = "";
	var rdmattr = "";
	var form=document.forms["diag_form"];
	for(var i=0;i<form.elements.length;i++){
		var obj=form.elements[i].value;
		if(obj=="FAIL"){
			form.elements[i].click();
			break;
		}
	}
	var src = document.getElementById("srccode").value;
	var pat1 = new RegExp(/(<.*?>)(.*?)(<\/.*?>)/);
	var arr1 = src.match(pat1);
	if(arr1!=null){
		rdmtag = arr1[1].toString()+arr1[2].toString()+'(別ウィンドウ)'+arr1[3].toString();
	}
	var pat2 = new RegExp(/( alt=)(\"|\')(.*?)(\"|\')/);
	var arr2 = src.match(pat2);
	if(arr2!=null){
		rdmattr = arr2[1].toString()+arr2[2].toString()+arr2[3].toString()+'(別ウィンドウ)'+arr2[4].toString();
		rdmtag = src.replace(/( alt=)(\"|\')(.*?)(\"|\')/, rdmattr);
	}

	document.getElementById("comments").value=msg;
	document.getElementById("srccode").value=rdmtag;
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var msg = "別ウィンドウで開くことを説明していない";var rdmtag = "";var rdmattr = "";var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="FAIL"){form.elements[i].click();break;}}var src = document.getElementById("srccode").value;var pat1 = new RegExp(/(<.*?>)(.*?)(<\/.*?>)/);var arr1 = src.match(pat1);if(arr1!=null){rdmtag = arr1[1].toString()+arr1[2].toString()+'(別ウィンドウ)'+arr1[3].toString();}var pat2 = new RegExp(/( alt=)(\"|\')(.*?)(\"|\')/);var arr2 = src.match(pat2);if(arr2!=null){rdmattr = arr2[1].toString()+arr2[2].toString()+arr2[3].toString()+'(別ウィンドウ)'+arr2[4].toString();rdmtag = src.replace(/( alt=)(\"|\')(.*?)(\"|\')/, rdmattr);}document.getElementById("comments").value=msg;document.getElementById("srccode").value=rdmtag;for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();

//H78、H79自動不適合
javascript:(function(){
	var kywd = prompt("箇所を指定");
	var msg = kywd+"のリンクに不備がある（7244_IFC1015参照）";
	var rdmtag = "";
	var rdmattr = "";
	var form=document.forms["diag_form"];
	for(var i=0;i<form.elements.length;i++){
		var obj=form.elements[i].value;
		if(obj=="FAIL"){
			form.elements[i].click();
			break;
		}
	}
	document.getElementById("comments").value=msg;
	document.getElementById("srccode").value="";
	for(var%20i=0;i<form.elements.length;i++){
		var%20obj=form.elements[i].type;
		if(obj=="submit"){
			form.elements[i].click();
		}
	}
})();

javascript:(function(){var kywd = prompt("箇所を指定");var msg = kywd+"のリンクに不備がある（7244_IFC1015参照）";var rdmtag = "";var rdmattr = "";var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="FAIL"){form.elements[i].click();break;}}document.getElementById("comments").value=msg;document.getElementById("srccode").value="";for(var%20i=0;i<form.elements.length;i++){var%20obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}})();


//ソースコードの先頭の▼をクリック
javascript:(function(){
	var d=document.getElementById("source");
	var dch=d.childNodes;
	dch.item(1).click();
})();



//ブックマークレット生成機
javascript:(function(){
  trgr();
  function trgr(){
  	d = window.open().document;
	d.write('<!DOCTYPE html>');
	d.write('<html lang="ja">');
	d.write('<head>');
	d.write('<meta charset="utf-8">');
	d.write('<style type="text/css">');
	d.write('* {font-family:"メイリオ",Meiryo,sans-serif;}');
	d.write('input,textarea,label{font-size: 95%;}');
	d.write('button#bkm_create_btn {font-size:110%;}');
	d.write('dd {margin-left: 0;}');
	d.write('#bkm {border-collapse: collapse;width: 600px;}');
	d.write('#bkm th {background: #eee;border:3px solid #fff;padding: 5px;}');
	d.write('#bkm td {background: #FFFFE0;border:3px solid #fff;padding: 5px;}');
	d.write('#bkm_comments,#bkm_srccode {width: 430px;}');
	d.write('#bkm td.btnarea {text-align: center;background: #eee;}');
	d.write('#bkm td.codeare {background: #eee;}');
	d.write('#bkm_code {width: 600px; height: 10em;}');
	d.write('</style>');
	d.write('</head>');
	d.write('<body>');
	d.write('<script type="text/javascript">');
	d.write('function bkm_create(){');
	d.write('var bkm_body = "javascript:(function(){";');
	d.write('var bkm_results = document.getElementsByName("bkm_result");');
	d.write('var bkm_result_val = "";');
	d.write('for(var i=0; i<bkm_results.length; i++){');
	d.write('if(bkm_results[i].checked==true){');
	d.write('bkm_result_val = bkm_results[i].value;');
	d.write('break;');
	d.write('}');
	d.write('}');
	d.write('var bkm_comments_status = document.getElementsByName("bkm_comment_status");');
	d.write('var bkm_comment_status_val = "";');
	d.write('for(var i=0; i<bkm_comments_status.length; i++){');
	d.write('if(bkm_comments_status.item(i).checked==true){');
	d.write('bkm_comment_status_val = bkm_comments_status[i].value;');
	d.write('break;');
	d.write('}');
	d.write('}');
	d.write('var bkm_srccodes_status = document.getElementsByName("bkm_srccode_status");');
	d.write('var bkm_srccode_status_val = "";');
	d.write('for(var i=0; i<bkm_srccodes_status.length; i++){');
	d.write('if(bkm_srccodes_status[i].checked==true){');
	d.write('bkm_srccode_status_val = bkm_srccodes_status[i].value;');
	d.write('break;');
	d.write('}');
	d.write('}');
	d.write('var bkm_autosaves = document.getElementsByName("bkm_autosave");');
	d.write('var bkm_autosave_val = "";');
	d.write('for(var i=0; i<bkm_autosaves.length; i++){');
	d.write('if(bkm_autosaves[i].checked==true){');
	d.write('bkm_autosave_val = bkm_autosaves[i].value;');
	d.write('break;');
	d.write('}');
	d.write('}');
	d.write('switch(bkm_result_val){');
	d.write('case "0":');
	d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="PASS"){form.elements[i].click();break;}}\';');
	d.write('break;');
	d.write('case "1":');
	d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="PASS2"){form.elements[i].click();break;}}\';');
	d.write('break;');
	d.write('case "2":');
	d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="FAIL"){form.elements[i].click();break;}}\';');
	d.write('break;');
	d.write('case "3":');
	d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="FAIL2"){form.elements[i].click();break;}}\';');
	d.write('break;');
	d.write('default:');
	d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="NA"){form.elements[i].click();break;}}\';');
	d.write('break;');
	d.write('}');
	d.write('if(bkm_comment_status_val=="0"){');
	d.write('var val1 = document.getElementById("bkm_comments").value;');
	d.write('bkm_body += \'document.getElementById("comments").value="\';');
	d.write('bkm_body += val1 + \'";\';');
	d.write('}');
	d.write('if(bkm_srccode_status_val=="0"){');
	d.write('var val2 = document.getElementById("bkm_srccode").value;');
	d.write('bkm_body += \'document.getElementById("srccode").value="\';');
	d.write('bkm_body += val2 + \'";\';');
	d.write('}');
	d.write('if(bkm_autosave_val=="0"){');
	d.write('bkm_body += \'for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}\';');
	d.write('}');
	d.write('bkm_body += \'})();\';');
	d.write('document.getElementById("bkm_code").value = bkm_body;');
	d.write('}');
	d.write('function clear_this_text(obj){');
	d.write('document.getElementById(obj).value = "";');
	d.write('}');
	d.write('</script>');
	d.write('<h1>Bookmarkletter</h1>');
	d.write('<table id="bkm">');
	d.write('<tr>');
	d.write('<th><label for="bkm_result">判定結果</label></th>');
	d.write('<td>');
	d.write('<label><input type="radio" name="bkm_result" value="0">適合</label>');
	d.write('<label><input type="radio" name="bkm_result" value="1">適合(注記)</label>');
	d.write('<label><input type="radio" name="bkm_result" value="2">不適合</label>');
	d.write('<label><input type="radio" name="bkm_result" value="3">不適合(要判定)</label>');
	d.write('<label><input type="radio" name="bkm_result" value="4">非適用 </label>');
	d.write('</td>');
	d.write('</tr>');
	d.write('<tr>');
	d.write('<th><label for="bkm_comments">判定コメント</label></th>');
	d.write('<td>');
	d.write('<dl>');
	d.write('<dt>');
	d.write('<label><input type="radio" name="bkm_comment_status" value="0">はい</label>');
	d.write('<label><input type="radio" name="bkm_comment_status" value="1">いいえ</label>');
	d.write('</dt>');
	d.write('<dd><textarea id="bkm_comments"></textarea><br>');
	d.write('<button onclick="clear_this_text(\'bkm_comments\')">Clear</button>');
	d.write('</dd>');
	d.write('</dl>');
	d.write('</td>');
	d.write('</tr>');
	d.write('<tr>');
	d.write('<th><label for="bkm_srccode">修正ソースコード</label></th>');
	d.write('<td>');
	d.write('<dl>');
	d.write('<dt>');
	d.write('<label><input type="radio" name="bkm_srccode_status" value="0">はい</label>');
	d.write('<label><input type="radio" name="bkm_srccode_status" value="1">いいえ</label>');
	d.write('</dt>');
	d.write('<dd><textarea id="bkm_srccode"></textarea><br>');
	d.write('<button onclick="clear_this_text(\'bkm_srccode\')">Clear</button>');
	d.write('</dd>');
	d.write('</dl>');
	d.write('</td>');
	d.write('</tr>');
	d.write('<tr>');
	d.write('<th>自動登録</th>');
	d.write('<td>');
	d.write('<label><input type="radio" name="bkm_autosave" value="0">はい</label>');
	d.write('<label><input type="radio" name="bkm_autosave" value="1">いいえ</label>');
	d.write('</td>');
	d.write('</tr>');
	d.write('<tr>');
	d.write('<td colspan="2" class="btnarea">');
	d.write('<button id="bkm_create_btn" onclick="bkm_create()">Create</button>');
	d.write('</td>');
	d.write('</tr>');
	d.write('<tr>');
	d.write('<td colspan="2" class="codearea"><textarea id="bkm_code"></textarea><br>');
	d.write('<button onclick="clear_this_text(\'bkm_code\')">Clear</button>');
	d.write('</td>');
	d.write('</tr>');
	d.write('</table>');
	d.write('</body>');
	d.write('</html>');
  }
})();


javascript:(function(){trgr();function trgr(){d = window.open().document;d.write('<!DOCTYPE html>');d.write('<html lang="ja">');d.write('<head>');d.write('<meta charset="utf-8">');d.write('<style type="text/css">');d.write('* {font-family:"メイリオ",Meiryo,sans-serif;}');d.write('input,textarea,label{font-size: 95%;}');d.write('button#bkm_create_btn {font-size:110%;}');d.write('dd {margin-left: 0;}');d.write('#bkm {border-collapse: collapse;width: 600px;}');d.write('#bkm th {background: #eee;border:3px solid #fff;padding: 5px;}');d.write('#bkm td {background: #FFFFE0;border:3px solid #fff;padding: 5px;}');d.write('#bkm_comments,#bkm_srccode {width: 430px;}');d.write('#bkm td.btnarea {text-align: center;background: #eee;}');d.write('#bkm td.codeare {background: #eee;}');d.write('#bkm_code {width: 600px; height: 10em;}');d.write('</style>');d.write('</head>');d.write('<body>');d.write('<script type="text/javascript">');d.write('function bkm_create(){');d.write('var bkm_body = "javascript:(function(){";');d.write('var bkm_results = document.getElementsByName("bkm_result");');d.write('var bkm_result_val = "";');d.write('for(var i=0; i<bkm_results.length; i++){');d.write('if(bkm_results[i].checked==true){');d.write('bkm_result_val = bkm_results[i].value;');d.write('break;');d.write('}');d.write('}');d.write('var bkm_comments_status = document.getElementsByName("bkm_comment_status");');d.write('var bkm_comment_status_val = "";');d.write('for(var i=0; i<bkm_comments_status.length; i++){');d.write('if(bkm_comments_status.item(i).checked==true){');d.write('bkm_comment_status_val = bkm_comments_status[i].value;');d.write('break;');d.write('}');d.write('}');d.write('var bkm_srccodes_status = document.getElementsByName("bkm_srccode_status");');d.write('var bkm_srccode_status_val = "";');d.write('for(var i=0; i<bkm_srccodes_status.length; i++){');d.write('if(bkm_srccodes_status[i].checked==true){');d.write('bkm_srccode_status_val = bkm_srccodes_status[i].value;');d.write('break;');d.write('}');d.write('}');d.write('var bkm_autosaves = document.getElementsByName("bkm_autosave");');d.write('var bkm_autosave_val = "";');d.write('for(var i=0; i<bkm_autosaves.length; i++){');d.write('if(bkm_autosaves[i].checked==true){');d.write('bkm_autosave_val = bkm_autosaves[i].value;');d.write('break;');d.write('}');d.write('}');d.write('switch(bkm_result_val){');d.write('case "0":');d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="PASS"){form.elements[i].click();break;}}\';');d.write('break;');d.write('case "1":');d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="PASS2"){form.elements[i].click();break;}}\';');d.write('break;');d.write('case "2":');d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="FAIL"){form.elements[i].click();break;}}\';');d.write('break;');d.write('case "3":');d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="FAIL2"){form.elements[i].click();break;}}\';');d.write('break;');d.write('default:');d.write('bkm_body += \'var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj=="NA"){form.elements[i].click();break;}}\';');d.write('break;');d.write('}');d.write('if(bkm_comment_status_val=="0"){');d.write('var val1 = document.getElementById("bkm_comments").value;');d.write('bkm_body += \'document.getElementById("comments").value="\';');d.write('bkm_body += val1 + \'";\';');d.write('}');d.write('if(bkm_srccode_status_val=="0"){');d.write('var val2 = document.getElementById("bkm_srccode").value;');d.write('bkm_body += \'document.getElementById("srccode").value="\';');d.write('bkm_body += val2 + \'";\';');d.write('}');d.write('if(bkm_autosave_val=="0"){');d.write('bkm_body += \'for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();}}\';');d.write('}');d.write('bkm_body += \'})();\';');d.write('document.getElementById("bkm_code").value = bkm_body;');d.write('}');d.write('function clear_this_text(obj){');d.write('document.getElementById(obj).value = "";');d.write('}');d.write('</script>');d.write('<h1>Bookmarkletter</h1>');d.write('<table id="bkm">');d.write('<tr>');d.write('<th><label for="bkm_result">判定結果</label></th>');d.write('<td>');d.write('<label><input type="radio" name="bkm_result" value="0">適合</label>');d.write('<label><input type="radio" name="bkm_result" value="1">適合(注記)</label>');d.write('<label><input type="radio" name="bkm_result" value="2">不適合</label>');d.write('<label><input type="radio" name="bkm_result" value="3">不適合(要判定)</label>');d.write('<label><input type="radio" name="bkm_result" value="4">非適用 </label>');d.write('</td>');d.write('</tr>');d.write('<tr>');d.write('<th><label for="bkm_comments">判定コメント</label></th>');d.write('<td>');d.write('<dl>');d.write('<dt>');d.write('<label><input type="radio" name="bkm_comment_status" value="0">はい</label>');d.write('<label><input type="radio" name="bkm_comment_status" value="1">いいえ</label>');d.write('</dt>');d.write('<dd><textarea id="bkm_comments"></textarea><br>');d.write('<button onclick="clear_this_text(\'bkm_comments\')">Clear</button>');d.write('</dd>');d.write('</dl>');d.write('</td>');d.write('</tr>');d.write('<tr>');d.write('<th><label for="bkm_srccode">修正ソースコード</label></th>');d.write('<td>');d.write('<dl>');d.write('<dt>');d.write('<label><input type="radio" name="bkm_srccode_status" value="0">はい</label>');d.write('<label><input type="radio" name="bkm_srccode_status" value="1">いいえ</label>');d.write('</dt>');d.write('<dd><textarea id="bkm_srccode"></textarea><br>');d.write('<button onclick="clear_this_text(\'bkm_srccode\')">Clear</button>');d.write('</dd>');d.write('</dl>');d.write('</td>');d.write('</tr>');d.write('<tr>');d.write('<th>自動登録</th>');d.write('<td>');d.write('<label><input type="radio" name="bkm_autosave" value="0">はい</label>');d.write('<label><input type="radio" name="bkm_autosave" value="1">いいえ</label>');d.write('</td>');d.write('</tr>');d.write('<tr>');d.write('<td colspan="2" class="btnarea">');d.write('<button id="bkm_create_btn" onclick="bkm_create()">Create</button>');d.write('</td>');d.write('</tr>');d.write('<tr>');d.write('<td colspan="2" class="codearea"><textarea id="bkm_code"></textarea><br>');d.write('<button onclick="clear_this_text(\'bkm_code\')">Clear</button>');d.write('</td>');d.write('</tr>');d.write('</table>');d.write('</body>');d.write('</html>');}})();


//指定JIS番号-実装番号の結果を別タブで
javascript:(function(){
	var projectid = get_projectid();
	var pageid = get_pageid();
	trgr(projectid, pageid);
	function trgr(projectid, pageid){
		d = window.open().document;
		d.write('<!DOCTYPE html>');
		d.write('<html lang="ja">');
		d.write('<head>');
		d.write('<meta charset="utf-8">');
		d.write('<title>判定結果参照</title>');
		d.write('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');
		d.write('<style type="text/css">');
		d.write('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.write('h1 {font-size: 170%;}');
		d.write('#desc,label {font-size: 90%;}');
		d.write('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');
		d.write('#all_text {width: 160px;}');
		d.write('#results {font-size:80%; width: 100%; height: 15em;}');
		d.write('</style>');
		d.write('</head>');
		d.write('<body>');
		d.write('<script type="text/javascript">');
		d.write('var guideline = "";');
		d.write('var technique = "";');
		d.write('function browseSurvey() {');
		d.write('var all_text = document.getElementById("all_text").value;');
		d.write('var projectid = document.getElementById("hdn_projectid").value;');
		d.write('var pageid = document.getElementById("hdn_pageid").value;');
		d.write('if(projectid!="" && pageid!="" && all_text!=""){');
		d.write('var sparr = my_spliter(all_text);');
		d.write('if(sparr!=null){');
		d.write('guideline = sparr[0].toString();');
		d.write('guideline = decode_guideline(guideline);');
		d.write('technique = sparr[2].toString();');
		d.write('technique = technique.toUpperCase();');
		d.write('var flg1 = chk_guideline(guideline);');
		d.write('var flg2 = chk_technique(technique);');
		d.write('if(flg1 && flg2){');
		d.write('data = {');
		d.write('projID: projectid,');
		d.write('controlID: pageid,');
		d.write('guideline: guideline,');
		d.write('technique: technique');
		d.write('};');
		d.write('$.ajax({');
		d.write('url: "/diagnose/indexv2/getResultsByTechnique/",');
		d.write('type: "POST",');
		d.write('data: data,');
		d.write('dataType: "html",');
		d.write('error: function(data){');
		d.write('alert("取得エラー");');
		d.write('},');
		d.write('success: function(data) {');
		d.write('var myobj = eval("("+data+")");');
		d.write('var result_text = "";');
		d.write('var pass_cnt = 0;');
		d.write('var check_cnt = 0;');
		d.write('var fail_cnt = 0;');
		d.write('var na_cnt = 0;');
		d.write('for(var i=0; i< myobj.length; i++){');
		d.write('var id = "was3011_"+guideline+"_"+technique+"_"+i;');
		d.write('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');
		d.write('var comments = myobj[i]["comments2"];');
		d.write('var description = myobj[i]["description2"];');
		d.write('var srccode = myobj[i]["srccode2"];');
		d.write('var result = myobj[i]["result"];');
		d.write('switch(result){');
		d.write('case "PASS":');
		d.write('case "PASS_HC":');
		d.write('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');
		d.write('pass_cnt += 1;');
		d.write('break;');
		d.write('case "CHECK":');
		d.write('result = "未";');
		d.write('check_cnt += 1;');
		d.write('break;');
		d.write('case "FAIL_HC":');
		d.write('case "FAIL_AC":');
		d.write('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');
		d.write('fail_cnt += 1;');
		d.write('break;');
		d.write('case "NA_HC":');
		d.write('result = "非適用";');
		d.write('na_cnt;');
		d.write('break;');
		d.write('}');
		d.write('result_text += id + "\\n";');
		d.write('result_text += "検査員: " + user + "\\n";');
		d.write('result_text += "判定: " + result + "\\n";');
		d.write('result_text += "コメント:\\n" + comments + "\\n";');
		d.write('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');
		d.write('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');
		d.write('}');
		d.write('var pr = document.getElementById("desc");');
		d.write('var pr_text = "";');
		d.write('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');
		d.write('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');
		d.write('pr.innerHTML = pr_text;');
		d.write('var ta = document.getElementById("results");');
		d.write('ta.value = result_text;');
		d.write('}');
		d.write('}');
		d.write(');');
		d.write('}else{');
		d.write('alert("JIS番号_実装番号が入力が間違っています:"+all_text);');
		d.write('}');
		d.write('}else{');
		d.write('alert("JIS番号_実装番号が入力が間違っています:"+all_text);');
		d.write('}');
		d.write('}else{');
		d.write('alert("JIS番号_実装番号が入力されていません！");');
		d.write('}');
		d.write('function mydecode(str){');
		d.write('str = str.replace(/&lt;/g,"<");');
		d.write('str = str.replace(/&gt;/g,">");');
		d.write('return str;');
		d.write('}');
		d.write('}');
		d.write('function chk_guideline(str){');
		d.write('var pat = new RegExp(/7\.[1-4]\.[0-9]\.[0-9]/);');
		d.write('var arr = str.match(pat);');
		d.write('if(arr!=null){');
		d.write('return true;');
		d.write('}else{');
		d.write('return false;');
		d.write('}');
		d.write('}');
		d.write('function decode_guideline(str){');
		d.write('var new_str = "";');
		d.write('if(str.length < 5){');
		d.write('new_str += str.charAt(0)+"."+str.charAt(1)+"."+str.charAt(2)+"."+str.charAt(3);');
		d.write('}else{');
		d.write('new_str += str;');
		d.write('}');
		d.write('return new_str;');
		d.write('}');
		d.write('function chk_technique(str){');
		d.write('var pat = new RegExp(/[A-Z][0-9]*/);');
		d.write('var arr = technique.match(pat);');
		d.write('if(arr!=null){');
		d.write('return true;');
		d.write('}else{');
		d.write('return false;');
		d.write('}');
		d.write('}');
		d.write('function my_spliter(str){');
		d.write('var arr = str.split(/(_| )/g);');
		d.write('return arr;');
		d.write('}');
		d.write('</script>');
		d.write('<h1>判定結果参照</h1>');
		d.write('<label for="all_text">JIS番号と実装番号：</label>');
		d.write('<input type="text" id="all_text"><em>（例）7111_G94</em>  ');
		d.write('<input type="hidden" id="hdn_projectid" value="'+projectid+'">');
		d.write('<input type="hidden" id="hdn_pageid" value="'+pageid+'">');
		d.write('<button onclick="browseSurvey()">参照実行</button><br>');
		d.write('<p id="desc"></p>');
		d.write('<textarea id="results"></textarea>');
		d.write('</body>');
		d.write('</html>');
	}
	function get_pageid(){
	  var urlval = "";
	  var pageid = "";
	  var element=document.getElementById("urlList");
	     for(var i=0;i<element.options.length;i++){
	    if(element.options[i].selected){
		  urlval=element.options[i].text;
		  break;
	    }
	     }
	     var pageidpat = new RegExp(/(\[)(.*?)(\])/);
	     var arr = urlval.match(pageidpat);
	     if(arr!=null){
	       pageid = arr[2].toString();
	 	  }
	 	  return pageid;
	}
	function get_projectid(){
		var projectid = "";
		var crturl = window.location.href;
		var prjpat = new RegExp(/projID\/([0-9]*)/);
		var arr = crturl.match(prjpat);
		if(arr!=null){
			projectid = arr[1].toString();
		}
		return projectid;
	}

})();

javascript:(function(){var projectid = get_projectid();var pageid = get_pageid();trgr(projectid, pageid);function trgr(projectid, pageid){d = window.open().document;d.write('<!DOCTYPE html>');d.write('<html lang="ja">');d.write('<head>');d.write('<meta charset="utf-8">');d.write('<title>判定結果参照</title>');d.write('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');d.write('<style type="text/css">');d.write('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.write('h1 {font-size: 170%;}');d.write('#desc,label {font-size: 90%;}');d.write('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');d.write('#all_text {width: 160px;}');d.write('#results {font-size:80%; width: 100%; height: 15em;}');d.write('</style>');d.write('</head>');d.write('<body>');d.write('<script type="text/javascript">');d.write('var guideline = "";');d.write('var technique = "";');d.write('function browseSurvey() {');d.write('var all_text = document.getElementById("all_text").value;');d.write('var projectid = document.getElementById("hdn_projectid").value;');d.write('var pageid = document.getElementById("hdn_pageid").value;');d.write('if(projectid!="" && pageid!="" && all_text!=""){');d.write('var sparr = my_spliter(all_text);');d.write('if(sparr!=null){');d.write('guideline = sparr[0].toString();');d.write('guideline = decode_guideline(guideline);');d.write('technique = sparr[2].toString();');d.write('technique = technique.toUpperCase();');d.write('var flg1 = chk_guideline(guideline);');d.write('var flg2 = chk_technique(technique);');d.write('if(flg1 && flg2){');d.write('data = {');d.write('projID: projectid,');d.write('controlID: pageid,');d.write('guideline: guideline,');d.write('technique: technique');d.write('};');d.write('$.ajax({');d.write('url: "/diagnose/indexv2/getResultsByTechnique/",');d.write('type: "POST",');d.write('data: data,');d.write('dataType: "html",');d.write('error: function(data){');d.write('alert("取得エラー");');d.write('},');d.write('success: function(data) {');d.write('var myobj = eval("("+data+")");');d.write('var result_text = "";');d.write('var pass_cnt = 0;');d.write('var check_cnt = 0;');d.write('var fail_cnt = 0;');d.write('var na_cnt = 0;');d.write('for(var i=0; i< myobj.length; i++){');d.write('var id = "was3011_"+guideline+"_"+technique+"_"+i;');d.write('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');d.write('var comments = myobj[i]["comments2"];');d.write('var description = myobj[i]["description2"];');d.write('var srccode = myobj[i]["srccode2"];');d.write('var result = myobj[i]["result"];');d.write('switch(result){');d.write('case "PASS":');d.write('case "PASS_HC":');d.write('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');d.write('pass_cnt += 1;');d.write('break;');d.write('case "CHECK":');d.write('result = "未";');d.write('check_cnt += 1;');d.write('break;');d.write('case "FAIL_HC":');d.write('case "FAIL_AC":');d.write('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');d.write('fail_cnt += 1;');d.write('break;');d.write('case "NA_HC":');d.write('result = "非適用";');d.write('na_cnt;');d.write('break;');d.write('}');d.write('result_text += id + "\\n";');d.write('result_text += "検査員: " + user + "\\n";');d.write('result_text += "判定: " + result + "\\n";');d.write('result_text += "コメント:\\n" + comments + "\\n";');d.write('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');d.write('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');d.write('}');d.write('var pr = document.getElementById("desc");');d.write('var pr_text = "";');d.write('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');d.write('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');d.write('pr.innerHTML = pr_text;');d.write('var ta = document.getElementById("results");');d.write('ta.value = result_text;');d.write('}');d.write('}');d.write(');');d.write('}else{');d.write('alert("JIS番号_実装番号が入力が間違っています:"+all_text);');d.write('}');d.write('}else{');d.write('alert("JIS番号_実装番号が入力が間違っています:"+all_text);');d.write('}');d.write('}else{');d.write('alert("JIS番号_実装番号が入力されていません！");');d.write('}');d.write('function mydecode(str){');d.write('str = str.replace(/&lt;/g,"<");');d.write('str = str.replace(/&gt;/g,">");');d.write('return str;');d.write('}');d.write('}');d.write('function chk_guideline(str){');d.write('var pat = new RegExp(/7\.[1-4]\.[0-9]\.[0-9]/);');d.write('var arr = str.match(pat);');d.write('if(arr!=null){');d.write('return true;');d.write('}else{');d.write('return false;');d.write('}');d.write('}');d.write('function decode_guideline(str){');d.write('var new_str = "";');d.write('if(str.length < 5){');d.write('new_str += str.charAt(0)+"."+str.charAt(1)+"."+str.charAt(2)+"."+str.charAt(3);');d.write('}else{');d.write('new_str += str;');d.write('}');d.write('return new_str;');d.write('}');d.write('function chk_technique(str){');d.write('var pat = new RegExp(/[A-Z][0-9]*/);');d.write('var arr = technique.match(pat);');d.write('if(arr!=null){');d.write('return true;');d.write('}else{');d.write('return false;');d.write('}');d.write('}');d.write('function my_spliter(str){');d.write('var arr = str.split(/(_| )/g);');d.write('return arr;');d.write('}');d.write('</script>');d.write('<h1>判定結果参照</h1>');d.write('<label for="all_text">JIS番号と実装番号：</label>');d.write('<input type="text" id="all_text"><em>（例）7111_G94</em>  ');d.write('<input type="hidden" id="hdn_projectid" value="'+projectid+'">');d.write('<input type="hidden" id="hdn_pageid" value="'+pageid+'">');d.write('<button onclick="browseSurvey()">参照実行</button><br>');d.write('<p id="desc"></p>');d.write('<textarea id="results"></textarea>');d.write('</body>');d.write('</html>');}function get_pageid(){var urlval = "";var pageid = "";var element=document.getElementById("urlList");for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var pageidpat = new RegExp(/(\[)(.*?)(\])/);var arr = urlval.match(pageidpat);if(arr!=null){pageid = arr[2].toString();}return pageid;}function get_projectid(){var projectid = "";var crturl = window.location.href;var prjpat = new RegExp(/projID\/([0-9]*)/);var arr = crturl.match(prjpat);if(arr!=null){projectid = arr[1].toString();}return projectid;}})();

//V2
javascript:(function(){
	var projectid = get_projectid();
	var pageid = get_pageid();
	trgr(projectid, pageid);
	function trgr(projectid, pageid){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>判定結果参照(V2)</title>');
		d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('#desc,label {font-size: 90%;}');
		d.writeln('#technique_id{width:80px;}');
		d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');
		d.writeln('#all_text {width: 160px;}');
		d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');
		d.writeln('#results dt {font-weight: bold;}');
		d.writeln('#results dd {margin: -1.5em 0 8px 11em;}');
		d.writeln('.first{margin-top: 20px;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('var guideline = "";');
		d.writeln('var technique = "";');
		d.writeln('var result_arr = new Array();');
		d.writeln('function browseSurvey() {');
		d.writeln('var guideline_src = document.getElementById("guideline_id");');
		d.writeln('var technique_src = document.getElementById("technique_id");');
		d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');
		d.writeln('technique = technique_src.value;');
		d.writeln('var projectid = document.getElementById("hdn_projectid").value;');
		d.writeln('var pageid = document.getElementById("hdn_pageid").value;');
		d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');
		d.writeln('data = {');
		d.writeln('projID: projectid,');
		d.writeln('controlID: pageid,');
		d.writeln('guideline: guideline,');
		d.writeln('technique: technique');
		d.writeln('};');
		d.writeln('$.ajax({');
		d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');
		d.writeln('type: "POST",');
		d.writeln('data: data,');
		d.writeln('dataType: "html",');
		d.writeln('error: function(data){');
		d.writeln('alert("取得エラー");');
		d.writeln('},');
		d.writeln('success: function(data) {');
		d.writeln('var myobj = eval("("+data+")");');
		d.writeln('var result_text = "";');
		d.writeln('var pass_cnt = 0;');
		d.writeln('var check_cnt = 0;');
		d.writeln('var fail_cnt = 0;');
		d.writeln('var na_cnt = 0;');
		d.writeln('for(var i=0; i< myobj.length; i++){');
		d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');
		d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');
		d.writeln('var comments = myobj[i]["comments2"];');
		d.writeln('var description = myobj[i]["description2"];');
		d.writeln('var srccode = myobj[i]["srccode2"];');
		d.writeln('var result = myobj[i]["result"];');
		d.writeln('switch(result){');
		d.writeln('case "PASS":');
		d.writeln('case "PASS_HC":');
		d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');
		d.writeln('pass_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "CHECK":');
		d.writeln('result = "未";');
		d.writeln('check_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "FAIL_HC":');
		d.writeln('case "FAIL_AC":');
		d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');
		d.writeln('fail_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "NA_HC":');
		d.writeln('result = "非適用";');
		d.writeln('na_cnt;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('var cnt = result_arr.length;');
		d.writeln('result_arr[cnt] = new Array();');
		d.writeln('result_text += id + "\\n";');
		d.writeln('result_arr[cnt].push(id);');
		d.writeln('result_text += "検査員: " + user + "\\n";');
		d.writeln('result_arr[cnt].push(user);');
		d.writeln('result_text += "判定: " + result + "\\n";');
		d.writeln('result_arr[cnt].push(result);');
		d.writeln('result_text += "コメント:\\n" + comments + "\\n";');
		d.writeln('result_arr[cnt].push(comments);');
		d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');
		d.writeln('result_arr[cnt].push(mydecode(description));');
		d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');
		d.writeln('result_arr[cnt].push(mydecode(srccode));');
		d.writeln('}');
		d.writeln('var pr = document.getElementById("desc");');
		d.writeln('var pr_text = "";');
		d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');
		d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');
		d.writeln('pr.innerHTML = pr_text;');
		d.writeln('var dl = document.getElementById("results");');
		d.writeln('for(var i=0; i<result_arr.length; i++){');
		d.writeln('var dt1 = document.createElement("dt");');
		d.writeln('dt1.setAttribute("class", "first");');
		d.writeln('dt1.textContent = "ID:";');
		d.writeln('dl.appendChild(dt1);');
		d.writeln('var dd1 = document.createElement("dd");');
		d.writeln('dd1.textContent = result_arr[i][0].toString();');
		d.writeln('dl.appendChild(dd1);');
		d.writeln('var dt2 = document.createElement("dt");');
		d.writeln('dt2.textContent = "検査員:";');
		d.writeln('dl.appendChild(dt2);');
		d.writeln('var dd2 = document.createElement("dd");');
		d.writeln('dd2.textContent = result_arr[i][1].toString();');
		d.writeln('dl.appendChild(dd2);');
		d.writeln('var dt3 = document.createElement("dt");');
		d.writeln('dt3.textContent = "判定結果:";');
		d.writeln('dl.appendChild(dt3);');
		d.writeln('var dd3 = document.createElement("dd");');
		d.writeln('dd3.textContent = result_arr[i][2].toString();');
		d.writeln('dl.appendChild(dd3);');
		d.writeln('var dt4 = document.createElement("dt");');
		d.writeln('dt4.textContent = "判定コメント:";');
		d.writeln('dl.appendChild(dt4);');
		d.writeln('var dd4 = document.createElement("dd");');
		d.writeln('dd4.textContent = result_arr[i][3].toString();');
		d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');
		d.writeln('dl.appendChild(dd4);');
		d.writeln('var dt5 = document.createElement("dt");');
		d.writeln('dt5.textContent = "対象ソースコード:";');
		d.writeln('dl.appendChild(dt5);');
		d.writeln('var dd5 = document.createElement("dd");');
		d.writeln('dd5.textContent = result_arr[i][4].toString();');
		d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');
		d.writeln('dl.appendChild(dd5);');
		d.writeln('var dt6 = document.createElement("dt");');
		d.writeln('dt6.textContent = "修正ソースコード:";');
		d.writeln('dl.appendChild(dt6);');
		d.writeln('var dd6 = document.createElement("dd");');
		d.writeln('dd6.textContent = result_arr[i][5].toString();');
		d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');
		d.writeln('dl.appendChild(dd6);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('});');
		d.writeln('}else{');
		d.writeln('alert("参照エラーです！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function mydecode(str){');
		d.writeln('str = str.replace(/&lt;/g,"<");');
		d.writeln('str = str.replace(/&gt;/g,">");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function chk_guideline(str){');
		d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');
		d.writeln('var arr = str.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function chk_technique(str){');
		d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');
		d.writeln('var arr = technique.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>判定結果参照<small>(V2)</small></h1>');
		d.writeln('<label for="all_text">JIS番号と実装番号：</label>');
		d.writeln('<select id="guideline_id"></select>');
		d.writeln('<input type="text" id="technique_id">');
		d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');
		d.writeln('<input type="hidden" id="hdn_pageid" value="' +pageid + '">');
		d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');
		d.writeln('<p id="desc"></p>');
		d.writeln('<dl id="results"></dl>');
		d.writeln('</body>');
		d.writeln('</html>');
		var guidelines = [
			"7.1.1.1",
			"7.1.2.1",
			"7.1.2.2",
			"7.1.2.3",
			"7.1.2.4",
			"7.1.2.5",
			"7.1.3.1",
			"7.1.3.2",
			"7.1.3.3",
			"7.1.4.1",
			"7.1.4.2",
			"7.1.4.3",
			"7.1.4.4",
			"7.1.4.5",
			"7.2.1.1",
			"7.2.1.2",
			"7.2.2.1",
			"7.2.2.2",
			"7.2.3.1",
			"7.2.4.1",
			"7.2.4.2",
			"7.2.4.3",
			"7.2.4.4",
			"7.2.4.5",
			"7.2.4.6",
			"7.2.4.7",
			"7.3.1.1",
			"7.3.1.2",
			"7.3.2.1",
			"7.3.2.2",
			"7.3.2.3",
			"7.3.2.4",
			"7.3.3.1",
			"7.3.3.2",
			"7.3.3.3",
			"7.3.3.4",
			"7.4.1.1",
			"7.4.1.2"
		];
		alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");
		var gdselect = d.getElementById("guideline_id");
		for(var i=0; i<guidelines.length; i++){
			var row = guidelines[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			gdselect.appendChild(opt);
		}
	}
	function get_pageid(){
	  var urlval = "";
	  var pageid = "";
	  var element=document.getElementById("urlList");
	     for(var i=0;i<element.options.length;i++){
			if(element.options[i].selected){
				urlval=element.options[i].text;
				break;
			}
	     }
	     var pageidpat = new RegExp(/(\[)(.*?)(\])/);
	     var arr = urlval.match(pageidpat);
	     if(arr!=null){
	       pageid = arr[2].toString();
	 	  }
	 	  return pageid;
	}
	function get_projectid(){
		var projectid = "";
		var crturl = window.location.href;
		var prjpat = new RegExp(/projID\/([0-9]*)/);
		var arr = crturl.match(prjpat);
		if(arr!=null){
			projectid = arr[1].toString();
		}
		return projectid;
	}
})();


javascript:(function(){var projectid = get_projectid();var pageid = get_pageid();trgr(projectid, pageid);function trgr(projectid, pageid){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>判定結果参照(V2)</title>');d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('#desc,label {font-size: 90%;}');d.writeln('#technique_id{width:80px;}');d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');d.writeln('#all_text {width: 160px;}');d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');d.writeln('#results dt {font-weight: bold;}');d.writeln('#results dd {margin: -1.5em 0 8px 11em;}');d.writeln('.first{margin-top: 20px;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('var guideline = "";');d.writeln('var technique = "";');d.writeln('var result_arr = new Array();');d.writeln('function browseSurvey() {');d.writeln('var guideline_src = document.getElementById("guideline_id");');d.writeln('var technique_src = document.getElementById("technique_id");');d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');d.writeln('technique = technique_src.value;');d.writeln('var projectid = document.getElementById("hdn_projectid").value;');d.writeln('var pageid = document.getElementById("hdn_pageid").value;');d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');d.writeln('data = {');d.writeln('projID: projectid,');d.writeln('controlID: pageid,');d.writeln('guideline: guideline,');d.writeln('technique: technique');d.writeln('};');d.writeln('$.ajax({');d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');d.writeln('type: "POST",');d.writeln('data: data,');d.writeln('dataType: "html",');d.writeln('error: function(data){');d.writeln('alert("取得エラー");');d.writeln('},');d.writeln('success: function(data) {');d.writeln('var myobj = eval("("+data+")");');d.writeln('var result_text = "";');d.writeln('var pass_cnt = 0;');d.writeln('var check_cnt = 0;');d.writeln('var fail_cnt = 0;');d.writeln('var na_cnt = 0;');d.writeln('for(var i=0; i< myobj.length; i++){');d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');d.writeln('var comments = myobj[i]["comments2"];');d.writeln('var description = myobj[i]["description2"];');d.writeln('var srccode = myobj[i]["srccode2"];');d.writeln('var result = myobj[i]["result"];');d.writeln('switch(result){');d.writeln('case "PASS":');d.writeln('case "PASS_HC":');d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');d.writeln('pass_cnt += 1;');d.writeln('break;');d.writeln('case "CHECK":');d.writeln('result = "未";');d.writeln('check_cnt += 1;');d.writeln('break;');d.writeln('case "FAIL_HC":');d.writeln('case "FAIL_AC":');d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');d.writeln('fail_cnt += 1;');d.writeln('break;');d.writeln('case "NA_HC":');d.writeln('result = "非適用";');d.writeln('na_cnt;');d.writeln('break;');d.writeln('}');d.writeln('var cnt = result_arr.length;');d.writeln('result_arr[cnt] = new Array();');d.writeln('result_text += id + "\\n";');d.writeln('result_arr[cnt].push(id);');d.writeln('result_text += "検査員: " + user + "\\n";');d.writeln('result_arr[cnt].push(user);');d.writeln('result_text += "判定: " + result + "\\n";');d.writeln('result_arr[cnt].push(result);');d.writeln('result_text += "コメント:\\n" + comments + "\\n";');d.writeln('result_arr[cnt].push(comments);');d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');d.writeln('result_arr[cnt].push(mydecode(description));');d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');d.writeln('result_arr[cnt].push(mydecode(srccode));');d.writeln('}');d.writeln('var pr = document.getElementById("desc");');d.writeln('var pr_text = "";');d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');d.writeln('pr.innerHTML = pr_text;');d.writeln('var dl = document.getElementById("results");');d.writeln('for(var i=0; i<result_arr.length; i++){');d.writeln('var dt1 = document.createElement("dt");');d.writeln('dt1.setAttribute("class", "first");');d.writeln('dt1.textContent = "ID:";');d.writeln('dl.appendChild(dt1);');d.writeln('var dd1 = document.createElement("dd");');d.writeln('dd1.textContent = result_arr[i][0].toString();');d.writeln('dl.appendChild(dd1);');d.writeln('var dt2 = document.createElement("dt");');d.writeln('dt2.textContent = "検査員:";');d.writeln('dl.appendChild(dt2);');d.writeln('var dd2 = document.createElement("dd");');d.writeln('dd2.textContent = result_arr[i][1].toString();');d.writeln('dl.appendChild(dd2);');d.writeln('var dt3 = document.createElement("dt");');d.writeln('dt3.textContent = "判定結果:";');d.writeln('dl.appendChild(dt3);');d.writeln('var dd3 = document.createElement("dd");');d.writeln('dd3.textContent = result_arr[i][2].toString();');d.writeln('dl.appendChild(dd3);');d.writeln('var dt4 = document.createElement("dt");');d.writeln('dt4.textContent = "判定コメント:";');d.writeln('dl.appendChild(dt4);');d.writeln('var dd4 = document.createElement("dd");');d.writeln('dd4.textContent = result_arr[i][3].toString();');d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');d.writeln('dl.appendChild(dd4);');d.writeln('var dt5 = document.createElement("dt");');d.writeln('dt5.textContent = "対象ソースコード:";');d.writeln('dl.appendChild(dt5);');d.writeln('var dd5 = document.createElement("dd");');d.writeln('dd5.textContent = result_arr[i][4].toString();');d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');d.writeln('dl.appendChild(dd5);');d.writeln('var dt6 = document.createElement("dt");');d.writeln('dt6.textContent = "修正ソースコード:";');d.writeln('dl.appendChild(dt6);');d.writeln('var dd6 = document.createElement("dd");');d.writeln('dd6.textContent = result_arr[i][5].toString();');d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');d.writeln('dl.appendChild(dd6);');d.writeln('}');d.writeln('}');d.writeln('});');d.writeln('}else{');d.writeln('alert("参照エラーです！");');d.writeln('}');d.writeln('}');d.writeln('function mydecode(str){');d.writeln('str = str.replace(/&lt;/g,"<");');d.writeln('str = str.replace(/&gt;/g,">");');d.writeln('return str;');d.writeln('}');d.writeln('function chk_guideline(str){');d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');d.writeln('var arr = str.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('function chk_technique(str){');d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');d.writeln('var arr = technique.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('</script>');d.writeln('<h1>判定結果参照<small>(V2)</small></h1>');d.writeln('<label for="all_text">JIS番号と実装番号：</label>');d.writeln('<select id="guideline_id"></select>');d.writeln('<input type="text" id="technique_id">');d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');d.writeln('<input type="hidden" id="hdn_pageid" value="' +pageid + '">');d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');d.writeln('<p id="desc"></p>');d.writeln('<dl id="results"></dl>');d.writeln('</body>');d.writeln('</html>');var guidelines = ["7.1.1.1","7.1.2.1","7.1.2.2","7.1.2.3","7.1.2.4","7.1.2.5","7.1.3.1","7.1.3.2","7.1.3.3","7.1.4.1","7.1.4.2","7.1.4.3","7.1.4.4","7.1.4.5","7.2.1.1","7.2.1.2","7.2.2.1","7.2.2.2","7.2.3.1","7.2.4.1","7.2.4.2","7.2.4.3","7.2.4.4","7.2.4.5","7.2.4.6","7.2.4.7","7.3.1.1","7.3.1.2","7.3.2.1","7.3.2.2","7.3.2.3","7.3.2.4","7.3.3.1","7.3.3.2","7.3.3.3","7.3.3.4","7.4.1.1","7.4.1.2"];alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");var gdselect = d.getElementById("guideline_id");for(var i=0; i<guidelines.length; i++){var row = guidelines[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;gdselect.appendChild(opt);}}function get_pageid(){var urlval = "";var pageid = "";var element=document.getElementById("urlList");for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var pageidpat = new RegExp(/(\[)(.*?)(\])/);var arr = urlval.match(pageidpat);if(arr!=null){pageid = arr[2].toString();}return pageid;}function get_projectid(){var projectid = "";var crturl = window.location.href;var prjpat = new RegExp(/projID\/([0-9]*)/);var arr = crturl.match(prjpat);if(arr!=null){projectid = arr[1].toString();}return projectid;}})();

//V3
javascript:(function(){
	var projectid = get_projectid();
	var urls = create_pageid_arr();
	var guidelines = [
		"7.1.1.1",
		"7.1.2.1",
		"7.1.2.2",
		"7.1.2.3",
		"7.1.2.4",
		"7.1.2.5",
		"7.1.3.1",
		"7.1.3.2",
		"7.1.3.3",
		"7.1.4.1",
		"7.1.4.2",
		"7.1.4.3",
		"7.1.4.4",
		"7.1.4.5",
		"7.2.1.1",
		"7.2.1.2",
		"7.2.2.1",
		"7.2.2.2",
		"7.2.3.1",
		"7.2.4.1",
		"7.2.4.2",
		"7.2.4.3",
		"7.2.4.4",
		"7.2.4.5",
		"7.2.4.6",
		"7.2.4.7",
		"7.3.1.1",
		"7.3.1.2",
		"7.3.2.1",
		"7.3.2.2",
		"7.3.2.3",
		"7.3.2.4",
		"7.3.3.1",
		"7.3.3.2",
		"7.3.3.3",
		"7.3.3.4",
		"7.4.1.1",
		"7.4.1.2"
	];
	trgr(projectid, urls, guidelines);
	function trgr(projectid, urls, guidelines){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>判定結果参照(V2)</title>');
		d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('#desc,label {font-size: 90%;}');
		d.writeln('#technique_id{width:80px;}');
		d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');
		d.writeln('#all_text {width: 160px;}');
		d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');
		d.writeln('#results dt {font-weight: bold;}');
		d.writeln('#results dd {margin: -1.5em 0 8px 11em;}');
		d.writeln('.first{margin-top: 20px;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('var pageid = "";');
		d.writeln('var guideline = "";');
		d.writeln('var technique = "";');
		d.writeln('var result_arr = new Array();');
		d.writeln('function browseSurvey() {');
		d.writeln('var pageid_src = document.getElementById("page_id");');
		d.writeln('var guideline_src = document.getElementById("guideline_id");');
		d.writeln('var technique_src = document.getElementById("technique_id");');
		d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');
		d.writeln('pageid = pageid_src.options[pageid_src.selectedIndex].text;');
		d.writeln('technique = technique_src.value;');
		d.writeln('var projectid = document.getElementById("hdn_projectid").value;');
		d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');
		d.writeln('data = {');
		d.writeln('projID: projectid,');
		d.writeln('controlID: pageid,');
		d.writeln('guideline: guideline,');
		d.writeln('technique: technique');
		d.writeln('};');
		d.writeln('$.ajax({');
		d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');
		d.writeln('type: "POST",');
		d.writeln('data: data,');
		d.writeln('dataType: "html",');
		d.writeln('error: function(data){');
		d.writeln('alert("取得エラー");');
		d.writeln('},');
		d.writeln('success: function(data) {');
		d.writeln('var result_arr = new Array();');
		d.writeln('var myobj = eval("("+data+")");');
		d.writeln('var result_text = "";');
		d.writeln('var pass_cnt = 0;');
		d.writeln('var check_cnt = 0;');
		d.writeln('var fail_cnt = 0;');
		d.writeln('var na_cnt = 0;');
		d.writeln('for(var i=0; i< myobj.length; i++){');
		d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');
		d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');
		d.writeln('var comments = myobj[i]["comments2"];');
		d.writeln('var description = myobj[i]["description2"];');
		d.writeln('var srccode = myobj[i]["srccode2"];');
		d.writeln('var result = myobj[i]["result"];');
		d.writeln('switch(result){');
		d.writeln('case "PASS":');
		d.writeln('case "PASS_HC":');
		d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');
		d.writeln('pass_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "CHECK":');
		d.writeln('result = "未";');
		d.writeln('check_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "FAIL_HC":');
		d.writeln('case "FAIL_AC":');
		d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');
		d.writeln('fail_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "NA_HC":');
		d.writeln('result = "非適用";');
		d.writeln('na_cnt;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('var cnt = result_arr.length;');
		d.writeln('result_arr[cnt] = new Array();');
		d.writeln('result_text += id + "\\n";');
		d.writeln('result_arr[cnt].push(id);');
		d.writeln('result_text += "検査員: " + user + "\\n";');
		d.writeln('result_arr[cnt].push(user);');
		d.writeln('result_text += "判定: " + result + "\\n";');
		d.writeln('result_arr[cnt].push(result);');
		d.writeln('result_text += "コメント:\\n" + comments + "\\n";');
		d.writeln('result_arr[cnt].push(comments);');
		d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');
		d.writeln('result_arr[cnt].push(mydecode(description));');
		d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');
		d.writeln('result_arr[cnt].push(mydecode(srccode));');
		d.writeln('}');
		d.writeln('var pr = document.getElementById("desc");');
		d.writeln('var pr_text = "";');
		d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');
		d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');
		d.writeln('pr.innerHTML = pr_text;');
		d.writeln('var dl = document.getElementById("results");');
		d.writeln('dl.innerHTML = "";');
		d.writeln('for(var i=0; i<result_arr.length; i++){');
		d.writeln('var dt1 = document.createElement("dt");');
		d.writeln('dt1.setAttribute("class", "first");');
		d.writeln('dt1.textContent = "ID:";');
		d.writeln('dl.appendChild(dt1);');
		d.writeln('var dd1 = document.createElement("dd");');
		d.writeln('dd1.textContent = result_arr[i][0].toString();');
		d.writeln('dl.appendChild(dd1);');
		d.writeln('var dt2 = document.createElement("dt");');
		d.writeln('dt2.textContent = "検査員:";');
		d.writeln('dl.appendChild(dt2);');
		d.writeln('var dd2 = document.createElement("dd");');
		d.writeln('dd2.textContent = result_arr[i][1].toString();');
		d.writeln('dl.appendChild(dd2);');
		d.writeln('var dt3 = document.createElement("dt");');
		d.writeln('dt3.textContent = "判定結果:";');
		d.writeln('dl.appendChild(dt3);');
		d.writeln('var dd3 = document.createElement("dd");');
		d.writeln('dd3.textContent = result_arr[i][2].toString();');
		d.writeln('dl.appendChild(dd3);');
		d.writeln('var dt4 = document.createElement("dt");');
		d.writeln('dt4.textContent = "判定コメント:";');
		d.writeln('dl.appendChild(dt4);');
		d.writeln('var dd4 = document.createElement("dd");');
		d.writeln('dd4.textContent = result_arr[i][3].toString();');
		d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');
		d.writeln('dl.appendChild(dd4);');
		d.writeln('var dt5 = document.createElement("dt");');
		d.writeln('dt5.textContent = "対象ソースコード:";');
		d.writeln('dl.appendChild(dt5);');
		d.writeln('var dd5 = document.createElement("dd");');
		d.writeln('dd5.textContent = result_arr[i][4].toString();');
		d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');
		d.writeln('dl.appendChild(dd5);');
		d.writeln('var dt6 = document.createElement("dt");');
		d.writeln('dt6.textContent = "修正ソースコード:";');
		d.writeln('dl.appendChild(dt6);');
		d.writeln('var dd6 = document.createElement("dd");');
		d.writeln('dd6.textContent = result_arr[i][5].toString();');
		d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');
		d.writeln('dl.appendChild(dd6);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('});');
		d.writeln('}else{');
		d.writeln('alert("参照エラーです！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function mydecode(str){');
		d.writeln('str = str.replace(/&lt;/g,"<");');
		d.writeln('str = str.replace(/&gt;/g,">");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function chk_guideline(str){');
		d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');
		d.writeln('var arr = str.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function chk_technique(str){');
		d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');
		d.writeln('var arr = technique.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>判定結果参照<small>(V2)</small></h1>');
		d.writeln('<label for="">URL:</label>');
		d.writeln('<select id="page_id"></select><br>');
		d.writeln('<label for="all_text">JIS番号と実装番号：</label>');
		d.writeln('<select id="guideline_id"></select>');
		d.writeln('<input type="text" id="technique_id">');
		d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');
		d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');
		d.writeln('<p id="desc"></p>');
		d.writeln('<dl id="results"></dl>');
		d.writeln('</body>');
		d.writeln('</html>');
		alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");
		var gdselect = d.getElementById("guideline_id");
		for(var i=0; i<guidelines.length; i++){
			var row = guidelines[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			gdselect.appendChild(opt);
		}
		var pageselect = d.getElementById("page_id");
		for(var i=0; i<urls.length; i++){
			var row = urls[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			pageselect.appendChild(opt);
		}
	}
	function get_pageid(){
	  var urlval = "";
	  var pageid = "";
	  var element=document.getElementById("urlList");
	     for(var i=0;i<element.options.length;i++){
			if(element.options[i].selected){
				urlval=element.options[i].text;
				break;
			}
	     }
	     var pageidpat = new RegExp(/(\[)(.*?)(\])/);
	     var arr = urlval.match(pageidpat);
	     if(arr!=null){
	       pageid = arr[2].toString();
	 	  }
	 	  return pageid;
	}
	function get_projectid(){
		var projectid = "";
		var crturl = window.location.href;
		var prjpat = new RegExp(/projID\/([0-9]*)/);
		var arr = crturl.match(prjpat);
		if(arr!=null){
			projectid = arr[1].toString();
		}
		return projectid;
	}
	function create_pageid_arr(){
		var arr = new Array();
		var urlselect = document.getElementById("urlList");
		for(var i=0; i<urlselect.options.length; i++){
			var urlalltext = urlselect.options[i].text;
			var pageid_pat = new RegExp(/\[(.+?)\]/);
			var pageid_arr = urlalltext.match(pageid_pat);
			var pageidtext = "";
			if(pageid_arr!==null){
				pageidtext = pageid_arr[1].toString();
			}
			arr.push(pageidtext);
		}
		return arr;
	}
})();


javascript:(function(){var projectid = get_projectid();var urls = create_pageid_arr();var guidelines = ["7.1.1.1","7.1.2.1","7.1.2.2","7.1.2.3","7.1.2.4","7.1.2.5","7.1.3.1","7.1.3.2","7.1.3.3","7.1.4.1","7.1.4.2","7.1.4.3","7.1.4.4","7.1.4.5","7.2.1.1","7.2.1.2","7.2.2.1","7.2.2.2","7.2.3.1","7.2.4.1","7.2.4.2","7.2.4.3","7.2.4.4","7.2.4.5","7.2.4.6","7.2.4.7","7.3.1.1","7.3.1.2","7.3.2.1","7.3.2.2","7.3.2.3","7.3.2.4","7.3.3.1","7.3.3.2","7.3.3.3","7.3.3.4","7.4.1.1","7.4.1.2"];trgr(projectid, urls, guidelines);function trgr(projectid, urls, guidelines){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>判定結果参照(V2)</title>');d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('#desc,label {font-size: 90%;}');d.writeln('#technique_id{width:80px;}');d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');d.writeln('#all_text {width: 160px;}');d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');d.writeln('#results dt {font-weight: bold;}');d.writeln('#results dd {margin: -1.5em 0 8px 11em;}');d.writeln('.first{margin-top: 20px;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('var pageid = "";');d.writeln('var guideline = "";');d.writeln('var technique = "";');d.writeln('var result_arr = new Array();');d.writeln('function browseSurvey() {');d.writeln('var pageid_src = document.getElementById("page_id");');d.writeln('var guideline_src = document.getElementById("guideline_id");');d.writeln('var technique_src = document.getElementById("technique_id");');d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');d.writeln('pageid = pageid_src.options[pageid_src.selectedIndex].text;');d.writeln('technique = technique_src.value;');d.writeln('var projectid = document.getElementById("hdn_projectid").value;');d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');d.writeln('data = {');d.writeln('projID: projectid,');d.writeln('controlID: pageid,');d.writeln('guideline: guideline,');d.writeln('technique: technique');d.writeln('};');d.writeln('$.ajax({');d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');d.writeln('type: "POST",');d.writeln('data: data,');d.writeln('dataType: "html",');d.writeln('error: function(data){');d.writeln('alert("取得エラー");');d.writeln('},');d.writeln('success: function(data) {');d.writeln('var result_arr = new Array();');d.writeln('var myobj = eval("("+data+")");');d.writeln('var result_text = "";');d.writeln('var pass_cnt = 0;');d.writeln('var check_cnt = 0;');d.writeln('var fail_cnt = 0;');d.writeln('var na_cnt = 0;');d.writeln('for(var i=0; i< myobj.length; i++){');d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');d.writeln('var comments = myobj[i]["comments2"];');d.writeln('var description = myobj[i]["description2"];');d.writeln('var srccode = myobj[i]["srccode2"];');d.writeln('var result = myobj[i]["result"];');d.writeln('switch(result){');d.writeln('case "PASS":');d.writeln('case "PASS_HC":');d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');d.writeln('pass_cnt += 1;');d.writeln('break;');d.writeln('case "CHECK":');d.writeln('result = "未";');d.writeln('check_cnt += 1;');d.writeln('break;');d.writeln('case "FAIL_HC":');d.writeln('case "FAIL_AC":');d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');d.writeln('fail_cnt += 1;');d.writeln('break;');d.writeln('case "NA_HC":');d.writeln('result = "非適用";');d.writeln('na_cnt;');d.writeln('break;');d.writeln('}');d.writeln('var cnt = result_arr.length;');d.writeln('result_arr[cnt] = new Array();');d.writeln('result_text += id + "\\n";');d.writeln('result_arr[cnt].push(id);');d.writeln('result_text += "検査員: " + user + "\\n";');d.writeln('result_arr[cnt].push(user);');d.writeln('result_text += "判定: " + result + "\\n";');d.writeln('result_arr[cnt].push(result);');d.writeln('result_text += "コメント:\\n" + comments + "\\n";');d.writeln('result_arr[cnt].push(comments);');d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');d.writeln('result_arr[cnt].push(mydecode(description));');d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');d.writeln('result_arr[cnt].push(mydecode(srccode));');d.writeln('}');d.writeln('var pr = document.getElementById("desc");');d.writeln('var pr_text = "";');d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');d.writeln('pr.innerHTML = pr_text;');d.writeln('var dl = document.getElementById("results");');d.writeln('dl.innerHTML = "";');d.writeln('for(var i=0; i<result_arr.length; i++){');d.writeln('var dt1 = document.createElement("dt");');d.writeln('dt1.setAttribute("class", "first");');d.writeln('dt1.textContent = "ID:";');d.writeln('dl.appendChild(dt1);');d.writeln('var dd1 = document.createElement("dd");');d.writeln('dd1.textContent = result_arr[i][0].toString();');d.writeln('dl.appendChild(dd1);');d.writeln('var dt2 = document.createElement("dt");');d.writeln('dt2.textContent = "検査員:";');d.writeln('dl.appendChild(dt2);');d.writeln('var dd2 = document.createElement("dd");');d.writeln('dd2.textContent = result_arr[i][1].toString();');d.writeln('dl.appendChild(dd2);');d.writeln('var dt3 = document.createElement("dt");');d.writeln('dt3.textContent = "判定結果:";');d.writeln('dl.appendChild(dt3);');d.writeln('var dd3 = document.createElement("dd");');d.writeln('dd3.textContent = result_arr[i][2].toString();');d.writeln('dl.appendChild(dd3);');d.writeln('var dt4 = document.createElement("dt");');d.writeln('dt4.textContent = "判定コメント:";');d.writeln('dl.appendChild(dt4);');d.writeln('var dd4 = document.createElement("dd");');d.writeln('dd4.textContent = result_arr[i][3].toString();');d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');d.writeln('dl.appendChild(dd4);');d.writeln('var dt5 = document.createElement("dt");');d.writeln('dt5.textContent = "対象ソースコード:";');d.writeln('dl.appendChild(dt5);');d.writeln('var dd5 = document.createElement("dd");');d.writeln('dd5.textContent = result_arr[i][4].toString();');d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');d.writeln('dl.appendChild(dd5);');d.writeln('var dt6 = document.createElement("dt");');d.writeln('dt6.textContent = "修正ソースコード:";');d.writeln('dl.appendChild(dt6);');d.writeln('var dd6 = document.createElement("dd");');d.writeln('dd6.textContent = result_arr[i][5].toString();');d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');d.writeln('dl.appendChild(dd6);');d.writeln('}');d.writeln('}');d.writeln('});');d.writeln('}else{');d.writeln('alert("参照エラーです！");');d.writeln('}');d.writeln('}');d.writeln('function mydecode(str){');d.writeln('str = str.replace(/&lt;/g,"<");');d.writeln('str = str.replace(/&gt;/g,">");');d.writeln('return str;');d.writeln('}');d.writeln('function chk_guideline(str){');d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');d.writeln('var arr = str.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('function chk_technique(str){');d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');d.writeln('var arr = technique.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('</script>');d.writeln('<h1>判定結果参照<small>(V2)</small></h1>');d.writeln('<label for="">URL:</label>');d.writeln('<select id="page_id"></select><br>');d.writeln('<label for="all_text">JIS番号と実装番号：</label>');d.writeln('<select id="guideline_id"></select>');d.writeln('<input type="text" id="technique_id">');d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');d.writeln('<p id="desc"></p>');d.writeln('<dl id="results"></dl>');d.writeln('</body>');d.writeln('</html>');alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");var gdselect = d.getElementById("guideline_id");for(var i=0; i<guidelines.length; i++){var row = guidelines[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;gdselect.appendChild(opt);}var pageselect = d.getElementById("page_id");for(var i=0; i<urls.length; i++){var row = urls[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;pageselect.appendChild(opt);}}function get_pageid(){var urlval = "";var pageid = "";var element=document.getElementById("urlList");for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var pageidpat = new RegExp(/(\[)(.*?)(\])/);var arr = urlval.match(pageidpat);if(arr!=null){pageid = arr[2].toString();}return pageid;}function get_projectid(){var projectid = "";var crturl = window.location.href;var prjpat = new RegExp(/projID\/([0-9]*)/);var arr = crturl.match(prjpat);if(arr!=null){projectid = arr[1].toString();}return projectid;}function create_pageid_arr(){var arr = new Array();var urlselect = document.getElementById("urlList");for(var i=0; i<urlselect.options.length; i++){var urlalltext = urlselect.options[i].text;var pageid_pat = new RegExp(/\[(.+?)\]/);var pageid_arr = urlalltext.match(pageid_pat);var pageidtext = "";if(pageid_arr!==null){pageidtext = pageid_arr[1].toString();}arr.push(pageidtext);}return arr;}})();

//V4(配布はこのバージョンまで)
javascript:(function(){
	var projectid = get_projectid();
	var urls = create_pageid_arr();
	var guidelines = [
		"7.1.1.1",
		"7.1.2.1",
		"7.1.2.2",
		"7.1.2.3",
		"7.1.2.4",
		"7.1.2.5",
		"7.1.3.1",
		"7.1.3.2",
		"7.1.3.3",
		"7.1.4.1",
		"7.1.4.2",
		"7.1.4.3",
		"7.1.4.4",
		"7.1.4.5",
		"7.2.1.1",
		"7.2.1.2",
		"7.2.2.1",
		"7.2.2.2",
		"7.2.3.1",
		"7.2.4.1",
		"7.2.4.2",
		"7.2.4.3",
		"7.2.4.4",
		"7.2.4.5",
		"7.2.4.6",
		"7.2.4.7",
		"7.3.1.1",
		"7.3.1.2",
		"7.3.2.1",
		"7.3.2.2",
		"7.3.2.3",
		"7.3.2.4",
		"7.3.3.1",
		"7.3.3.2",
		"7.3.3.3",
		"7.3.3.4",
		"7.4.1.1",
		"7.4.1.2"
	];
	trgr(projectid, urls, guidelines);
	function trgr(projectid, urls, guidelines){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>判定結果参照(V3)</title>');
		d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('#desc,label {font-size: 90%;}');
		d.writeln('#technique_id{width:80px;}');
		d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');
		d.writeln('#all_text {width: 160px;}');
		d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');
		d.writeln('#results dt {font-weight: bold;}');
		d.writeln('#results dd {margin: -1.5em 0 3px 11em;}');
		d.writeln('.first{margin-top: 25px;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('var techs = {');
		d.writeln('"7.1.1.1": "H37,H24,G94,H2,H30,IFC2016,IFC1022,H44,H65,G68,G100,IFC1002,H67,C9",');
		d.writeln('"7.1.2.1": "G158,IFC1003",');
		d.writeln('"7.1.2.2": "IFC1004",');
		d.writeln('"7.1.2.3": "IFC1005",');
		d.writeln('"7.1.2.4": "IFC2007,IFC2008",');
		d.writeln('"7.1.2.5": "IFC1023",');
		d.writeln('"7.1.3.1": "IFC2001,G117,G140,G138,H51,IFC1036,H44,H65,H71,H85,H48,H42,SCR21,IFC2005",');
		d.writeln('"7.1.3.2": "IFC1006,C8",');
		d.writeln('"7.1.3.3": "G96",');
		d.writeln('"7.1.4.1": "IFC2006,IFC1037,IFC1038",');
		d.writeln('"7.1.4.2": "IFC1007",');
		d.writeln('"7.1.4.3": "G18,G148,G174,G145",');
		d.writeln('"7.1.4.4": "G142,IFC1025,IFC1026,G178,G179",');
		d.writeln('"7.1.4.5": "C22,C30,G140",');
		d.writeln('"7.2.1.1": "IFC1008",');
		d.writeln('"7.2.1.2": "G21",');
		d.writeln('"7.2.2.1": "G133,IFC2026,G198,G180,IFC1009,IFC2015",');
		d.writeln('"7.2.2.2": "IFC1039",');
		d.writeln('"7.2.3.1": "IFC1011",');
		d.writeln('"7.2.4.1": "IFC1040,H69,H50,SCR28",');
		d.writeln('"7.2.4.2": "IFC1013",');
		d.writeln('"7.2.4.3": "IFC1014,IFC1041",');
		d.writeln('"7.2.4.4": "IFC1015,H24,G53,H77,H78,H79,H80,H81,C7",');
		d.writeln('"7.2.4.5": "G125,G64,G63,G161,G126,G185",');
		d.writeln('"7.2.4.6": "G130,G131",');
		d.writeln('"7.2.4.7": "IFC1042",');
		d.writeln('"7.3.1.1": "H57",');
		d.writeln('"7.3.1.2": "H58",');
		d.writeln('"7.3.2.1": "G107",');
		d.writeln('"7.3.2.2": "IFC1016",');
		d.writeln('"7.3.2.3": "G61",');
		d.writeln('"7.3.2.4": "G197",');
		d.writeln('"7.3.3.1": "IFC2025,IFC1018",');
		d.writeln('"7.3.3.2": "G89,G184,G162,G83,H44,H65,H71,G167",');
		d.writeln('"7.3.3.3": "G83,IFC2017",');
		d.writeln('"7.3.3.4": "IFC2019,IFC2020,IFC2021",');
		d.writeln('"7.4.1.1": "IFC1019",');
		d.writeln('"7.4.1.2": "IFC1020,IFC1021,SCR21",');
		d.writeln('};');
		d.writeln('function create_techs(){');
		d.writeln('var select = document.getElementById("technique_id");');
		d.writeln('select.innerHTML = "";');
		d.writeln('var src = document.getElementById("guideline_id");');
		d.writeln('var guideline_id = src.options[src.selectedIndex].text;');
		d.writeln('var tmp = new Array();');
		d.writeln('for(var key in techs){');
		d.writeln('if(key == guideline_id){');
		d.writeln('var val = techs[key].toString();');
		d.writeln('tmp = val.split(",");');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('for(var i=0; i < tmp.length; i++){');
		d.writeln('var elm = document.createElement("option");');
		d.writeln('elm.setAttribute("value", tmp[i].toString());');
		d.writeln('elm.textContent = tmp[i].toString();');
		d.writeln('select.appendChild(elm);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('var pageid = "";');
		d.writeln('var guideline = "";');
		d.writeln('var technique = "";');
		d.writeln('var result_arr = new Array();');
		d.writeln('function browseSurvey() {');
		d.writeln('var pageid_src = document.getElementById("page_id");');
		d.writeln('var guideline_src = document.getElementById("guideline_id");');
		d.writeln('var technique_src = document.getElementById("technique_id");');
		d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');
		d.writeln('pageid = pageid_src.options[pageid_src.selectedIndex].text;');
		d.writeln('technique = technique_src.options[technique_src.selectedIndex].text;');
		d.writeln('var projectid = document.getElementById("hdn_projectid").value;');
		d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');
		d.writeln('data = {');
		d.writeln('projID: projectid,');
		d.writeln('controlID: pageid,');
		d.writeln('guideline: guideline,');
		d.writeln('technique: technique');
		d.writeln('};');
		d.writeln('$.ajax({');
		d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');
		d.writeln('type: "POST",');
		d.writeln('data: data,');
		d.writeln('dataType: "html",');
		d.writeln('error: function(data){');
		d.writeln('alert("取得エラー");');
		d.writeln('},');
		d.writeln('success: function(data) {');
		d.writeln('var result_arr = new Array();');
		d.writeln('var myobj = eval("("+data+")");');
		d.writeln('var result_text = "";');
		d.writeln('var pass_cnt = 0;');
		d.writeln('var check_cnt = 0;');
		d.writeln('var fail_cnt = 0;');
		d.writeln('var na_cnt = 0;');
		d.writeln('for(var i=0; i< myobj.length; i++){');
		d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');
		d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');
		d.writeln('var comments = myobj[i]["comments2"];');
		d.writeln('var description = myobj[i]["description2"];');
		d.writeln('var srccode = myobj[i]["srccode2"];');
		d.writeln('var result = myobj[i]["result"];');
		d.writeln('switch(result){');
		d.writeln('case "PASS":');
		d.writeln('case "PASS_HC":');
		d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');
		d.writeln('pass_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "CHECK":');
		d.writeln('result = "未";');
		d.writeln('check_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "FAIL_HC":');
		d.writeln('case "FAIL_AC":');
		d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');
		d.writeln('fail_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "NA_HC":');
		d.writeln('result = "非適用";');
		d.writeln('na_cnt;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('var cnt = result_arr.length;');
		d.writeln('result_arr[cnt] = new Array();');
		d.writeln('result_text += id + "\\n";');
		d.writeln('result_arr[cnt].push(id);');
		d.writeln('result_text += "検査員: " + user + "\\n";');
		d.writeln('result_arr[cnt].push(user);');
		d.writeln('result_text += "判定: " + result + "\\n";');
		d.writeln('result_arr[cnt].push(result);');
		d.writeln('result_text += "コメント:\\n" + comments + "\\n";');
		d.writeln('result_arr[cnt].push(comments);');
		d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');
		d.writeln('result_arr[cnt].push(mydecode(description));');
		d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');
		d.writeln('result_arr[cnt].push(mydecode(srccode));');
		d.writeln('}');
		d.writeln('var pr = document.getElementById("desc");');
		d.writeln('var pr_text = "";');
		d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');
		d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');
		d.writeln('pr.innerHTML = pr_text;');
		d.writeln('var dl = document.getElementById("results");');
		d.writeln('dl.innerHTML = "";');
		d.writeln('for(var i=0; i<result_arr.length; i++){');
		d.writeln('var dt1 = document.createElement("dt");');
		d.writeln('dt1.setAttribute("class", "first");');
		d.writeln('dt1.textContent = "ID:";');
		d.writeln('dl.appendChild(dt1);');
		d.writeln('var dd1 = document.createElement("dd");');
		d.writeln('dd1.textContent = result_arr[i][0].toString();');
		d.writeln('dl.appendChild(dd1);');
		d.writeln('var dt2 = document.createElement("dt");');
		d.writeln('dt2.textContent = "検査員:";');
		d.writeln('dl.appendChild(dt2);');
		d.writeln('var dd2 = document.createElement("dd");');
		d.writeln('dd2.textContent = result_arr[i][1].toString();');
		d.writeln('dl.appendChild(dd2);');
		d.writeln('var dt3 = document.createElement("dt");');
		d.writeln('dt3.textContent = "判定結果:";');
		d.writeln('dl.appendChild(dt3);');
		d.writeln('var dd3 = document.createElement("dd");');
		d.writeln('dd3.textContent = result_arr[i][2].toString();');
		d.writeln('dl.appendChild(dd3);');
		d.writeln('var dt4 = document.createElement("dt");');
		d.writeln('dt4.textContent = "判定コメント:";');
		d.writeln('dl.appendChild(dt4);');
		d.writeln('var dd4 = document.createElement("dd");');
		d.writeln('dd4.textContent = result_arr[i][3].toString();');
		d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');
		d.writeln('dl.appendChild(dd4);');
		d.writeln('var dt5 = document.createElement("dt");');
		d.writeln('dt5.textContent = "対象ソースコード:";');
		d.writeln('dl.appendChild(dt5);');
		d.writeln('var dd5 = document.createElement("dd");');
		d.writeln('dd5.textContent = result_arr[i][4].toString();');
		d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');
		d.writeln('dl.appendChild(dd5);');
		d.writeln('var dt6 = document.createElement("dt");');
		d.writeln('dt6.textContent = "修正ソースコード:";');
		d.writeln('dl.appendChild(dt6);');
		d.writeln('var dd6 = document.createElement("dd");');
		d.writeln('dd6.textContent = result_arr[i][5].toString();');
		d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');
		d.writeln('dl.appendChild(dd6);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('});');
		d.writeln('}else{');
		d.writeln('alert("参照エラーです！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function mydecode(str){');
		d.writeln('str = str.replace(/&lt;/g,"<");');
		d.writeln('str = str.replace(/&gt;/g,">");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function chk_guideline(str){');
		d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');
		d.writeln('var arr = str.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function chk_technique(str){');
		d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');
		d.writeln('var arr = technique.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>判定結果参照<small>(V3)</small></h1>');
		d.writeln('<label for="">URL:</label>');
		d.writeln('<select id="page_id"></select><br>');
		d.writeln('<label for="all_text">JIS番号と実装番号：</label>');
		d.writeln('<select id="guideline_id" onchange="create_techs()"></select>');
		d.writeln('<select id="technique_id"></select>');
		d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');
		d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');
		d.writeln('<p id="desc"></p>');
		d.writeln('<dl id="results"></dl>');
		d.writeln('</body>');
		d.writeln('</html>');
		alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");
		var gdselect = d.getElementById("guideline_id");
		for(var i=0; i<guidelines.length; i++){
			var row = guidelines[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			gdselect.appendChild(opt);
		}
		var pageselect = d.getElementById("page_id");
		for(var i=0; i<urls.length; i++){
			var row = urls[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			pageselect.appendChild(opt);
		}
	}
	function get_pageid(){
	  var urlval = "";
	  var pageid = "";
	  var element=document.getElementById("urlList");
	     for(var i=0;i<element.options.length;i++){
			if(element.options[i].selected){
				urlval=element.options[i].text;
				break;
			}
	     }
	     var pageidpat = new RegExp(/(\[)(.*?)(\])/);
	     var arr = urlval.match(pageidpat);
	     if(arr!=null){
	       pageid = arr[2].toString();
	 	  }
	 	  return pageid;
	}
	function get_projectid(){
		var projectid = "";
		var crturl = window.location.href;
		var prjpat = new RegExp(/projID\/([0-9]*)/);
		var arr = crturl.match(prjpat);
		if(arr!=null){
			projectid = arr[1].toString();
		}
		return projectid;
	}
	function create_pageid_arr(){
		var arr = new Array();
		var urlselect = document.getElementById("urlList");
		for(var i=0; i<urlselect.options.length; i++){
			var urlalltext = urlselect.options[i].text;
			var pageid_pat = new RegExp(/\[(.+?)\]/);
			var pageid_arr = urlalltext.match(pageid_pat);
			var pageidtext = "";
			if(pageid_arr!==null){
				pageidtext = pageid_arr[1].toString();
			}
			arr.push(pageidtext);
		}
		return arr;
	}
})();

javascript:(function(){var projectid = get_projectid();var urls = create_pageid_arr();var guidelines = ["7.1.1.1","7.1.2.1","7.1.2.2","7.1.2.3","7.1.2.4","7.1.2.5","7.1.3.1","7.1.3.2","7.1.3.3","7.1.4.1","7.1.4.2","7.1.4.3","7.1.4.4","7.1.4.5","7.2.1.1","7.2.1.2","7.2.2.1","7.2.2.2","7.2.3.1","7.2.4.1","7.2.4.2","7.2.4.3","7.2.4.4","7.2.4.5","7.2.4.6","7.2.4.7","7.3.1.1","7.3.1.2","7.3.2.1","7.3.2.2","7.3.2.3","7.3.2.4","7.3.3.1","7.3.3.2","7.3.3.3","7.3.3.4","7.4.1.1","7.4.1.2"];trgr(projectid, urls, guidelines);function trgr(projectid, urls, guidelines){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>判定結果参照(V3)</title>');d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('#desc,label {font-size: 90%;}');d.writeln('#technique_id{width:80px;}');d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');d.writeln('#all_text {width: 160px;}');d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');d.writeln('#results dt {font-weight: bold;}');d.writeln('#results dd {margin: -1.5em 0 3px 11em;}');d.writeln('.first{margin-top: 25px;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('var techs = {');d.writeln('"7.1.1.1": "H37,H24,G94,H2,H30,IFC2016,IFC1022,H44,H65,G68,G100,IFC1002,H67,C9",');d.writeln('"7.1.2.1": "G158,IFC1003",');d.writeln('"7.1.2.2": "IFC1004",');d.writeln('"7.1.2.3": "IFC1005",');d.writeln('"7.1.2.4": "IFC2007,IFC2008",');d.writeln('"7.1.2.5": "IFC1023",');d.writeln('"7.1.3.1": "IFC2001,G117,G140,G138,H51,IFC1036,H44,H65,H71,H85,H48,H42,SCR21,IFC2005",');d.writeln('"7.1.3.2": "IFC1006,C8",');d.writeln('"7.1.3.3": "G96",');d.writeln('"7.1.4.1": "IFC2006,IFC1037,IFC1038",');d.writeln('"7.1.4.2": "IFC1007",');d.writeln('"7.1.4.3": "G18,G148,G174,G145",');d.writeln('"7.1.4.4": "G142,IFC1025,IFC1026,G178,G179",');d.writeln('"7.1.4.5": "C22,C30,G140",');d.writeln('"7.2.1.1": "IFC1008",');d.writeln('"7.2.1.2": "G21",');d.writeln('"7.2.2.1": "G133,IFC2026,G198,G180,IFC1009,IFC2015",');d.writeln('"7.2.2.2": "IFC1039",');d.writeln('"7.2.3.1": "IFC1011",');d.writeln('"7.2.4.1": "IFC1040,H69,H50,SCR28",');d.writeln('"7.2.4.2": "IFC1013",');d.writeln('"7.2.4.3": "IFC1014,IFC1041",');d.writeln('"7.2.4.4": "IFC1015,H24,G53,H77,H78,H79,H80,H81,C7",');d.writeln('"7.2.4.5": "G125,G64,G63,G161,G126,G185",');d.writeln('"7.2.4.6": "G130,G131",');d.writeln('"7.2.4.7": "IFC1042",');d.writeln('"7.3.1.1": "H57",');d.writeln('"7.3.1.2": "H58",');d.writeln('"7.3.2.1": "G107",');d.writeln('"7.3.2.2": "IFC1016",');d.writeln('"7.3.2.3": "G61",');d.writeln('"7.3.2.4": "G197",');d.writeln('"7.3.3.1": "IFC2025,IFC1018",');d.writeln('"7.3.3.2": "G89,G184,G162,G83,H44,H65,H71,G167",');d.writeln('"7.3.3.3": "G83,IFC2017",');d.writeln('"7.3.3.4": "IFC2019,IFC2020,IFC2021",');d.writeln('"7.4.1.1": "IFC1019",');d.writeln('"7.4.1.2": "IFC1020,IFC1021,SCR21",');d.writeln('};');d.writeln('function create_techs(){');d.writeln('var select = document.getElementById("technique_id");');d.writeln('select.innerHTML = "";');d.writeln('var src = document.getElementById("guideline_id");');d.writeln('var guideline_id = src.options[src.selectedIndex].text;');d.writeln('var tmp = new Array();');d.writeln('for(var key in techs){');d.writeln('if(key == guideline_id){');d.writeln('var val = techs[key].toString();');d.writeln('tmp = val.split(",");');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('for(var i=0; i < tmp.length; i++){');d.writeln('var elm = document.createElement("option");');d.writeln('elm.setAttribute("value", tmp[i].toString());');d.writeln('elm.textContent = tmp[i].toString();');d.writeln('select.appendChild(elm);');d.writeln('}');d.writeln('}');d.writeln('var pageid = "";');d.writeln('var guideline = "";');d.writeln('var technique = "";');d.writeln('var result_arr = new Array();');d.writeln('function browseSurvey() {');d.writeln('var pageid_src = document.getElementById("page_id");');d.writeln('var guideline_src = document.getElementById("guideline_id");');d.writeln('var technique_src = document.getElementById("technique_id");');d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');d.writeln('pageid = pageid_src.options[pageid_src.selectedIndex].text;');d.writeln('technique = technique_src.options[technique_src.selectedIndex].text;');d.writeln('var projectid = document.getElementById("hdn_projectid").value;');d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');d.writeln('data = {');d.writeln('projID: projectid,');d.writeln('controlID: pageid,');d.writeln('guideline: guideline,');d.writeln('technique: technique');d.writeln('};');d.writeln('$.ajax({');d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');d.writeln('type: "POST",');d.writeln('data: data,');d.writeln('dataType: "html",');d.writeln('error: function(data){');d.writeln('alert("取得エラー");');d.writeln('},');d.writeln('success: function(data) {');d.writeln('var result_arr = new Array();');d.writeln('var myobj = eval("("+data+")");');d.writeln('var result_text = "";');d.writeln('var pass_cnt = 0;');d.writeln('var check_cnt = 0;');d.writeln('var fail_cnt = 0;');d.writeln('var na_cnt = 0;');d.writeln('for(var i=0; i< myobj.length; i++){');d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');d.writeln('var comments = myobj[i]["comments2"];');d.writeln('var description = myobj[i]["description2"];');d.writeln('var srccode = myobj[i]["srccode2"];');d.writeln('var result = myobj[i]["result"];');d.writeln('switch(result){');d.writeln('case "PASS":');d.writeln('case "PASS_HC":');d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');d.writeln('pass_cnt += 1;');d.writeln('break;');d.writeln('case "CHECK":');d.writeln('result = "未";');d.writeln('check_cnt += 1;');d.writeln('break;');d.writeln('case "FAIL_HC":');d.writeln('case "FAIL_AC":');d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');d.writeln('fail_cnt += 1;');d.writeln('break;');d.writeln('case "NA_HC":');d.writeln('result = "非適用";');d.writeln('na_cnt;');d.writeln('break;');d.writeln('}');d.writeln('var cnt = result_arr.length;');d.writeln('result_arr[cnt] = new Array();');d.writeln('result_text += id + "\\n";');d.writeln('result_arr[cnt].push(id);');d.writeln('result_text += "検査員: " + user + "\\n";');d.writeln('result_arr[cnt].push(user);');d.writeln('result_text += "判定: " + result + "\\n";');d.writeln('result_arr[cnt].push(result);');d.writeln('result_text += "コメント:\\n" + comments + "\\n";');d.writeln('result_arr[cnt].push(comments);');d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');d.writeln('result_arr[cnt].push(mydecode(description));');d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');d.writeln('result_arr[cnt].push(mydecode(srccode));');d.writeln('}');d.writeln('var pr = document.getElementById("desc");');d.writeln('var pr_text = "";');d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');d.writeln('pr.innerHTML = pr_text;');d.writeln('var dl = document.getElementById("results");');d.writeln('dl.innerHTML = "";');d.writeln('for(var i=0; i<result_arr.length; i++){');d.writeln('var dt1 = document.createElement("dt");');d.writeln('dt1.setAttribute("class", "first");');d.writeln('dt1.textContent = "ID:";');d.writeln('dl.appendChild(dt1);');d.writeln('var dd1 = document.createElement("dd");');d.writeln('dd1.textContent = result_arr[i][0].toString();');d.writeln('dl.appendChild(dd1);');d.writeln('var dt2 = document.createElement("dt");');d.writeln('dt2.textContent = "検査員:";');d.writeln('dl.appendChild(dt2);');d.writeln('var dd2 = document.createElement("dd");');d.writeln('dd2.textContent = result_arr[i][1].toString();');d.writeln('dl.appendChild(dd2);');d.writeln('var dt3 = document.createElement("dt");');d.writeln('dt3.textContent = "判定結果:";');d.writeln('dl.appendChild(dt3);');d.writeln('var dd3 = document.createElement("dd");');d.writeln('dd3.textContent = result_arr[i][2].toString();');d.writeln('dl.appendChild(dd3);');d.writeln('var dt4 = document.createElement("dt");');d.writeln('dt4.textContent = "判定コメント:";');d.writeln('dl.appendChild(dt4);');d.writeln('var dd4 = document.createElement("dd");');d.writeln('dd4.textContent = result_arr[i][3].toString();');d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');d.writeln('dl.appendChild(dd4);');d.writeln('var dt5 = document.createElement("dt");');d.writeln('dt5.textContent = "対象ソースコード:";');d.writeln('dl.appendChild(dt5);');d.writeln('var dd5 = document.createElement("dd");');d.writeln('dd5.textContent = result_arr[i][4].toString();');d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');d.writeln('dl.appendChild(dd5);');d.writeln('var dt6 = document.createElement("dt");');d.writeln('dt6.textContent = "修正ソースコード:";');d.writeln('dl.appendChild(dt6);');d.writeln('var dd6 = document.createElement("dd");');d.writeln('dd6.textContent = result_arr[i][5].toString();');d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');d.writeln('dl.appendChild(dd6);');d.writeln('}');d.writeln('}');d.writeln('});');d.writeln('}else{');d.writeln('alert("参照エラーです！");');d.writeln('}');d.writeln('}');d.writeln('function mydecode(str){');d.writeln('str = str.replace(/&lt;/g,"<");');d.writeln('str = str.replace(/&gt;/g,">");');d.writeln('return str;');d.writeln('}');d.writeln('function chk_guideline(str){');d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');d.writeln('var arr = str.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('function chk_technique(str){');d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');d.writeln('var arr = technique.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('</script>');d.writeln('<h1>判定結果参照<small>(V3)</small></h1>');d.writeln('<label for="">URL:</label>');d.writeln('<select id="page_id"></select><br>');d.writeln('<label for="all_text">JIS番号と実装番号：</label>');d.writeln('<select id="guideline_id" onchange="create_techs()"></select>');d.writeln('<select id="technique_id"></select>');d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');d.writeln('<p id="desc"></p>');d.writeln('<dl id="results"></dl>');d.writeln('</body>');d.writeln('</html>');alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");var gdselect = d.getElementById("guideline_id");for(var i=0; i<guidelines.length; i++){var row = guidelines[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;gdselect.appendChild(opt);}var pageselect = d.getElementById("page_id");for(var i=0; i<urls.length; i++){var row = urls[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;pageselect.appendChild(opt);}}function get_pageid(){var urlval = "";var pageid = "";var element=document.getElementById("urlList");for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var pageidpat = new RegExp(/(\[)(.*?)(\])/);var arr = urlval.match(pageidpat);if(arr!=null){pageid = arr[2].toString();}return pageid;}function get_projectid(){var projectid = "";var crturl = window.location.href;var prjpat = new RegExp(/projID\/([0-9]*)/);var arr = crturl.match(prjpat);if(arr!=null){projectid = arr[1].toString();}return projectid;}function create_pageid_arr(){var arr = new Array();var urlselect = document.getElementById("urlList");for(var i=0; i<urlselect.options.length; i++){var urlalltext = urlselect.options[i].text;var pageid_pat = new RegExp(/\[(.+?)\]/);var pageid_arr = urlalltext.match(pageid_pat);var pageidtext = "";if(pageid_arr!==null){pageidtext = pageid_arr[1].toString();}arr.push(pageidtext);}return arr;}})();


//V5(最新版)
javascript:(function(){
	var projectid = get_projectid();
	var urls = create_pageid_arr();
	var guidelines = [
		"7.1.1.1",
		"7.1.2.1",
		"7.1.2.2",
		"7.1.2.3",
		"7.1.2.4",
		"7.1.2.5",
		"7.1.3.1",
		"7.1.3.2",
		"7.1.3.3",
		"7.1.4.1",
		"7.1.4.2",
		"7.1.4.3",
		"7.1.4.4",
		"7.1.4.5",
		"7.2.1.1",
		"7.2.1.2",
		"7.2.2.1",
		"7.2.2.2",
		"7.2.3.1",
		"7.2.4.1",
		"7.2.4.2",
		"7.2.4.3",
		"7.2.4.4",
		"7.2.4.5",
		"7.2.4.6",
		"7.2.4.7",
		"7.3.1.1",
		"7.3.1.2",
		"7.3.2.1",
		"7.3.2.2",
		"7.3.2.3",
		"7.3.2.4",
		"7.3.3.1",
		"7.3.3.2",
		"7.3.3.3",
		"7.3.3.4",
		"7.4.1.1",
		"7.4.1.2"
	];
	trgr(projectid, urls, guidelines);
	function trgr(projectid, urls, guidelines){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>判定結果参照(V3)</title>');
		d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('#desc,label {font-size: 90%;}');
		d.writeln('#technique_id{width:80px;}');
		d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');
		d.writeln('#all_text {width: 160px;}');
		d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');
		d.writeln('#results dt {font-weight: bold;}');
		d.writeln('#results dd {margin: -1.5em 0 3px 11em;}');
		d.writeln('.first{margin-top: 25px;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('var techs = {');
		d.writeln('"7.1.1.1": "H37,H24,G94,H2,H30,IFC2016,IFC1022,H44,H65,G68,G100,IFC1002,H67,C9",');
		d.writeln('"7.1.2.1": "G158,IFC1003",');
		d.writeln('"7.1.2.2": "IFC1004",');
		d.writeln('"7.1.2.3": "IFC1005",');
		d.writeln('"7.1.2.4": "IFC2007,IFC2008",');
		d.writeln('"7.1.2.5": "IFC1023",');
		d.writeln('"7.1.3.1": "IFC2001,G117,G140,G138,H51,IFC1036,H44,H65,H71,H85,H48,H42,SCR21,IFC2005",');
		d.writeln('"7.1.3.2": "IFC1006,C8",');
		d.writeln('"7.1.3.3": "G96",');
		d.writeln('"7.1.4.1": "IFC2006,IFC1037,IFC1038",');
		d.writeln('"7.1.4.2": "IFC1007",');
		d.writeln('"7.1.4.3": "G18,G148,G174,G145",');
		d.writeln('"7.1.4.4": "G142,IFC1025,IFC1026,G178,G179",');
		d.writeln('"7.1.4.5": "C22,C30,G140",');
		d.writeln('"7.2.1.1": "IFC1008",');
		d.writeln('"7.2.1.2": "G21",');
		d.writeln('"7.2.2.1": "G133,IFC2026,G198,G180,IFC1009,IFC2015",');
		d.writeln('"7.2.2.2": "IFC1039",');
		d.writeln('"7.2.3.1": "IFC1011",');
		d.writeln('"7.2.4.1": "IFC1040,H69,H50,SCR28",');
		d.writeln('"7.2.4.2": "IFC1013",');
		d.writeln('"7.2.4.3": "IFC1014,IFC1041",');
		d.writeln('"7.2.4.4": "IFC1015,H24,G53,H77,H78,H79,H80,H81,C7",');
		d.writeln('"7.2.4.5": "G125,G64,G63,G161,G126,G185",');
		d.writeln('"7.2.4.6": "G130,G131",');
		d.writeln('"7.2.4.7": "IFC1042",');
		d.writeln('"7.3.1.1": "H57",');
		d.writeln('"7.3.1.2": "H58",');
		d.writeln('"7.3.2.1": "G107",');
		d.writeln('"7.3.2.2": "IFC1016",');
		d.writeln('"7.3.2.3": "G61",');
		d.writeln('"7.3.2.4": "G197",');
		d.writeln('"7.3.3.1": "IFC2025,IFC1018",');
		d.writeln('"7.3.3.2": "G89,G184,G162,G83,H44,H65,H71,G167",');
		d.writeln('"7.3.3.3": "G83,IFC2017",');
		d.writeln('"7.3.3.4": "IFC2019,IFC2020,IFC2021",');
		d.writeln('"7.4.1.1": "IFC1019",');
		d.writeln('"7.4.1.2": "IFC1020,IFC1021,SCR21",');
		d.writeln('};');
		d.writeln('function create_techs(){');
		d.writeln('var select = document.getElementById("technique_id");');
		d.writeln('select.innerHTML = "";');
		d.writeln('var src = document.getElementById("guideline_id");');
		d.writeln('var guideline_id = src.options[src.selectedIndex].text;');
		d.writeln('var tmp = new Array();');
		d.writeln('for(var key in techs){');
		d.writeln('if(key == guideline_id){');
		d.writeln('var val = techs[key].toString();');
		d.writeln('tmp = val.split(",");');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('for(var i=0; i < tmp.length; i++){');
		d.writeln('var elm = document.createElement("option");');
		d.writeln('elm.setAttribute("value", tmp[i].toString());');
		d.writeln('elm.textContent = tmp[i].toString();');
		d.writeln('select.appendChild(elm);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('var pageid = "";');
		d.writeln('var guideline = "";');
		d.writeln('var technique = "";');
		d.writeln('var result_arr = new Array();');
		d.writeln('function browseSurvey() {');
		d.writeln('var pageid_src = document.getElementById("page_id");');
		d.writeln('var guideline_src = document.getElementById("guideline_id");');
		d.writeln('var technique_src = document.getElementById("technique_id");');
		d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');
		d.writeln('pageid = pageid_src.options[pageid_src.selectedIndex].text;');
		d.writeln('technique = technique_src.options[technique_src.selectedIndex].text;');
		d.writeln('var projectid = document.getElementById("hdn_projectid").value;');
		d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');
		d.writeln('data = {');
		d.writeln('projID: projectid,');
		d.writeln('controlID: pageid,');
		d.writeln('guideline: guideline,');
		d.writeln('technique: technique');
		d.writeln('};');
		d.writeln('$.ajax({');
		d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');
		d.writeln('type: "POST",');
		d.writeln('data: data,');
		d.writeln('dataType: "html",');
		d.writeln('error: function(data){');
		d.writeln('alert("取得エラー");');
		d.writeln('},');
		d.writeln('success: function(data) {');
		d.writeln('var result_arr = new Array();');
		d.writeln('var myobj = eval("("+data+")");');
		d.writeln('var result_text = "";');
		d.writeln('var pass_cnt = 0;');
		d.writeln('var check_cnt = 0;');
		d.writeln('var fail_cnt = 0;');
		d.writeln('var na_cnt = 0;');
		d.writeln('for(var i=0; i< myobj.length; i++){');
		d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');
		d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');
		d.writeln('var comments = myobj[i]["comments2"];');
		d.writeln('var description = myobj[i]["description2"];');
		d.writeln('var srccode = myobj[i]["srccode2"];');
		d.writeln('var result = myobj[i]["result"];');
		d.writeln('switch(result){');
		d.writeln('case "PASS":');
		d.writeln('case "PASS_HC":');
		d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');
		d.writeln('pass_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "CHECK":');
		d.writeln('result = "未";');
		d.writeln('check_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "FAIL_HC":');
		d.writeln('case "FAIL_AC":');
		d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');
		d.writeln('fail_cnt += 1;');
		d.writeln('break;');
		d.writeln('case "NA_HC":');
		d.writeln('result = "非適用";');
		d.writeln('na_cnt;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('var cnt = result_arr.length;');
		d.writeln('result_arr[cnt] = new Array();');
		d.writeln('result_text += id + "\\n";');
		d.writeln('result_arr[cnt].push(id);');
		d.writeln('result_text += "検査員: " + user + "\\n";');
		d.writeln('result_arr[cnt].push(user);');
		d.writeln('result_text += "判定: " + result + "\\n";');
		d.writeln('result_arr[cnt].push(result);');
		d.writeln('result_text += "コメント:\\n" + comments + "\\n";');
		d.writeln('result_arr[cnt].push(comments);');
		d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');
		d.writeln('result_arr[cnt].push(mydecode(description));');
		d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');
		d.writeln('result_arr[cnt].push(mydecode(srccode));');
		d.writeln('}');
		d.writeln('var pr = document.getElementById("desc");');
		d.writeln('var pr_text = "";');
		d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');
		d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');
		d.writeln('pr.innerHTML = pr_text;');
		d.writeln('var dl = document.getElementById("results");');
		d.writeln('dl.innerHTML = "";');
		d.writeln('for(var i=0; i<result_arr.length; i++){');
		d.writeln('if(get_radio_val() == "failonly" && result_arr[i][2].toString() != "不適合") continue;');
		d.writeln('if(get_radio_val() == "okonly" && result_arr[i][2].toString() != "適合") continue;');
		d.writeln('var dt1 = document.createElement("dt");');
		d.writeln('dt1.setAttribute("class", "first");');
		d.writeln('dt1.textContent = "ID:";');
		d.writeln('dl.appendChild(dt1);');
		d.writeln('var dd1 = document.createElement("dd");');
		d.writeln('dd1.textContent = result_arr[i][0].toString();');
		d.writeln('dl.appendChild(dd1);');
		d.writeln('var dt2 = document.createElement("dt");');
		d.writeln('dt2.textContent = "検査員:";');
		d.writeln('dl.appendChild(dt2);');
		d.writeln('var dd2 = document.createElement("dd");');
		d.writeln('dd2.textContent = result_arr[i][1].toString();');
		d.writeln('dl.appendChild(dd2);');
		d.writeln('var dt3 = document.createElement("dt");');
		d.writeln('dt3.textContent = "判定結果:";');
		d.writeln('dl.appendChild(dt3);');
		d.writeln('var dd3 = document.createElement("dd");');
		d.writeln('dd3.textContent = result_arr[i][2].toString();');
		d.writeln('dl.appendChild(dd3);');
		d.writeln('var dt4 = document.createElement("dt");');
		d.writeln('dt4.textContent = "判定コメント:";');
		d.writeln('dl.appendChild(dt4);');
		d.writeln('var dd4 = document.createElement("dd");');
		d.writeln('dd4.textContent = result_arr[i][3].toString();');
		d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');
		d.writeln('dl.appendChild(dd4);');
		d.writeln('var dt5 = document.createElement("dt");');
		d.writeln('dt5.textContent = "対象ソースコード:";');
		d.writeln('dl.appendChild(dt5);');
		d.writeln('var dd5 = document.createElement("dd");');
		d.writeln('dd5.textContent = result_arr[i][4].toString();');
		d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');
		d.writeln('dl.appendChild(dd5);');
		d.writeln('var dt6 = document.createElement("dt");');
		d.writeln('dt6.textContent = "修正ソースコード:";');
		d.writeln('dl.appendChild(dt6);');
		d.writeln('var dd6 = document.createElement("dd");');
		d.writeln('dd6.textContent = result_arr[i][5].toString();');
		d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');
		d.writeln('dl.appendChild(dd6);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('});');
		d.writeln('}else{');
		d.writeln('alert("参照エラーです！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function mydecode(str){');
		d.writeln('str = str.replace(/&lt;/g,"<");');
		d.writeln('str = str.replace(/&gt;/g,">");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function chk_guideline(str){');
		d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');
		d.writeln('var arr = str.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function chk_technique(str){');
		d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');
		d.writeln('var arr = technique.match(pat);');
		d.writeln('if(arr!=null){');
		d.writeln('return true;');
		d.writeln('}else{');
		d.writeln('return false;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function get_radio_val(){');
		d.writeln('var ret = "";');
		d.writeln('var arr = document.getElementsByName("filter");');
		d.writeln('for(var i=0; i<arr.length; i++){');
		d.writeln('if(arr[i].checked){');
		d.writeln('ret = arr[i].value;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('return ret;');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>判定結果参照<small>(V4)</small></h1>');
		d.writeln('<label for="">URL:</label>');
		d.writeln('<select id="page_id"></select><br>');
		d.writeln('<label for="all_text">JIS番号と実装番号：</label>');
		d.writeln('<select id="guideline_id" onchange="create_techs()"></select>');
		d.writeln('<select id="technique_id"></select>');
		d.writeln('<label><input type="radio" id="all" name="filter" value="all" checked="checked">全件</label>');
		d.writeln('<label><input type="radio" id="failonly" name="filter" value="failonly">不適合のみ</label>');
		d.writeln('<label><input type="radio" id="okonly" name="filter" value="okonly">適合のみ</label>');
		d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');
		d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');
		d.writeln('<p id="desc"></p>');
		d.writeln('<dl id="results"></dl>');
		d.writeln('</body>');
		d.writeln('</html>');
		alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");
		var gdselect = d.getElementById("guideline_id");
		for(var i=0; i<guidelines.length; i++){
			var row = guidelines[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			gdselect.appendChild(opt);
		}
		var pageselect = d.getElementById("page_id");
		for(var i=0; i<urls.length; i++){
			var row = urls[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			pageselect.appendChild(opt);
		}
	}
	function get_pageid(){
	  var urlval = "";
	  var pageid = "";
	  var element=document.getElementById("urlList");
	     for(var i=0;i<element.options.length;i++){
			if(element.options[i].selected){
				urlval=element.options[i].text;
				break;
			}
	     }
	     var pageidpat = new RegExp(/(\[)(.*?)(\])/);
	     var arr = urlval.match(pageidpat);
	     if(arr!=null){
	       pageid = arr[2].toString();
	 	  }
	 	  return pageid;
	}
	function get_projectid(){
		var projectid = "";
		var crturl = window.location.href;
		var prjpat = new RegExp(/projID\/([0-9]*)/);
		var arr = crturl.match(prjpat);
		if(arr!=null){
			projectid = arr[1].toString();
		}
		return projectid;
	}
	function create_pageid_arr(){
		var arr = new Array();
		var urlselect = document.getElementById("urlList");
		for(var i=0; i<urlselect.options.length; i++){
			var urlalltext = urlselect.options[i].text;
			var pageid_pat = new RegExp(/\[(.+?)\]/);
			var pageid_arr = urlalltext.match(pageid_pat);
			var pageidtext = "";
			if(pageid_arr!==null){
				pageidtext = pageid_arr[1].toString();
			}
			arr.push(pageidtext);
		}
		return arr;
	}
})();

javascript:(function(){var projectid = get_projectid();var urls = create_pageid_arr();var guidelines = ["7.1.1.1","7.1.2.1","7.1.2.2","7.1.2.3","7.1.2.4","7.1.2.5","7.1.3.1","7.1.3.2","7.1.3.3","7.1.4.1","7.1.4.2","7.1.4.3","7.1.4.4","7.1.4.5","7.2.1.1","7.2.1.2","7.2.2.1","7.2.2.2","7.2.3.1","7.2.4.1","7.2.4.2","7.2.4.3","7.2.4.4","7.2.4.5","7.2.4.6","7.2.4.7","7.3.1.1","7.3.1.2","7.3.2.1","7.3.2.2","7.3.2.3","7.3.2.4","7.3.3.1","7.3.3.2","7.3.3.3","7.3.3.4","7.4.1.1","7.4.1.2"];trgr(projectid, urls, guidelines);function trgr(projectid, urls, guidelines){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>判定結果参照(V3)</title>');d.writeln('<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('#desc,label {font-size: 90%;}');d.writeln('#technique_id{width:80px;}');d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');d.writeln('#all_text {width: 160px;}');d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');d.writeln('#results dt {font-weight: bold;}');d.writeln('#results dd {margin: -1.5em 0 3px 11em;}');d.writeln('.first{margin-top: 25px;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('var techs = {');d.writeln('"7.1.1.1": "H37,H24,G94,H2,H30,IFC2016,IFC1022,H44,H65,G68,G100,IFC1002,H67,C9",');d.writeln('"7.1.2.1": "G158,IFC1003",');d.writeln('"7.1.2.2": "IFC1004",');d.writeln('"7.1.2.3": "IFC1005",');d.writeln('"7.1.2.4": "IFC2007,IFC2008",');d.writeln('"7.1.2.5": "IFC1023",');d.writeln('"7.1.3.1": "IFC2001,G117,G140,G138,H51,IFC1036,H44,H65,H71,H85,H48,H42,SCR21,IFC2005",');d.writeln('"7.1.3.2": "IFC1006,C8",');d.writeln('"7.1.3.3": "G96",');d.writeln('"7.1.4.1": "IFC2006,IFC1037,IFC1038",');d.writeln('"7.1.4.2": "IFC1007",');d.writeln('"7.1.4.3": "G18,G148,G174,G145",');d.writeln('"7.1.4.4": "G142,IFC1025,IFC1026,G178,G179",');d.writeln('"7.1.4.5": "C22,C30,G140",');d.writeln('"7.2.1.1": "IFC1008",');d.writeln('"7.2.1.2": "G21",');d.writeln('"7.2.2.1": "G133,IFC2026,G198,G180,IFC1009,IFC2015",');d.writeln('"7.2.2.2": "IFC1039",');d.writeln('"7.2.3.1": "IFC1011",');d.writeln('"7.2.4.1": "IFC1040,H69,H50,SCR28",');d.writeln('"7.2.4.2": "IFC1013",');d.writeln('"7.2.4.3": "IFC1014,IFC1041",');d.writeln('"7.2.4.4": "IFC1015,H24,G53,H77,H78,H79,H80,H81,C7",');d.writeln('"7.2.4.5": "G125,G64,G63,G161,G126,G185",');d.writeln('"7.2.4.6": "G130,G131",');d.writeln('"7.2.4.7": "IFC1042",');d.writeln('"7.3.1.1": "H57",');d.writeln('"7.3.1.2": "H58",');d.writeln('"7.3.2.1": "G107",');d.writeln('"7.3.2.2": "IFC1016",');d.writeln('"7.3.2.3": "G61",');d.writeln('"7.3.2.4": "G197",');d.writeln('"7.3.3.1": "IFC2025,IFC1018",');d.writeln('"7.3.3.2": "G89,G184,G162,G83,H44,H65,H71,G167",');d.writeln('"7.3.3.3": "G83,IFC2017",');d.writeln('"7.3.3.4": "IFC2019,IFC2020,IFC2021",');d.writeln('"7.4.1.1": "IFC1019",');d.writeln('"7.4.1.2": "IFC1020,IFC1021,SCR21",');d.writeln('};');d.writeln('function create_techs(){');d.writeln('var select = document.getElementById("technique_id");');d.writeln('select.innerHTML = "";');d.writeln('var src = document.getElementById("guideline_id");');d.writeln('var guideline_id = src.options[src.selectedIndex].text;');d.writeln('var tmp = new Array();');d.writeln('for(var key in techs){');d.writeln('if(key == guideline_id){');d.writeln('var val = techs[key].toString();');d.writeln('tmp = val.split(",");');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('for(var i=0; i < tmp.length; i++){');d.writeln('var elm = document.createElement("option");');d.writeln('elm.setAttribute("value", tmp[i].toString());');d.writeln('elm.textContent = tmp[i].toString();');d.writeln('select.appendChild(elm);');d.writeln('}');d.writeln('}');d.writeln('var pageid = "";');d.writeln('var guideline = "";');d.writeln('var technique = "";');d.writeln('var result_arr = new Array();');d.writeln('function browseSurvey() {');d.writeln('var pageid_src = document.getElementById("page_id");');d.writeln('var guideline_src = document.getElementById("guideline_id");');d.writeln('var technique_src = document.getElementById("technique_id");');d.writeln('guideline = guideline_src.options[guideline_src.selectedIndex].text;');d.writeln('pageid = pageid_src.options[pageid_src.selectedIndex].text;');d.writeln('technique = technique_src.options[technique_src.selectedIndex].text;');d.writeln('var projectid = document.getElementById("hdn_projectid").value;');d.writeln('if(projectid!="" && pageid!="" && guideline!="" && technique!=""){');d.writeln('data = {');d.writeln('projID: projectid,');d.writeln('controlID: pageid,');d.writeln('guideline: guideline,');d.writeln('technique: technique');d.writeln('};');d.writeln('$.ajax({');d.writeln('url: "/diagnose/indexv2/getResultsByTechnique/",');d.writeln('type: "POST",');d.writeln('data: data,');d.writeln('dataType: "html",');d.writeln('error: function(data){');d.writeln('alert("取得エラー");');d.writeln('},');d.writeln('success: function(data) {');d.writeln('var result_arr = new Array();');d.writeln('var myobj = eval("("+data+")");');d.writeln('var result_text = "";');d.writeln('var pass_cnt = 0;');d.writeln('var check_cnt = 0;');d.writeln('var fail_cnt = 0;');d.writeln('var na_cnt = 0;');d.writeln('for(var i=0; i< myobj.length; i++){');d.writeln('var id = pageid+"_"+guideline+"_"+technique+"_"+i;');d.writeln('var user = (myobj[i]["userid"]==null)? "PRG診断":myobj[i]["name"];');d.writeln('var comments = myobj[i]["comments2"];');d.writeln('var description = myobj[i]["description2"];');d.writeln('var srccode = myobj[i]["srccode2"];');d.writeln('var result = myobj[i]["result"];');d.writeln('switch(result){');d.writeln('case "PASS":');d.writeln('case "PASS_HC":');d.writeln('result = (myobj[i]["note"]=="1")? "適合(注記)":"適合";');d.writeln('pass_cnt += 1;');d.writeln('break;');d.writeln('case "CHECK":');d.writeln('result = "未";');d.writeln('check_cnt += 1;');d.writeln('break;');d.writeln('case "FAIL_HC":');d.writeln('case "FAIL_AC":');d.writeln('result = (myobj[i]["rejudgement"]=="1")? "不適合(要再判定)":"不適合";');d.writeln('fail_cnt += 1;');d.writeln('break;');d.writeln('case "NA_HC":');d.writeln('result = "非適用";');d.writeln('na_cnt;');d.writeln('break;');d.writeln('}');d.writeln('var cnt = result_arr.length;');d.writeln('result_arr[cnt] = new Array();');d.writeln('result_text += id + "\\n";');d.writeln('result_arr[cnt].push(id);');d.writeln('result_text += "検査員: " + user + "\\n";');d.writeln('result_arr[cnt].push(user);');d.writeln('result_text += "判定: " + result + "\\n";');d.writeln('result_arr[cnt].push(result);');d.writeln('result_text += "コメント:\\n" + comments + "\\n";');d.writeln('result_arr[cnt].push(comments);');d.writeln('result_text += "対象ソース:\\n" + mydecode(description) + "\\n";');d.writeln('result_arr[cnt].push(mydecode(description));');d.writeln('result_text += "修正ソース:\\n" + mydecode(srccode) + "\\n\\n";');d.writeln('result_arr[cnt].push(mydecode(srccode));');d.writeln('}');d.writeln('var pr = document.getElementById("desc");');d.writeln('var pr_text = "";');d.writeln('pr_text += "<strong>JIS番号:</strong> " + guideline+"  <strong>実装番号:</strong> " + technique + "&nbsp;&nbsp;&nbsp;&nbsp;";');d.writeln('pr_text += "<strong>適合:</strong>"+pass_cnt+" <strong>不適合:</strong>"+fail_cnt+" <strong>非適用:</strong>"+na_cnt+" <strong>未:</strong>"+check_cnt;');d.writeln('pr.innerHTML = pr_text;');d.writeln('var dl = document.getElementById("results");');d.writeln('dl.innerHTML = "";');d.writeln('for(var i=0; i<result_arr.length; i++){');d.writeln('if(get_radio_val() == "failonly" && result_arr[i][2].toString() != "不適合") continue;');d.writeln('if(get_radio_val() == "okonly" && result_arr[i][2].toString() != "適合") continue;');d.writeln('var dt1 = document.createElement("dt");');d.writeln('dt1.setAttribute("class", "first");');d.writeln('dt1.textContent = "ID:";');d.writeln('dl.appendChild(dt1);');d.writeln('var dd1 = document.createElement("dd");');d.writeln('dd1.textContent = result_arr[i][0].toString();');d.writeln('dl.appendChild(dd1);');d.writeln('var dt2 = document.createElement("dt");');d.writeln('dt2.textContent = "検査員:";');d.writeln('dl.appendChild(dt2);');d.writeln('var dd2 = document.createElement("dd");');d.writeln('dd2.textContent = result_arr[i][1].toString();');d.writeln('dl.appendChild(dd2);');d.writeln('var dt3 = document.createElement("dt");');d.writeln('dt3.textContent = "判定結果:";');d.writeln('dl.appendChild(dt3);');d.writeln('var dd3 = document.createElement("dd");');d.writeln('dd3.textContent = result_arr[i][2].toString();');d.writeln('dl.appendChild(dd3);');d.writeln('var dt4 = document.createElement("dt");');d.writeln('dt4.textContent = "判定コメント:";');d.writeln('dl.appendChild(dt4);');d.writeln('var dd4 = document.createElement("dd");');d.writeln('dd4.textContent = result_arr[i][3].toString();');d.writeln('if(result_arr[i][3].toString()=="") dd4.textContent = "なし";');d.writeln('dl.appendChild(dd4);');d.writeln('var dt5 = document.createElement("dt");');d.writeln('dt5.textContent = "対象ソースコード:";');d.writeln('dl.appendChild(dt5);');d.writeln('var dd5 = document.createElement("dd");');d.writeln('dd5.textContent = result_arr[i][4].toString();');d.writeln('if(result_arr[i][4].toString()=="") dd5.textContent = "なし";');d.writeln('dl.appendChild(dd5);');d.writeln('var dt6 = document.createElement("dt");');d.writeln('dt6.textContent = "修正ソースコード:";');d.writeln('dl.appendChild(dt6);');d.writeln('var dd6 = document.createElement("dd");');d.writeln('dd6.textContent = result_arr[i][5].toString();');d.writeln('if(result_arr[i][5].toString()=="") dd6.textContent = "なし";');d.writeln('dl.appendChild(dd6);');d.writeln('}');d.writeln('}');d.writeln('});');d.writeln('}else{');d.writeln('alert("参照エラーです！");');d.writeln('}');d.writeln('}');d.writeln('function mydecode(str){');d.writeln('str = str.replace(/&lt;/g,"<");');d.writeln('str = str.replace(/&gt;/g,">");');d.writeln('return str;');d.writeln('}');d.writeln('function chk_guideline(str){');d.writeln('var pat = new RegExp(/7\\.[1-4]\\.[0-9]\\.[0-9]/);');d.writeln('var arr = str.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('function chk_technique(str){');d.writeln('var pat = new RegExp(/[A-Z][0-9]*/);');d.writeln('var arr = technique.match(pat);');d.writeln('if(arr!=null){');d.writeln('return true;');d.writeln('}else{');d.writeln('return false;');d.writeln('}');d.writeln('}');d.writeln('function get_radio_val(){');d.writeln('var ret = "";');d.writeln('var arr = document.getElementsByName("filter");');d.writeln('for(var i=0; i<arr.length; i++){');d.writeln('if(arr[i].checked){');d.writeln('ret = arr[i].value;');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('return ret;');d.writeln('}');d.writeln('</script>');d.writeln('<h1>判定結果参照<small>(V4)</small></h1>');d.writeln('<label for="">URL:</label>');d.writeln('<select id="page_id"></select><br>');d.writeln('<label for="all_text">JIS番号と実装番号：</label>');d.writeln('<select id="guideline_id" onchange="create_techs()"></select>');d.writeln('<select id="technique_id"></select>');d.writeln('<label><input type="radio" id="all" name="filter" value="all" checked="checked">全件</label>');d.writeln('<label><input type="radio" id="failonly" name="filter" value="failonly">不適合のみ</label>');d.writeln('<label><input type="radio" id="okonly" name="filter" value="okonly">適合のみ</label>');d.writeln('<input type="hidden" id="hdn_projectid" value="' + projectid + '">');d.writeln('<button onclick="browseSurvey()">参照実行</button><br>');d.writeln('<p id="desc"></p>');d.writeln('<dl id="results"></dl>');d.writeln('</body>');d.writeln('</html>');alert(d.readyState+"..."+"数秒経ってからOKをクリックしてください");var gdselect = d.getElementById("guideline_id");for(var i=0; i<guidelines.length; i++){var row = guidelines[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;gdselect.appendChild(opt);}var pageselect = d.getElementById("page_id");for(var i=0; i<urls.length; i++){var row = urls[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;pageselect.appendChild(opt);}}function get_pageid(){var urlval = "";var pageid = "";var element=document.getElementById("urlList");for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var pageidpat = new RegExp(/(\[)(.*?)(\])/);var arr = urlval.match(pageidpat);if(arr!=null){pageid = arr[2].toString();}return pageid;}function get_projectid(){var projectid = "";var crturl = window.location.href;var prjpat = new RegExp(/projID\/([0-9]*)/);var arr = crturl.match(prjpat);if(arr!=null){projectid = arr[1].toString();}return projectid;}function create_pageid_arr(){var arr = new Array();var urlselect = document.getElementById("urlList");for(var i=0; i<urlselect.options.length; i++){var urlalltext = urlselect.options[i].text;var pageid_pat = new RegExp(/\[(.+?)\]/);var pageid_arr = urlalltext.match(pageid_pat);var pageidtext = "";if(pageid_arr!==null){pageidtext = pageid_arr[1].toString();}arr.push(pageidtext);}return arr;}})();


//検査内容参照
javascript:(function(){
	var guidelines = [
		"7.1.1.1",
		"7.1.2.1",
		"7.1.2.2",
		"7.1.2.3",
		"7.1.2.4",
		"7.1.2.5",
		"7.1.3.1",
		"7.1.3.2",
		"7.1.3.3",
		"7.1.4.1",
		"7.1.4.2",
		"7.1.4.3",
		"7.1.4.4",
		"7.1.4.5",
		"7.2.1.1",
		"7.2.1.2",
		"7.2.2.1",
		"7.2.2.2",
		"7.2.3.1",
		"7.2.4.1",
		"7.2.4.2",
		"7.2.4.3",
		"7.2.4.4",
		"7.2.4.5",
		"7.2.4.6",
		"7.2.4.7",
		"7.3.1.1",
		"7.3.1.2",
		"7.3.2.1",
		"7.3.2.2",
		"7.3.2.3",
		"7.3.2.4",
		"7.3.3.1",
		"7.3.3.2",
		"7.3.3.3",
		"7.3.3.4",
		"7.4.1.1",
		"7.4.1.2"
	];
	trgr(guidelines);
	function trgr(){
		d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>検査内容参照</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('#desc,label {font-size: 90%;}');
		d.writeln('#technique_id{width:80px;}');
		d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');
		d.writeln('#all_text {width: 160px;}');
		d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');
		d.writeln('#results dt {font-weight: bold;}');
		d.writeln('#results dd {margin: -1.5em 0 3px 11em;}');
		d.writeln('.first{margin-top: 15px;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body onload="create_guidelines()">');
		d.writeln('<script type="text/javascript">');
		d.writeln('var techs = {');
		d.writeln('"7.1.1.1": "H37,H24,G94,H2,H30,IFC2016,IFC1022,H44,H65,G68,G100,IFC1002,H67,C9",');
		d.writeln('"7.1.2.1": "G158,IFC1003",');
		d.writeln('"7.1.2.2": "IFC1004",');
		d.writeln('"7.1.2.3": "IFC1005",');
		d.writeln('"7.1.2.4": "IFC2007,IFC2008",');
		d.writeln('"7.1.2.5": "IFC1023",');
		d.writeln('"7.1.3.1": "IFC2001,G117,G140,G138,H51,IFC1036,H44,H65,H71,H85,H48,H42,SCR21,IFC2005",');
		d.writeln('"7.1.3.2": "IFC1006,C8",');
		d.writeln('"7.1.3.3": "G96",');
		d.writeln('"7.1.4.1": "IFC2006,IFC1037,IFC1038",');
		d.writeln('"7.1.4.2": "IFC1007",');
		d.writeln('"7.1.4.3": "G18,G148,G174,G145",');
		d.writeln('"7.1.4.4": "G142,IFC1025,IFC1026,G178,G179",');
		d.writeln('"7.1.4.5": "C22,C30,G140",');
		d.writeln('"7.2.1.1": "IFC1008",');
		d.writeln('"7.2.1.2": "G21",');
		d.writeln('"7.2.2.1": "G133,IFC2026,G198,G180,IFC1009,IFC2015",');
		d.writeln('"7.2.2.2": "IFC1039",');
		d.writeln('"7.2.3.1": "IFC1011",');
		d.writeln('"7.2.4.1": "IFC1040,H69,H50,SCR28",');
		d.writeln('"7.2.4.2": "IFC1013",');
		d.writeln('"7.2.4.3": "IFC1014,IFC1041",');
		d.writeln('"7.2.4.4": "IFC1015,H24,G53,H77,H78,H79,H80,H81,C7",');
		d.writeln('"7.2.4.5": "G125,G64,G63,G161,G126,G185",');
		d.writeln('"7.2.4.6": "G130,G131",');
		d.writeln('"7.2.4.7": "IFC1042",');
		d.writeln('"7.3.1.1": "H57",');
		d.writeln('"7.3.1.2": "H58",');
		d.writeln('"7.3.2.1": "G107",');
		d.writeln('"7.3.2.2": "IFC1016",');
		d.writeln('"7.3.2.3": "G61",');
		d.writeln('"7.3.2.4": "G197",');
		d.writeln('"7.3.3.1": "IFC2025,IFC1018",');
		d.writeln('"7.3.3.2": "G89,G184,G162,G83,H44,H65,H71,G167",');
		d.writeln('"7.3.3.3": "G83,IFC2017",');
		d.writeln('"7.3.3.4": "IFC2019,IFC2020,IFC2021",');
		d.writeln('"7.4.1.1": "IFC1019",');
		d.writeln('"7.4.1.2": "IFC1020,IFC1021,SCR21",');
		d.writeln('};');
		d.writeln('var smry = {');
		d.writeln('"H37": "レベル1,【機械診断】img要素にalt属性があるかを判定してください",');
		d.writeln('"H24": "レベル1,area要素にalt属性があるかを判定してください",');
		d.writeln('"G94": "レベル1,img，area要素，appletのalt属性に適切な代替テキストを記述されているか、またapplet要素およびobject要素のボディに適切な代替テキストを記述されているかを判定してください",');
		d.writeln('"H2": "レベル1,隣り合う画像とテキストのリンクが同一のリンク先を持つ場合、画像とテキストを1つのa要素でマークアップしているかを判定してください",');
		d.writeln('"H30": "レベル1,a要素のリンクの目的を説明するテキストリンクが提供されているかを判定してください",');
		d.writeln('"IFC2016": "レベル1,【G74】【G92】【G73】【H53】簡潔な代替えテキストに加えて長い説明が必要な非テキストコンテンツへの対応を判定　（例）チャート、ダイアグラムが該当します）",');
		d.writeln('"IFC1022": "レベル1,【G82】【H36】非テキストが、送信/実行ボタン、または制御ボタン等の場合、input要素にその目的を説明する代替テキスト（alt属性）があるかを判定してください",');
		d.writeln('"H44": "レベル1,【機械診断】　label要素を用いて、入力、チェックボックス、ラジオボタン等々の前に、その目的を伝えているか判定",');
		d.writeln('"H65": "レベル1,label要素を用いることができないとき、title属性を用いてフォーム・コントロールを特定しているかを判定してください",');
		d.writeln('"G68": "レベル1,ライブの音声、映像コンテンツがある場合、付けられたラベルが、コンテンツの目的や内容の説明をしているかを判定してください",');
		d.writeln('"G100": "レベル1,非テキストコンテンツの代替テキストに、固有名詞や一般で認められた名称が含まれているかを判定してください",');
		d.writeln('"IFC1002": "レベル1,【G143】【G144】非テキスト「CAPTCHA」のテストに必要な非テキストを判定します。「CAPTCHA」が無ければ非適用。 代替えテキストでCHAPTCHAの目的を説明していなければなりません。 利用者が代替えテキストでもCAPTCHAのタスクを完了できない時にも、代わりに目的を果たす方法を提供しなければなりません。 (例)CHAPTCHAのほかに、「２＋７の答えは」と問うフォームで利用者の解答を求めるなど",');
		d.writeln('"H67": "レベル1,タイトル：支援技術が無視すべき画像の img 要素では、alt属性値は空にし、title 属性は付与しない。",');
		d.writeln('"C9": "レベル1,画面上でCSSのON/OFFを行い、意味を持つ画像はCSSでは表示されておらず、他の意味を持たない装飾画像がCSSで表示されていることを確認してください",');
		d.writeln('"G158": "レベル1,音声しか含まないコンテンツに対して、アクセシブルな代替コンテンツの提供について判定、無ければ非適用。 ただし、音声コンテンツがテキストの代替メディアである場合は、代替メディアであることを明確にラベル付けする",');
		d.writeln('"IFC1003": "レベル1,【G159】【G166】収録済み映像（音声を含まない）コンテンツのキャプションを判定 ただし、映像コンテンツがテキストの代替メディアである場合は、代替メディアであるとラベル付けされているかを判定。",');
		d.writeln('"IFC1004": "レベル1,【G93】【G87】音声コンテンツへの字幕(キャプション)提供について判定、 ただし、音声コンテンツがテキストの代替メディアである場合は、代替メディアであることを明確にラベル付けする、",');
		d.writeln('"IFC1005": "レベル1,【G69】【G58】【H53】【G78】【G173】【SM6】【SM7】【G8】【SM1】【SM2】記録されているマルチメディアに、ビデオの音声ガイドが提供されているか判定、 ただし、映像コンテンツがテキストの代替メディアである場合は、代替メディアであることを明確にラベル付けする。映像コンテンツが無ければ非適用。",');
		d.writeln('"IFC2007": "レベル1,ライブの同期したメディアに対してキャプションを作成する 、かつ、オープン・キャプション（常に表示）を提供する",');
		d.writeln('"IFC2008": "レベル1,クローズド・キャプションをサポートするビデオ・プレーヤーのある、すぐに利用可能なメディア・フォーマットを用いて、ライブの同期したメディアに対してキャプションを作成する 、かつ、 クローズド・キャプションを提供する",');
		d.writeln('"IFC1023": "レベル1,【G78】【G173】【SM6】【SM7】【G8】【SM1】【SM2】収録済の映像コンテンツすべてに、音声ガイドを提供しているかの判定 映像の音声ガイド付きバージョンを提供する 拡張した音声ガイド付のムービーを提供する",');
		d.writeln('"IFC2001": "レベル2,【G115】【H49】 テキストに対する装飾は、正しいマークアップで指定されているかを判定してください",');
		d.writeln('"G117": "レベル2,フォントの種類や形状で情報を伝えている場合、その情報をテキストで提供する",');
		d.writeln('"G140": "レベル2,ブラウザでCSSをON/OFFにして、HTML要素で色などの指定が無く、割付や色の指定はCSSのみで行われていることを確認してください",');
		d.writeln('"G138": "レベル2,テキストに対して色の違いで伝えられている情報には、色盲の方にも伝わるようにフォントのスタイルなど別の要素で違いを説明しているかを判定してください",');
		d.writeln('"H51": "レベル2,表形式の情報はtable要素でマークアップされているかを判定してください",');
		d.writeln('"IFC1036": "レベル2,【H39】【H73】【H63】【H43】視覚的または聴覚的な体裁等の表現を通じて提供される情報、および関係性が、プログラムで解釈可能であるか、テキストで提供されているかの判定",');
		d.writeln('"H44": "レベル2,label要素を用いて、テキストのラベルとフォーム・コントロールを関連付けているかを判定してください",');
		d.writeln('"H65": "レベル2,label要素を用いることができないとき、title属性を用いてフォーム・コントロールを特定できるかを判定してください",');
		d.writeln('"H71": "レベル2,入力フォーム内のグループ分けにはfieldsetまたはleggend要素を使用して分類されているかを判定してください",');
		d.writeln('"H85": "レベル2,入力フォームのオプショングループには、optgroup要素を使用してグループ化しているか判定してください",');
		d.writeln('"H48": "レベル2,リストで表現する項目にはリストの内容に沿った適切なol",');
		d.writeln('"H42": "レベル2,ページ内の各段落には、見出し要素が文章の段落に合わせて正しくマークアップされているかを判定してください",');
		d.writeln('"SCR21": "レベル2,ページ内にコンテンツを動的に生成する機能が用意されている場合、Document.write()、innnerHTML、outerHTML、innerText、またはouter Textを用いて生成されていないかを判定してください",');
		d.writeln('"IFC2005": "レベル2,コンテンツがテキスト(非HTML)の場合、テキストの表現のバリエーションによって伝えている情報を標準的なテキストの記述方法を用いて伝達する",');
		d.writeln('"IFC1006": "レベル2,【G57】【C27】画面上で、CSSのOFFとリニアライズ（線形化）を行い、コンテンツが上から下、左から右へ意味のある順序でならんでいるかを確認してください",');
		d.writeln('"C8": "レベル2,文章や単語の間に空白スペース文字を入れて文字間の割付を行っていないか、あるいは文章の途中に、改行などの余計なタグがないかを確認してください",');
		d.writeln('"G96": "レベル2,オブジェクトの形、大きさ、又は位置を使って説明しているアイテムがある場合、読み上げブラウザなどでもアイテムが特定できるように、テキストだけでもアイテムを特定するための情報が提供されているかを判定してください",');
		d.writeln('"IFC2006": "レベル2,色で伝達されている情報に関する判定、参考実装方法番号「G14",');
		d.writeln('"IFC1037": "レベル2,【G182】【G183】色だけを使って情報を伝えていないかを判定。 何が起こるか、または何が起きたかを伝える情報、利用者の反応を促す情報、情報を区別する手段として色だけで伝えるなど。",');
		d.writeln('"IFC1038": "レベル2,【G111】【G14】色だけを使って情報を伝えていないかを判定。 何が起こるか、または何が起きたかを伝える情報、利用者の反応を促す情報、情報を区別する手段として色だけで伝えるなど。",');
		d.writeln('"IFC1007": "レベル1,【G60】【G170】【G171】自動的に流れる背景音に関する判定、音が無ければ非適用。",');
		d.writeln('"G18": "レベル1,テキスト（及び画像化された文字）とその背景の間に、少なくとも4.5:1以上のコントラスト比をもたせる ※この項目は、コントラスト確認できるツールを用いて確認してください。",');
		d.writeln('"G148": "レベル1,ブラウザでCSSをOFFにして、テキストと背景色のうち、CSSやHTML要素で片方のみの色が指定されていないかを判定してください",');
		d.writeln('"G174": "レベル1,十分なコントラスト比のあるコントロールを提供して、利用者が十分なコントラストのある表現に変換できるようにする",');
		d.writeln('"G145": "レベル1,テキスト（及び画像化された文字）とその背景の間に、少なくとも3:1以上のコントラスト比をもたせる ※この項目は、コントラスト確認できるツールを用いて確認してください。",');
		d.writeln('"G142": "レベル2,ブラウザで画面全体を200％まで拡大させ、コンテンツの全ての機能が利用可能であるかを判定してください",');
		d.writeln('"IFC1025": "レベル2,【C12】【C13】【C14】コンテンツあるいはテキストを支援技術なしで２００％までサイズを変更できるかの判定 CSSでフォントサイズが、％、em、またはキーワードで指定されて、ブラウザで文字サイズの変更が可能になっているかを判定してください",');
		d.writeln('"IFC1026": "レベル2,【C28】【SCR34】【G146】コンテンツあるいはテキストを支援技術なしで２００％までサイズを変更できるかの判定 文字サイズを2倍にしても、文字が切れたり、ブラウザの横スクロールバーが表示されることなしにコンテンツが表示され、すべての機能が利用できるか確認してください",');
		d.writeln('"G178": "レベル2,利用者がウェブページ上のすべてのテキストを200％まで徐々に変更できるコントロールをウェブページ上で提供する",');
		d.writeln('"G179": "レベル2,テキストの枠や背景の大きさが固定の場合、テキストのサイズを2倍にしても問題が無いことを確認してください",');
		d.writeln('"C22": "レベル2,CSSを用いて、テキストの視覚的な表現を制御する",');
		d.writeln('"C30": "レベル2,ページの先頭付近に、画像表示とテキスト表示を切替え可能な機能が実装されているかを確認してください",');
		d.writeln('"G140": "レベル2,ブラウザでCSSをON/OFFにして、HTML要素で色などの指定が無く、割付や色の指定はCSSのみで行われていることを確認してください",');
		d.writeln('"IFC1008": "レベル3,【H91】【G90】【SCR20】【SCR35】【SCR2】キーボードでマウス操作と同じ操作ができるかの判定 リンク及びフォーム内容に対して、表題が指定されていなければなりません。 画面上で、フォームやリンク、その他の機能に、マウスとキーボードの両方でアクセスできて、同等に利用が可能かどうかを判定してください",');
		d.writeln('"G21": "レベル3,全てのコンテンツにタブキーのみで移動できるかを判定 ただし、操作が修飾キーを伴わない矢印キー、修飾キーを伴わない Tab キー、又はフォーカスを外すその他の標準的な方法で不可能な場合、キーボード・フォーカスをそのコンポーネントから外す方法を知らせることが必要",');
		d.writeln('"G133": "レベル3,セッションの制限時間がある場合の判定。 入力フォームが複数のページにまたがって構成されており、その入力には制限時間が課せられていた場合、制限時間の延長を要求する機能があるかを判定 ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');
		d.writeln('"IFC2026": "レベル3,G198: 利用者が制限時間を解除できる手段を提供しているかを判定する。またmeta要素のrefreshによるページのリフレッシュまたはリダイレクトで表示されたページか判定する。",');
		d.writeln('"G198": "レベル3,G198: 利用者が制限時間を解除できる手段を提供しているかを判定する。",');
		d.writeln('"G180": "レベル3,コンテンツの制限時間を10倍に延長できる設定が用意されているかを判定する ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');
		d.writeln('"IFC1009": "レベル3,【SCR16】【SCR1】制限時間による制御が含まれているページの場合 制限時間の20秒少ない時間で、制限時間に対する警告を確認するダイアログを表示しているかを判定 ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');
		d.writeln('"IFC2015": "レベル3,スクロールなどの動きがあるコンテンツを一時停止、再開できるようになっているかを判定 制限時間が一般利用時間の10倍を想定されているか、また制限時間自体を解除できる機能があるかを判定 ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');
		d.writeln('"IFC1039": "レベル3,【G4】【SCR33】【G11】【G187】【G152】【SCR22】【G186】【G191】動きのある、点滅している、又はスクロールしている情報を判定 コンテンツを一時停止させて、停止したところから再開できなければなりません 5秒未満で点滅が終わるようにしなければなりません 利用者が点滅するコンテンツを停止できなければなりません 数回のループ後（5秒以内）に停止するように、アニメーションGIFを設定しなければなりません",');
		d.writeln('"IFC1011": "レベル1,【G19】【G176】【G15】動画コンテンツ以外に閃光するコンテンツがある場合は、一般閃光閾値及び赤色閃光閾値を下回っているかを判定してください",');
		d.writeln('"IFC1040": "レベル3,【G1】【G123】【G124】ブロックスキップの判定 メインコンテンツ(本文）エリアに直接飛べるリンクを各ページの先頭で提供しなければなりません 繰り返すコンテンツのブロックの開始位置に、そのブロックの終了位置へのリンクを提供しなければなりません。 ページの先頭に、コンテンツの各エリアへのリンクを提供しなければなりません",');
		d.writeln('"H69": "レベル3,段落の開始場所に見出し要素が正しく指定されているかを判定してください",');
		d.writeln('"H50": "レベル3,グローバルナビやイメージマップなど、グループ化すべき要素がある場合、リンク要素、リスト要素、MAP要素などがidやtitleでグループ化してマークアップされているかを判定してください",');
		d.writeln('"SCR28": "レベル3,折りたたみ可能な機能があるページの場合 折りたたんだ項目は読み上げでスキップしているかを判定してください",');
		d.writeln('"IFC1013": "レベル1,【G88】【H25】ウェブページの内容が分かるページタイトルが設定されているかを判定してください",');
		d.writeln('"IFC1014": "レベル3,【G59】【H4】【C27】タブキーだけで全てのコンテンツに移動でき、ナビゲーションの順番が意味性や操作性を保持されているかを判定してください",');
		d.writeln('"IFC1041": "レベル3,【SCR26】【SCR37】【SCR27】キーボード操作でウェブページが意図する正しい順序で情報を利用者に提供しているか判定 タブキーを押して、意図する順序にナビゲートされるか確認をしてください。 ナビゲートされたコンテンツが利用者に分かるように（識別等で）しなければなりません。",');
		d.writeln('"IFC1015": "レベル3,【G91】【H30】リンクの目的が、リンクテキストから利用者が理解できるかの判定、 a 要素のリンクの目的を説明するテキストリンクを提供しなければなりません",');
		d.writeln('"H24": "レベル3,area要素にalt属性があるかを判定してください",');
		d.writeln('"G53": "レベル3,リンク箇所と前後の文でリンク先の内容が説明されているかを判定してください",');
		d.writeln('"H77": "レベル3,リスト内にリンクが含まれている場合、リンクテキストとリスト項目がリンク先の内容を説明しているかを判定してください",');
		d.writeln('"H78": "レベル3,pタグ内にリンクが含まれている場合、リンクテキストとpタグ内容がリンク先の説明をしているかを判定してください",');
		d.writeln('"H79": "レベル3,テーブルのセル内にリンクが含まれている場合、リンクテキストとセルの見出しがリンク先の説明をしているかを判定してください",');
		d.writeln('"H80": "レベル3,リンクの直前にある見出し、または見出し内にリンクが含まれている場合、リンクテキストと見出し内容がリンク先の説明をしているかを判定してください",');
		d.writeln('"H81": "レベル3,入れ子のリストにリンクが含まれる場合、リンクテキストと親のリスト項目がリンク先の内容を説明しているかを判定してください",');
		d.writeln('"C7": "レベル3,リンク要素の説明を追加する方法として、極小の画像などを用意し、その代替テキストに説明を追加した上で、overflow:hiddenで表示領域外に配置するなどの手法を取っている場合 リンクテキストと代替テキストがリンク先の内容を説明しているかを判定してください また、overflow:hiddenでは無く、visilitiy:hiddenやdisplay:hiddenを使用していないかを判定（使用していた場合、読み上げ時に無視される可能性がある）",');
		d.writeln('"G125": "レベル2,内容に関連するページへのリンクが用意されているかを判定",');
		d.writeln('"G64": "レベル2,ページ内に目次が存在する場合 目次内の順番がコンテンツの順番と一致しているか 各セクションの項目が目次にあるかを判定",');
		d.writeln('"G63": "レベル2,サイトマップが用意されているか サイトマップから各ページへリンクをたどれるか 各ページからサイトマップへリンクが貼られているかを判定",');
		d.writeln('"G161": "レベル2,検索機能を提供して、利用者がコンテンツを見つけるのを手助けする",');
		d.writeln('"G126": "レベル2,他の全てのウェブページへのリンク一覧を提供する",');
		d.writeln('"G185": "レベル2,HOMEページからサイト上の全てのウェブページにリンクする",');
		d.writeln('"G130": "レベル2,内容が分かる見出しを付けているか判定",');
		d.writeln('"G131": "レベル2,フォームや操作を要求する要素がページにある場合 入力内容や操作方法が分かる見出しラベルを用意しているか判定",');
		d.writeln('"IFC1042": "レベル2,【G149】【C15】【G165】【G195】【SCR31】キーボード・フォーカス（キーボード操作で選択した場所をフォーカスする）の状態が視覚的に認識できる状態の判定 ・タブキーを押して選択された場所が視覚的に認識できるかを判定 ・背景またはボーダの色が変化して視覚的に認識できるかを判定 ・選択から外れた時に、背景またはボーダの色が元に戻るかを判定",');
		d.writeln('"H57": "レベル1,lang属性及び（または）xml:lang属性が正しく指定されているかを判定してください",');
		d.writeln('"H58": "レベル1,ページ内に英語やフランス語など異なる言語が混在する場合、その言語のテキストを表示しているHTML各要素に対して、適切なlang属性が各要素に記述されているかを判定してください",');
		d.writeln('"G107": "レベル1,フォーカスを受け取った時点で勝手に状態が変化してしまうコンテンツがないかを判定してください",');
		d.writeln('"IFC1016": "レベル1,【G80】【H32】【H84】【G13】フォーム入力時に実行ボタンを押す前に状況の変化が起きないかを判定してください. 利用者が入力した、または選択ボタンを押しただけで送信されてはいけません。 利用者が実行または送信を意図して行えるようにしなければなりません。",');
		d.writeln('"G61": "レベル2,繰り返されるコンポーネントが表示されるたびに、それを相対的に同じ順序で提示する",');
		d.writeln('"G197": "レベル2,同じ機能を有するコンテンツに対して、一貫したラベル、識別名及び代替テキストを用いる",');
		d.writeln('"IFC2025": "レベル3,【G83】【SCR18】利用者に情報の送信を要求するページの判定 １．入力必須項目が未入力の場合、どの項目が未入力であると利用者にテキストで伝えなければならない。 ２．必須項目のある入力フォームは、未入力の必須項目を理解できる説明テキストが提供しなければならない。",');
		d.writeln('"IFC1018": "レベル3,【G84】【G85】【SCR18】【SCR32】日付の入力フォームなど、特定の書式を利用者に要求する項目の場合、書式外の入力内容に対してエラーを説明するテキストが提供されるかを判定してください",');
		d.writeln('"G89": "レベル3,ページ内に日付など特定の書式を入力するフォームがある場合、特定の書式について説明が提供されているかを判定してください",');
		d.writeln('"G184": "レベル3,特定のフォーマットが必要な入力項目がある場合は、フォーム先頭にフォーマットの説明が用意されているかを判定してください",');
		d.writeln('"G162": "レベル3,入力フォームの前後に入力内容を説明するラベルが用意されているかを判定してください",');
		d.writeln('"G83": "レベル3,必須項目がある入力フォームの場合、必須項目を入力せずにフォーム内容を送信した場合、必須項目の入力を促す説明が表示されるかを判定してください",');
		d.writeln('"H44": "レベル3,label要素を用いて、テキストのラベルとフォーム・コントロールを関連付けているかを判定してください",');
		d.writeln('"H65": "レベル3,label要素を用いることができないとき、title属性を用いてフォーム・コントロールを特定できるかを判定してください",');
		d.writeln('"H71": "レベル3,入力フォーム内のグループ分けにはfieldsetまたはleggend要素を使用して分類されているかを判定してください",');
		d.writeln('"G167": "レベル3,テキストフィールドに入力された内容を実行するボタンが隣におかれている場合、ボタンにテキストフィールドの目的を説明するラベルが用意されているかを判定してください",');
		d.writeln('"G83": "レベル3,入力が完了していない必須項目を特定するために、テキストの説明文を提供する",');
		d.writeln('"IFC2017": "レベル3,【G84】【G85】【G177】【SCR18】【SCR32】利用者の入力にエラーがある場合、エラーであることを利用者に提供、修正方法を提供しなければなりません。 利用者への情報はテキストで提供して音声読み上げ利用者が理解できなければなりません。 入力エラーとなった項目を特定して、利用者にエラーとなった入力内容及びその修正方法の説明文をテキストで提供しなければなりません。 利用者に修正候補を提示しする、そして修正候補または修正候補へのリンクが、エラーを含むフィールドの近く配置されていなければなりません。",');
		d.writeln('"IFC2019": "レベル3,【G164】【G98】【G155】利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行う機能があるページの判定 次の何れかができなければなりません。 １．可逆性：送信後に利用者が送信内容を元に戻せなければなりません ２．チェック可能：利用者の入力したデータをチェックし、利用者に修正する機会を提供しなければなりません。 ３．確認可能：送信を完了する前に、利用者自身が情報の点検、確認および修正ができる方法を提供しなければなりません",');
		d.writeln('"IFC2020": "レベル3,【G99】【G168】【G155】利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行う機能があるページの判定 利用者が誤って削除した情報を復元できるように提供しなければなりません。 利用者が選択したアクションに対して、確認をするように要求を提示して、利用者が確定または取り消す事ができるようにしなければなりません",');
		d.writeln('"IFC2021": "レベル3,【G98】【G168】利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行う機能があるページの判定 利用者が誤って削除した情報を復元できるように提供しなければなりません。 利用者が選択したアクションに対して、確認をするように要求を提示して、利用者が確定または取り消す事ができるようにしなければなりません",');
		d.writeln('"IFC1019": "レベル2,【G134】【G192】【H88】【H74】【H75】ページをバリデート検証してください ※この項目は、バリデーションツールを用いて確認してください。（例：W3Cバリデーションツール）",');
		d.writeln('"IFC1020": "レベル3,【G108】【H91】【H44】【H64】【H65】【H88】標準的な HTML のコントロールだけを用いて書かれているかを判定してください",');
		d.writeln('"IFC1021": "レベル3,【Ｇ135】【G10】スクリプトやプログラムを使用したページの場合、コンポーネントがWCAG2.0またはJISX8341-3:2010に準拠した内容かを判定してください",');
		d.writeln('"SCR21": "レベル3,ページ内にコンテンツを動的に生成する機能が用意されている場合、Document.write()、innnerHTML、outerHTML、innerText、またはouter Textを用いて生成されていないかを判定してください",');
		d.writeln('};');
		d.writeln('var lvs = {');
		d.writeln('"レベル1": "7.1.1.1,7.1.2.1,7.1.2.2,7.1.2.3,7.1.2.4,7.1.2.5,7.1.4.2,7.1.4.3,7.2.3.1,7.2.4.2,7.3.1.1,7.3.1.2,7.3.2.1,7.3.2.2",');
		d.writeln('"レベル2": "7.1.3.1,7.1.3.2,7.1.3.3,7.1.4.1,7.1.4.4,7.1.4.5,7.2.4.5,7.2.4.6,7.2.4.7,7.3.2.3,7.3.2.4,7.4.1.1",');
		d.writeln('"レベル3": "7.2.1.1,7.2.1.2,7.2.2.1,7.2.2.2,7.2.4.1,7.2.4.3,7.2.4.4,7.3.3.1,7.3.3.2,7.3.3.3,7.3.3.4,7.4.1.2"');
		d.writeln('};');
		d.writeln('function create_summary(){');
		d.writeln('var target = document.getElementById("results");');
		d.writeln('target.innerHTML = "";');
		d.writeln('var src = document.getElementById("guideline_id");');
		d.writeln('var guideline_id = src.options[src.selectedIndex].text;');
		d.writeln('var desctext = "";');
		d.writeln('for(var key in lvs){');
		d.writeln('var lvsrow = lvs[key].toString();');
		d.writeln('var lvstmp = lvsrow.split(",");');
		d.writeln('for(var i=0; i<lvstmp.length; i++){');
		d.writeln('if(guideline_id==lvstmp[i].toString()){');
		d.writeln('desctext = "<strong>達成基準：</strong>" + guideline_id + " (" + key + ")";');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('}');
		d.writeln('document.getElementById("desc").innerHTML = desctext;');
		d.writeln('var tmp = new Array();');
		d.writeln('var result_text = "";');
		d.writeln('var dl = document.getElementById("results");');
		d.writeln('dl.innerHTML = "";');
		d.writeln('for(var key in techs){');
		d.writeln('if(key == guideline_id){');
		d.writeln('var val = techs[key].toString();');
		d.writeln('tmp = val.split(",");');
		d.writeln('for(var i=0; i < tmp.length; i++){');
		d.writeln('var line = tmp[i].toString();');
		d.writeln('var dt1 = document.createElement("dt");');
		d.writeln('dt1.setAttribute("class", "first");');
		d.writeln('dt1.textContent = line;');
		d.writeln('dl.appendChild(dt1);');
		d.writeln('var deepline = smry[line].toString();');
		d.writeln('var deeptmp = new Array();');
		d.writeln('deeptmp = deepline.split(",");');
		d.writeln('var dd1 = document.createElement("dd");');
		d.writeln('dd1.textContent = deeptmp[1].toString();');
		d.writeln('dl.appendChild(dd1);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function create_techs(){');
		d.writeln('var select = document.getElementById("technique_id");');
		d.writeln('select.innerHTML = "";');
		d.writeln('var src = document.getElementById("guideline_id");');
		d.writeln('var guideline_id = src.options[src.selectedIndex].text;');
		d.writeln('var tmp = new Array();');
		d.writeln('for(var key in techs){');
		d.writeln('if(key == guideline_id){');
		d.writeln('var val = techs[key].toString();');
		d.writeln('tmp = val.split(",");');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('for(var i=0; i < tmp.length; i++){');
		d.writeln('var elm = document.createElement("option");');
		d.writeln('elm.setAttribute("value", tmp[i].toString());');
		d.writeln('elm.textContent = tmp[i].toString();');
		d.writeln('select.appendChild(elm);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>検査内容参照</small></h1>');
		d.writeln('<label for="all_text">JIS番号と実装番号：</label>');
		d.writeln('<select id="guideline_id" onchange="create_techs()"></select>');
		d.writeln('<select id="technique_id"></select>');
		d.writeln('<button onclick="create_summary()">参照実行</button><br>');
		d.writeln('<p id="desc"></p>');
		d.writeln('<dl id="results"></dl>');
		d.writeln('</body>');
		d.writeln('</html>');
		var gdselect = d.getElementById("guideline_id");
		for(var i=0; i<guidelines.length; i++){
			var row = guidelines[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			gdselect.appendChild(opt);
		}
	}
})();

javascript:(function(){var guidelines = ["7.1.1.1","7.1.2.1","7.1.2.2","7.1.2.3","7.1.2.4","7.1.2.5","7.1.3.1","7.1.3.2","7.1.3.3","7.1.4.1","7.1.4.2","7.1.4.3","7.1.4.4","7.1.4.5","7.2.1.1","7.2.1.2","7.2.2.1","7.2.2.2","7.2.3.1","7.2.4.1","7.2.4.2","7.2.4.3","7.2.4.4","7.2.4.5","7.2.4.6","7.2.4.7","7.3.1.1","7.3.1.2","7.3.2.1","7.3.2.2","7.3.2.3","7.3.2.4","7.3.3.1","7.3.3.2","7.3.3.3","7.3.3.4","7.4.1.1","7.4.1.2"];trgr(guidelines);function trgr(){d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>検査内容参照</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('#desc,label {font-size: 90%;}');d.writeln('#technique_id{width:80px;}');d.writeln('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');d.writeln('#all_text {width: 160px;}');d.writeln('#results {font-size:80%; width: 100%; height: 15em;}');d.writeln('#results dt {font-weight: bold;}');d.writeln('#results dd {margin: -1.5em 0 3px 11em;}');d.writeln('.first{margin-top: 15px;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body onload="create_guidelines()">');d.writeln('<script type="text/javascript">');d.writeln('var techs = {');d.writeln('"7.1.1.1": "H37,H24,G94,H2,H30,IFC2016,IFC1022,H44,H65,G68,G100,IFC1002,H67,C9",');d.writeln('"7.1.2.1": "G158,IFC1003",');d.writeln('"7.1.2.2": "IFC1004",');d.writeln('"7.1.2.3": "IFC1005",');d.writeln('"7.1.2.4": "IFC2007,IFC2008",');d.writeln('"7.1.2.5": "IFC1023",');d.writeln('"7.1.3.1": "IFC2001,G117,G140,G138,H51,IFC1036,H44,H65,H71,H85,H48,H42,SCR21,IFC2005",');d.writeln('"7.1.3.2": "IFC1006,C8",');d.writeln('"7.1.3.3": "G96",');d.writeln('"7.1.4.1": "IFC2006,IFC1037,IFC1038",');d.writeln('"7.1.4.2": "IFC1007",');d.writeln('"7.1.4.3": "G18,G148,G174,G145",');d.writeln('"7.1.4.4": "G142,IFC1025,IFC1026,G178,G179",');d.writeln('"7.1.4.5": "C22,C30,G140",');d.writeln('"7.2.1.1": "IFC1008",');d.writeln('"7.2.1.2": "G21",');d.writeln('"7.2.2.1": "G133,IFC2026,G198,G180,IFC1009,IFC2015",');d.writeln('"7.2.2.2": "IFC1039",');d.writeln('"7.2.3.1": "IFC1011",');d.writeln('"7.2.4.1": "IFC1040,H69,H50,SCR28",');d.writeln('"7.2.4.2": "IFC1013",');d.writeln('"7.2.4.3": "IFC1014,IFC1041",');d.writeln('"7.2.4.4": "IFC1015,H24,G53,H77,H78,H79,H80,H81,C7",');d.writeln('"7.2.4.5": "G125,G64,G63,G161,G126,G185",');d.writeln('"7.2.4.6": "G130,G131",');d.writeln('"7.2.4.7": "IFC1042",');d.writeln('"7.3.1.1": "H57",');d.writeln('"7.3.1.2": "H58",');d.writeln('"7.3.2.1": "G107",');d.writeln('"7.3.2.2": "IFC1016",');d.writeln('"7.3.2.3": "G61",');d.writeln('"7.3.2.4": "G197",');d.writeln('"7.3.3.1": "IFC2025,IFC1018",');d.writeln('"7.3.3.2": "G89,G184,G162,G83,H44,H65,H71,G167",');d.writeln('"7.3.3.3": "G83,IFC2017",');d.writeln('"7.3.3.4": "IFC2019,IFC2020,IFC2021",');d.writeln('"7.4.1.1": "IFC1019",');d.writeln('"7.4.1.2": "IFC1020,IFC1021,SCR21",');d.writeln('};');d.writeln('var smry = {');d.writeln('"H37": "レベル1,【機械診断】img要素にalt属性があるかを判定してください",');d.writeln('"H24": "レベル1,area要素にalt属性があるかを判定してください",');d.writeln('"G94": "レベル1,img，area要素，appletのalt属性に適切な代替テキストを記述されているか、またapplet要素およびobject要素のボディに適切な代替テキストを記述されているかを判定してください",');d.writeln('"H2": "レベル1,隣り合う画像とテキストのリンクが同一のリンク先を持つ場合、画像とテキストを1つのa要素でマークアップしているかを判定してください",');d.writeln('"H30": "レベル1,a要素のリンクの目的を説明するテキストリンクが提供されているかを判定してください",');d.writeln('"IFC2016": "レベル1,【G74】【G92】【G73】【H53】簡潔な代替えテキストに加えて長い説明が必要な非テキストコンテンツへの対応を判定　（例）チャート、ダイアグラムが該当します）",');d.writeln('"IFC1022": "レベル1,【G82】【H36】非テキストが、送信/実行ボタン、または制御ボタン等の場合、input要素にその目的を説明する代替テキスト（alt属性）があるかを判定してください",');d.writeln('"H44": "レベル1,【機械診断】　label要素を用いて、入力、チェックボックス、ラジオボタン等々の前に、その目的を伝えているか判定",');d.writeln('"H65": "レベル1,label要素を用いることができないとき、title属性を用いてフォーム・コントロールを特定しているかを判定してください",');d.writeln('"G68": "レベル1,ライブの音声、映像コンテンツがある場合、付けられたラベルが、コンテンツの目的や内容の説明をしているかを判定してください",');d.writeln('"G100": "レベル1,非テキストコンテンツの代替テキストに、固有名詞や一般で認められた名称が含まれているかを判定してください",');d.writeln('"IFC1002": "レベル1,【G143】【G144】非テキスト「CAPTCHA」のテストに必要な非テキストを判定します。「CAPTCHA」が無ければ非適用。 代替えテキストでCHAPTCHAの目的を説明していなければなりません。 利用者が代替えテキストでもCAPTCHAのタスクを完了できない時にも、代わりに目的を果たす方法を提供しなければなりません。 (例)CHAPTCHAのほかに、「２＋７の答えは」と問うフォームで利用者の解答を求めるなど",');d.writeln('"H67": "レベル1,タイトル：支援技術が無視すべき画像の img 要素では、alt属性値は空にし、title 属性は付与しない。",');d.writeln('"C9": "レベル1,画面上でCSSのON/OFFを行い、意味を持つ画像はCSSでは表示されておらず、他の意味を持たない装飾画像がCSSで表示されていることを確認してください",');d.writeln('"G158": "レベル1,音声しか含まないコンテンツに対して、アクセシブルな代替コンテンツの提供について判定、無ければ非適用。 ただし、音声コンテンツがテキストの代替メディアである場合は、代替メディアであることを明確にラベル付けする",');d.writeln('"IFC1003": "レベル1,【G159】【G166】収録済み映像（音声を含まない）コンテンツのキャプションを判定 ただし、映像コンテンツがテキストの代替メディアである場合は、代替メディアであるとラベル付けされているかを判定。",');d.writeln('"IFC1004": "レベル1,【G93】【G87】音声コンテンツへの字幕(キャプション)提供について判定、 ただし、音声コンテンツがテキストの代替メディアである場合は、代替メディアであることを明確にラベル付けする、",');d.writeln('"IFC1005": "レベル1,【G69】【G58】【H53】【G78】【G173】【SM6】【SM7】【G8】【SM1】【SM2】記録されているマルチメディアに、ビデオの音声ガイドが提供されているか判定、 ただし、映像コンテンツがテキストの代替メディアである場合は、代替メディアであることを明確にラベル付けする。映像コンテンツが無ければ非適用。",');d.writeln('"IFC2007": "レベル1,ライブの同期したメディアに対してキャプションを作成する 、かつ、オープン・キャプション（常に表示）を提供する",');d.writeln('"IFC2008": "レベル1,クローズド・キャプションをサポートするビデオ・プレーヤーのある、すぐに利用可能なメディア・フォーマットを用いて、ライブの同期したメディアに対してキャプションを作成する 、かつ、 クローズド・キャプションを提供する",');d.writeln('"IFC1023": "レベル1,【G78】【G173】【SM6】【SM7】【G8】【SM1】【SM2】収録済の映像コンテンツすべてに、音声ガイドを提供しているかの判定 映像の音声ガイド付きバージョンを提供する 拡張した音声ガイド付のムービーを提供する",');d.writeln('"IFC2001": "レベル2,【G115】【H49】 テキストに対する装飾は、正しいマークアップで指定されているかを判定してください",');d.writeln('"G117": "レベル2,フォントの種類や形状で情報を伝えている場合、その情報をテキストで提供する",');d.writeln('"G140": "レベル2,ブラウザでCSSをON/OFFにして、HTML要素で色などの指定が無く、割付や色の指定はCSSのみで行われていることを確認してください",');d.writeln('"G138": "レベル2,テキストに対して色の違いで伝えられている情報には、色盲の方にも伝わるようにフォントのスタイルなど別の要素で違いを説明しているかを判定してください",');d.writeln('"H51": "レベル2,表形式の情報はtable要素でマークアップされているかを判定してください",');d.writeln('"IFC1036": "レベル2,【H39】【H73】【H63】【H43】視覚的または聴覚的な体裁等の表現を通じて提供される情報、および関係性が、プログラムで解釈可能であるか、テキストで提供されているかの判定",');d.writeln('"H44": "レベル2,label要素を用いて、テキストのラベルとフォーム・コントロールを関連付けているかを判定してください",');d.writeln('"H65": "レベル2,label要素を用いることができないとき、title属性を用いてフォーム・コントロールを特定できるかを判定してください",');d.writeln('"H71": "レベル2,入力フォーム内のグループ分けにはfieldsetまたはleggend要素を使用して分類されているかを判定してください",');d.writeln('"H85": "レベル2,入力フォームのオプショングループには、optgroup要素を使用してグループ化しているか判定してください",');d.writeln('"H48": "レベル2,リストで表現する項目にはリストの内容に沿った適切なol",');d.writeln('"H42": "レベル2,ページ内の各段落には、見出し要素が文章の段落に合わせて正しくマークアップされているかを判定してください",');d.writeln('"SCR21": "レベル2,ページ内にコンテンツを動的に生成する機能が用意されている場合、Document.write()、innnerHTML、outerHTML、innerText、またはouter Textを用いて生成されていないかを判定してください",');d.writeln('"IFC2005": "レベル2,コンテンツがテキスト(非HTML)の場合、テキストの表現のバリエーションによって伝えている情報を標準的なテキストの記述方法を用いて伝達する",');d.writeln('"IFC1006": "レベル2,【G57】【C27】画面上で、CSSのOFFとリニアライズ（線形化）を行い、コンテンツが上から下、左から右へ意味のある順序でならんでいるかを確認してください",');d.writeln('"C8": "レベル2,文章や単語の間に空白スペース文字を入れて文字間の割付を行っていないか、あるいは文章の途中に、改行などの余計なタグがないかを確認してください",');d.writeln('"G96": "レベル2,オブジェクトの形、大きさ、又は位置を使って説明しているアイテムがある場合、読み上げブラウザなどでもアイテムが特定できるように、テキストだけでもアイテムを特定するための情報が提供されているかを判定してください",');d.writeln('"IFC2006": "レベル2,色で伝達されている情報に関する判定、参考実装方法番号「G14",');d.writeln('"IFC1037": "レベル2,【G182】【G183】色だけを使って情報を伝えていないかを判定。 何が起こるか、または何が起きたかを伝える情報、利用者の反応を促す情報、情報を区別する手段として色だけで伝えるなど。",');d.writeln('"IFC1038": "レベル2,【G111】【G14】色だけを使って情報を伝えていないかを判定。 何が起こるか、または何が起きたかを伝える情報、利用者の反応を促す情報、情報を区別する手段として色だけで伝えるなど。",');d.writeln('"IFC1007": "レベル1,【G60】【G170】【G171】自動的に流れる背景音に関する判定、音が無ければ非適用。",');d.writeln('"G18": "レベル1,テキスト（及び画像化された文字）とその背景の間に、少なくとも4.5:1以上のコントラスト比をもたせる ※この項目は、コントラスト確認できるツールを用いて確認してください。",');d.writeln('"G148": "レベル1,ブラウザでCSSをOFFにして、テキストと背景色のうち、CSSやHTML要素で片方のみの色が指定されていないかを判定してください",');d.writeln('"G174": "レベル1,十分なコントラスト比のあるコントロールを提供して、利用者が十分なコントラストのある表現に変換できるようにする",');d.writeln('"G145": "レベル1,テキスト（及び画像化された文字）とその背景の間に、少なくとも3:1以上のコントラスト比をもたせる ※この項目は、コントラスト確認できるツールを用いて確認してください。",');d.writeln('"G142": "レベル2,ブラウザで画面全体を200％まで拡大させ、コンテンツの全ての機能が利用可能であるかを判定してください",');d.writeln('"IFC1025": "レベル2,【C12】【C13】【C14】コンテンツあるいはテキストを支援技術なしで２００％までサイズを変更できるかの判定 CSSでフォントサイズが、％、em、またはキーワードで指定されて、ブラウザで文字サイズの変更が可能になっているかを判定してください",');d.writeln('"IFC1026": "レベル2,【C28】【SCR34】【G146】コンテンツあるいはテキストを支援技術なしで２００％までサイズを変更できるかの判定 文字サイズを2倍にしても、文字が切れたり、ブラウザの横スクロールバーが表示されることなしにコンテンツが表示され、すべての機能が利用できるか確認してください",');d.writeln('"G178": "レベル2,利用者がウェブページ上のすべてのテキストを200％まで徐々に変更できるコントロールをウェブページ上で提供する",');d.writeln('"G179": "レベル2,テキストの枠や背景の大きさが固定の場合、テキストのサイズを2倍にしても問題が無いことを確認してください",');d.writeln('"C22": "レベル2,CSSを用いて、テキストの視覚的な表現を制御する",');d.writeln('"C30": "レベル2,ページの先頭付近に、画像表示とテキスト表示を切替え可能な機能が実装されているかを確認してください",');d.writeln('"G140": "レベル2,ブラウザでCSSをON/OFFにして、HTML要素で色などの指定が無く、割付や色の指定はCSSのみで行われていることを確認してください",');d.writeln('"IFC1008": "レベル3,【H91】【G90】【SCR20】【SCR35】【SCR2】キーボードでマウス操作と同じ操作ができるかの判定 リンク及びフォーム内容に対して、表題が指定されていなければなりません。 画面上で、フォームやリンク、その他の機能に、マウスとキーボードの両方でアクセスできて、同等に利用が可能かどうかを判定してください",');d.writeln('"G21": "レベル3,全てのコンテンツにタブキーのみで移動できるかを判定 ただし、操作が修飾キーを伴わない矢印キー、修飾キーを伴わない Tab キー、又はフォーカスを外すその他の標準的な方法で不可能な場合、キーボード・フォーカスをそのコンポーネントから外す方法を知らせることが必要",');d.writeln('"G133": "レベル3,セッションの制限時間がある場合の判定。 入力フォームが複数のページにまたがって構成されており、その入力には制限時間が課せられていた場合、制限時間の延長を要求する機能があるかを判定 ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');d.writeln('"IFC2026": "レベル3,G198: 利用者が制限時間を解除できる手段を提供しているかを判定する。またmeta要素のrefreshによるページのリフレッシュまたはリダイレクトで表示されたページか判定する。",');d.writeln('"G198": "レベル3,G198: 利用者が制限時間を解除できる手段を提供しているかを判定する。",');d.writeln('"G180": "レベル3,コンテンツの制限時間を10倍に延長できる設定が用意されているかを判定する ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');d.writeln('"IFC1009": "レベル3,【SCR16】【SCR1】制限時間による制御が含まれているページの場合 制限時間の20秒少ない時間で、制限時間に対する警告を確認するダイアログを表示しているかを判定 ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');d.writeln('"IFC2015": "レベル3,スクロールなどの動きがあるコンテンツを一時停止、再開できるようになっているかを判定 制限時間が一般利用時間の10倍を想定されているか、また制限時間自体を解除できる機能があるかを判定 ただし、リアルタイムのイベント（例えば、オークション）において制限時間が必須の要素で、その制限時間に代わる手段が存在しないため、制限時間は必要不可欠である、または、制限時間が20時間より長い場合は、例外とする。",');d.writeln('"IFC1039": "レベル3,【G4】【SCR33】【G11】【G187】【G152】【SCR22】【G186】【G191】動きのある、点滅している、又はスクロールしている情報を判定 コンテンツを一時停止させて、停止したところから再開できなければなりません 5秒未満で点滅が終わるようにしなければなりません 利用者が点滅するコンテンツを停止できなければなりません 数回のループ後（5秒以内）に停止するように、アニメーションGIFを設定しなければなりません",');d.writeln('"IFC1011": "レベル1,【G19】【G176】【G15】動画コンテンツ以外に閃光するコンテンツがある場合は、一般閃光閾値及び赤色閃光閾値を下回っているかを判定してください",');d.writeln('"IFC1040": "レベル3,【G1】【G123】【G124】ブロックスキップの判定 メインコンテンツ(本文）エリアに直接飛べるリンクを各ページの先頭で提供しなければなりません 繰り返すコンテンツのブロックの開始位置に、そのブロックの終了位置へのリンクを提供しなければなりません。 ページの先頭に、コンテンツの各エリアへのリンクを提供しなければなりません",');d.writeln('"H69": "レベル3,段落の開始場所に見出し要素が正しく指定されているかを判定してください",');d.writeln('"H50": "レベル3,グローバルナビやイメージマップなど、グループ化すべき要素がある場合、リンク要素、リスト要素、MAP要素などがidやtitleでグループ化してマークアップされているかを判定してください",');d.writeln('"SCR28": "レベル3,折りたたみ可能な機能があるページの場合 折りたたんだ項目は読み上げでスキップしているかを判定してください",');d.writeln('"IFC1013": "レベル1,【G88】【H25】ウェブページの内容が分かるページタイトルが設定されているかを判定してください",');d.writeln('"IFC1014": "レベル3,【G59】【H4】【C27】タブキーだけで全てのコンテンツに移動でき、ナビゲーションの順番が意味性や操作性を保持されているかを判定してください",');d.writeln('"IFC1041": "レベル3,【SCR26】【SCR37】【SCR27】キーボード操作でウェブページが意図する正しい順序で情報を利用者に提供しているか判定 タブキーを押して、意図する順序にナビゲートされるか確認をしてください。 ナビゲートされたコンテンツが利用者に分かるように（識別等で）しなければなりません。",');d.writeln('"IFC1015": "レベル3,【G91】【H30】リンクの目的が、リンクテキストから利用者が理解できるかの判定、 a 要素のリンクの目的を説明するテキストリンクを提供しなければなりません",');d.writeln('"H24": "レベル3,area要素にalt属性があるかを判定してください",');d.writeln('"G53": "レベル3,リンク箇所と前後の文でリンク先の内容が説明されているかを判定してください",');d.writeln('"H77": "レベル3,リスト内にリンクが含まれている場合、リンクテキストとリスト項目がリンク先の内容を説明しているかを判定してください",');d.writeln('"H78": "レベル3,pタグ内にリンクが含まれている場合、リンクテキストとpタグ内容がリンク先の説明をしているかを判定してください",');d.writeln('"H79": "レベル3,テーブルのセル内にリンクが含まれている場合、リンクテキストとセルの見出しがリンク先の説明をしているかを判定してください",');d.writeln('"H80": "レベル3,リンクの直前にある見出し、または見出し内にリンクが含まれている場合、リンクテキストと見出し内容がリンク先の説明をしているかを判定してください",');d.writeln('"H81": "レベル3,入れ子のリストにリンクが含まれる場合、リンクテキストと親のリスト項目がリンク先の内容を説明しているかを判定してください",');d.writeln('"C7": "レベル3,リンク要素の説明を追加する方法として、極小の画像などを用意し、その代替テキストに説明を追加した上で、overflow:hiddenで表示領域外に配置するなどの手法を取っている場合 リンクテキストと代替テキストがリンク先の内容を説明しているかを判定してください また、overflow:hiddenでは無く、visilitiy:hiddenやdisplay:hiddenを使用していないかを判定（使用していた場合、読み上げ時に無視される可能性がある）",');d.writeln('"G125": "レベル2,内容に関連するページへのリンクが用意されているかを判定",');d.writeln('"G64": "レベル2,ページ内に目次が存在する場合 目次内の順番がコンテンツの順番と一致しているか 各セクションの項目が目次にあるかを判定",');d.writeln('"G63": "レベル2,サイトマップが用意されているか サイトマップから各ページへリンクをたどれるか 各ページからサイトマップへリンクが貼られているかを判定",');d.writeln('"G161": "レベル2,検索機能を提供して、利用者がコンテンツを見つけるのを手助けする",');d.writeln('"G126": "レベル2,他の全てのウェブページへのリンク一覧を提供する",');d.writeln('"G185": "レベル2,HOMEページからサイト上の全てのウェブページにリンクする",');d.writeln('"G130": "レベル2,内容が分かる見出しを付けているか判定",');d.writeln('"G131": "レベル2,フォームや操作を要求する要素がページにある場合 入力内容や操作方法が分かる見出しラベルを用意しているか判定",');d.writeln('"IFC1042": "レベル2,【G149】【C15】【G165】【G195】【SCR31】キーボード・フォーカス（キーボード操作で選択した場所をフォーカスする）の状態が視覚的に認識できる状態の判定 ・タブキーを押して選択された場所が視覚的に認識できるかを判定 ・背景またはボーダの色が変化して視覚的に認識できるかを判定 ・選択から外れた時に、背景またはボーダの色が元に戻るかを判定",');d.writeln('"H57": "レベル1,lang属性及び（または）xml:lang属性が正しく指定されているかを判定してください",');d.writeln('"H58": "レベル1,ページ内に英語やフランス語など異なる言語が混在する場合、その言語のテキストを表示しているHTML各要素に対して、適切なlang属性が各要素に記述されているかを判定してください",');d.writeln('"G107": "レベル1,フォーカスを受け取った時点で勝手に状態が変化してしまうコンテンツがないかを判定してください",');d.writeln('"IFC1016": "レベル1,【G80】【H32】【H84】【G13】フォーム入力時に実行ボタンを押す前に状況の変化が起きないかを判定してください. 利用者が入力した、または選択ボタンを押しただけで送信されてはいけません。 利用者が実行または送信を意図して行えるようにしなければなりません。",');d.writeln('"G61": "レベル2,繰り返されるコンポーネントが表示されるたびに、それを相対的に同じ順序で提示する",');d.writeln('"G197": "レベル2,同じ機能を有するコンテンツに対して、一貫したラベル、識別名及び代替テキストを用いる",');d.writeln('"IFC2025": "レベル3,【G83】【SCR18】利用者に情報の送信を要求するページの判定 １．入力必須項目が未入力の場合、どの項目が未入力であると利用者にテキストで伝えなければならない。 ２．必須項目のある入力フォームは、未入力の必須項目を理解できる説明テキストが提供しなければならない。",');d.writeln('"IFC1018": "レベル3,【G84】【G85】【SCR18】【SCR32】日付の入力フォームなど、特定の書式を利用者に要求する項目の場合、書式外の入力内容に対してエラーを説明するテキストが提供されるかを判定してください",');d.writeln('"G89": "レベル3,ページ内に日付など特定の書式を入力するフォームがある場合、特定の書式について説明が提供されているかを判定してください",');d.writeln('"G184": "レベル3,特定のフォーマットが必要な入力項目がある場合は、フォーム先頭にフォーマットの説明が用意されているかを判定してください",');d.writeln('"G162": "レベル3,入力フォームの前後に入力内容を説明するラベルが用意されているかを判定してください",');d.writeln('"G83": "レベル3,必須項目がある入力フォームの場合、必須項目を入力せずにフォーム内容を送信した場合、必須項目の入力を促す説明が表示されるかを判定してください",');d.writeln('"H44": "レベル3,label要素を用いて、テキストのラベルとフォーム・コントロールを関連付けているかを判定してください",');d.writeln('"H65": "レベル3,label要素を用いることができないとき、title属性を用いてフォーム・コントロールを特定できるかを判定してください",');d.writeln('"H71": "レベル3,入力フォーム内のグループ分けにはfieldsetまたはleggend要素を使用して分類されているかを判定してください",');d.writeln('"G167": "レベル3,テキストフィールドに入力された内容を実行するボタンが隣におかれている場合、ボタンにテキストフィールドの目的を説明するラベルが用意されているかを判定してください",');d.writeln('"G83": "レベル3,入力が完了していない必須項目を特定するために、テキストの説明文を提供する",');d.writeln('"IFC2017": "レベル3,【G84】【G85】【G177】【SCR18】【SCR32】利用者の入力にエラーがある場合、エラーであることを利用者に提供、修正方法を提供しなければなりません。 利用者への情報はテキストで提供して音声読み上げ利用者が理解できなければなりません。 入力エラーとなった項目を特定して、利用者にエラーとなった入力内容及びその修正方法の説明文をテキストで提供しなければなりません。 利用者に修正候補を提示しする、そして修正候補または修正候補へのリンクが、エラーを含むフィールドの近く配置されていなければなりません。",');d.writeln('"IFC2019": "レベル3,【G164】【G98】【G155】利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行う機能があるページの判定 次の何れかができなければなりません。 １．可逆性：送信後に利用者が送信内容を元に戻せなければなりません ２．チェック可能：利用者の入力したデータをチェックし、利用者に修正する機会を提供しなければなりません。 ３．確認可能：送信を完了する前に、利用者自身が情報の点検、確認および修正ができる方法を提供しなければなりません",');d.writeln('"IFC2020": "レベル3,【G99】【G168】【G155】利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行う機能があるページの判定 利用者が誤って削除した情報を復元できるように提供しなければなりません。 利用者が選択したアクションに対して、確認をするように要求を提示して、利用者が確定または取り消す事ができるようにしなければなりません",');d.writeln('"IFC2021": "レベル3,【G98】【G168】利用者にとって法的義務または金銭的な取引が生じるデータのやり取りを行う機能があるページの判定 利用者が誤って削除した情報を復元できるように提供しなければなりません。 利用者が選択したアクションに対して、確認をするように要求を提示して、利用者が確定または取り消す事ができるようにしなければなりません",');d.writeln('"IFC1019": "レベル2,【G134】【G192】【H88】【H74】【H75】ページをバリデート検証してください ※この項目は、バリデーションツールを用いて確認してください。（例：W3Cバリデーションツール）",');d.writeln('"IFC1020": "レベル3,【G108】【H91】【H44】【H64】【H65】【H88】標準的な HTML のコントロールだけを用いて書かれているかを判定してください",');d.writeln('"IFC1021": "レベル3,【Ｇ135】【G10】スクリプトやプログラムを使用したページの場合、コンポーネントがWCAG2.0またはJISX8341-3:2010に準拠した内容かを判定してください",');d.writeln('"SCR21": "レベル3,ページ内にコンテンツを動的に生成する機能が用意されている場合、Document.write()、innnerHTML、outerHTML、innerText、またはouter Textを用いて生成されていないかを判定してください",');d.writeln('};');d.writeln('var lvs = {');d.writeln('"レベル1": "7.1.1.1,7.1.2.1,7.1.2.2,7.1.2.3,7.1.2.4,7.1.2.5,7.1.4.2,7.1.4.3,7.2.3.1,7.2.4.2,7.3.1.1,7.3.1.2,7.3.2.1,7.3.2.2",');d.writeln('"レベル2": "7.1.3.1,7.1.3.2,7.1.3.3,7.1.4.1,7.1.4.4,7.1.4.5,7.2.4.5,7.2.4.6,7.2.4.7,7.3.2.3,7.3.2.4,7.4.1.1",');d.writeln('"レベル3": "7.2.1.1,7.2.1.2,7.2.2.1,7.2.2.2,7.2.4.1,7.2.4.3,7.2.4.4,7.3.3.1,7.3.3.2,7.3.3.3,7.3.3.4,7.4.1.2"');d.writeln('};');d.writeln('function create_summary(){');d.writeln('var target = document.getElementById("results");');d.writeln('target.innerHTML = "";');d.writeln('var src = document.getElementById("guideline_id");');d.writeln('var guideline_id = src.options[src.selectedIndex].text;');d.writeln('var desctext = "";');d.writeln('for(var key in lvs){');d.writeln('var lvsrow = lvs[key].toString();');d.writeln('var lvstmp = lvsrow.split(",");');d.writeln('for(var i=0; i<lvstmp.length; i++){');d.writeln('if(guideline_id==lvstmp[i].toString()){');d.writeln('desctext = "<strong>達成基準：</strong>" + guideline_id + " (" + key + ")";');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('}');d.writeln('document.getElementById("desc").innerHTML = desctext;');d.writeln('var tmp = new Array();');d.writeln('var result_text = "";');d.writeln('var dl = document.getElementById("results");');d.writeln('dl.innerHTML = "";');d.writeln('for(var key in techs){');d.writeln('if(key == guideline_id){');d.writeln('var val = techs[key].toString();');d.writeln('tmp = val.split(",");');d.writeln('for(var i=0; i < tmp.length; i++){');d.writeln('var line = tmp[i].toString();');d.writeln('var dt1 = document.createElement("dt");');d.writeln('dt1.setAttribute("class", "first");');d.writeln('dt1.textContent = line;');d.writeln('dl.appendChild(dt1);');d.writeln('var deepline = smry[line].toString();');d.writeln('var deeptmp = new Array();');d.writeln('deeptmp = deepline.split(",");');d.writeln('var dd1 = document.createElement("dd");');d.writeln('dd1.textContent = deeptmp[1].toString();');d.writeln('dl.appendChild(dd1);');d.writeln('}');d.writeln('}');d.writeln('}');d.writeln('}');d.writeln('function create_techs(){');d.writeln('var select = document.getElementById("technique_id");');d.writeln('select.innerHTML = "";');d.writeln('var src = document.getElementById("guideline_id");');d.writeln('var guideline_id = src.options[src.selectedIndex].text;');d.writeln('var tmp = new Array();');d.writeln('for(var key in techs){');d.writeln('if(key == guideline_id){');d.writeln('var val = techs[key].toString();');d.writeln('tmp = val.split(",");');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('for(var i=0; i < tmp.length; i++){');d.writeln('var elm = document.createElement("option");');d.writeln('elm.setAttribute("value", tmp[i].toString());');d.writeln('elm.textContent = tmp[i].toString();');d.writeln('select.appendChild(elm);');d.writeln('}');d.writeln('}');d.writeln('</script>');d.writeln('<h1>検査内容参照</small></h1>');d.writeln('<label for="all_text">JIS番号と実装番号：</label>');d.writeln('<select id="guideline_id" onchange="create_techs()"></select>');d.writeln('<select id="technique_id"></select>');d.writeln('<button onclick="create_summary()">参照実行</button><br>');d.writeln('<p id="desc"></p>');d.writeln('<dl id="results"></dl>');d.writeln('</body>');d.writeln('</html>');var gdselect = d.getElementById("guideline_id");for(var i=0; i<guidelines.length; i++){var row = guidelines[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;gdselect.appendChild(opt);}}})();


//サンドウィッチマン
javascript:(function(){
	var s='「|」,<span style="postion:absolute;top:0;left:-9999px;">|</span>';
	s = myencode(s);
	var arr = new Array();
	var sarr = s.split(",");
	if(sarr!=null){
		for(var i=0; i<sarr.length; i++){
			arr.push(sarr[i].toString());
		}
	}
	var str = window.getSelection().toString();
	trgr();
	function trgr(){
		d = window.open().document;
		d.write('<!DOCTYPE html>');
		d.write('<html lang="ja">');
		d.write('<head>');
		d.write('<meta charset="utf-8">');
		d.write('<title>Sandwichman</title>');
		d.write('<style type="text/css">');
		d.write('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.write('h1 {font-size: 170%;}');
		d.write('#desc,label {font-size: 90%;}');
		d.write('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');
		d.write('#all_text {width: 160px;}');
		d.write('#results {font-size:80%; width: 100%; height: 5em;}');
		d.write('</style>');
		d.write('</head>');
		d.write('<body>');
		d.write('<script type="text/javascript">');
		d.write('function cook(){');
		d.write('var text = document.getElementById("content").value;');
		d.write('var elm = document.getElementById("blaket");');
		d.write('var startt = "";');
		d.write('var endt = "";');
		d.write('for(var i=0; i<elm.options.length; i++){');
		d.write('if(elm.options[i].selected==true){');
		d.write('var row = elm.options[i].text;');
		d.write('var arr = row.split(" と ");');
		d.write('if(arr!=null){');
		d.write('startt = arr[0].toString();');
		d.write('endt = arr[1].toString();');
		d.write('}');
		d.write('}');
		d.write('}');
		d.write('var complete = startt + text + endt;');
		d.write('document.getElementById("results").value=complete;');
		d.write('}');
		d.write('</script>');
		d.write('<h1>Sandwichman</h1>');
		d.write('<label>ブラケット</label>');
		d.write('<select id="blaket"></select>');
		d.write('<label>内容</label>');
		d.write('<input type="text" id="content">');
		d.write('<button onclick="cook()">Cook</button><br>');
		d.write('<textarea id="results"></textarea>');
		d.write('</body>');
		d.write('</html>');
		d.getElementById("content").value=str;
		var elm = d.getElementById("blaket");
		for(var i=0; i<arr.length; i++){
			var opt = d.createElement("option");
			opt.setAttribute("value",i);
			var row = arr[i].toString();
			row = row.replace("|", " と ");
			opt.innerHTML = row;
			elm.appendChild(opt);
		}
	}
	function myencode(str){
		str = str.replace(/</g, "&lt;");
		str = str.replace(/>/g, "&gt;");
		return str;
	}
})();

javascript:(function(){var s='「|」,<span style="postion:absolute;top:0;left:-9999px;">|</span>';s = myencode(s);var arr = new Array();var sarr = s.split(",");if(sarr!=null){for(var i=0; i<sarr.length; i++){arr.push(sarr[i].toString());}}var str = window.getSelection().toString();trgr();function trgr(){d = window.open().document;d.write('<!DOCTYPE html>');d.write('<html lang="ja">');d.write('<head>');d.write('<meta charset="utf-8">');d.write('<title>Sandwichman</title>');d.write('<style type="text/css">');d.write('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.write('h1 {font-size: 170%;}');d.write('#desc,label {font-size: 90%;}');d.write('em {font-size: 70%;font-style:normal;font-weight:bold;color:#C00000;}');d.write('#all_text {width: 160px;}');d.write('#results {font-size:80%; width: 100%; height: 5em;}');d.write('</style>');d.write('</head>');d.write('<body>');d.write('<script type="text/javascript">');d.write('function cook(){');d.write('var text = document.getElementById("content").value;');d.write('var elm = document.getElementById("blaket");');d.write('var startt = "";');d.write('var endt = "";');d.write('for(var i=0; i<elm.options.length; i++){');d.write('if(elm.options[i].selected==true){');d.write('var row = elm.options[i].text;');d.write('var arr = row.split(" と ");');d.write('if(arr!=null){');d.write('startt = arr[0].toString();');d.write('endt = arr[1].toString();');d.write('}');d.write('}');d.write('}');d.write('var complete = startt + text + endt;');d.write('document.getElementById("results").value=complete;');d.write('}');d.write('</script>');d.write('<h1>Sandwichman</h1>');d.write('<label>ブラケット</label>');d.write('<select id="blaket"></select>');d.write('<label>内容</label>');d.write('<input type="text" id="content">');d.write('<button onclick="cook()">Cook</button><br>');d.write('<textarea id="results"></textarea>');d.write('</body>');d.write('</html>');d.getElementById("content").value=str;var elm = d.getElementById("blaket");for(var i=0; i<arr.length; i++){var opt = d.createElement("option");opt.setAttribute("value",i);var row = arr[i].toString();row = row.replace("|", " と ");opt.innerHTML = row;elm.appendChild(opt);}}function myencode(str){str = str.replace(/</g, "&lt;");str = str.replace(/>/g, "&gt;");return str;}})();

//objectタグを別タブで
javascript:(function(){
	var urlval="";
	var url="";
	var str="";
	var rdmuri = "";
	var element=document.getElementById("urlList");
	for(var i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;break;
		}
	}
	var arr=urlval.match(/http.*\/\/.*?\//);
	url=arr[0].toString();
	var rang = window.getSelection().toString();
	rang = clean(rang);
	var dpat = new RegExp(/data=\"(.*?)\"/);
	var tpat = new RegExp(/<.*?>/g);
	var mpat = new RegExp(/name=\"movie\"/);
	var vpat = new RegExp(/value=\"(.*?)\"/);
	var cpat = new RegExp(/<\!\-\-.*?>/);
	var darr = rang.match(dpat);
	var tarr = rang.match(tpat);
	if(tarr!=null){
		var afrang = "";
		for(var i=0; i<tarr.length; i++){
			var row = tarr[i].toString();
			var marr = row.match(mpat);
			if(marr!=null){
				var varr = row.match(vpat);
				if(varr!=null){
					rdmuri = url+varr[1].toString();
					row = row.replace(vpat, 'value="'+rdmuri+'"');
				}
			}
			var carr = row.match(cpat);
			if(carr==null){
				afrang += row;
			}
		}
		rang = afrang;
	}
	if(darr!=null){
		rdmuri = url+darr[1].toString();
		rang = rang.replace(dpat, 'data="'+rdmuri+'"');
	}
	trgr();
	function trgr() {
		d = window.open().document;
		d.write(rang);

	}
	function clean(str){
	    str=str.replace(/^ +/m,"");
	    str=str.replace(/\t+/m,"");
	    str=str.replace(/(\r\n|\r|\n)/g,""); 
	    return str;
	}

})();

javascript:(function(){var urlval="";var url="";var str="";var rdmuri = "";var element=document.getElementById("urlList");for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var arr=urlval.match(/http.*\/\/.*?\//);url=arr[0].toString();var rang = window.getSelection().toString();rang = clean(rang);var dpat = new RegExp(/data=\"(.*?)\"/);var tpat = new RegExp(/<.*?>/g);var mpat = new RegExp(/name=\"movie\"/);var vpat = new RegExp(/value=\"(.*?)\"/);var cpat = new RegExp(/<\!\-\-.*?>/);var darr = rang.match(dpat);var tarr = rang.match(tpat);if(tarr!=null){var afrang = "";for(var i=0; i<tarr.length; i++){var row = tarr[i].toString();var marr = row.match(mpat);if(marr!=null){var varr = row.match(vpat);if(varr!=null){rdmuri = url+varr[1].toString();row = row.replace(vpat, 'value="'+rdmuri+'"');}}var carr = row.match(cpat);if(carr==null){afrang += row;}}rang = afrang;}if(darr!=null){rdmuri = url+darr[1].toString();rang = rang.replace(dpat, 'data="'+rdmuri+'"');}trgr();function trgr() {d = window.open().document;d.write(rang);}function clean(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;}})();


//ビューを切り替え
javascript:(function(){
	var mode=2;/*1=pgview,2=srcview,3=relview*/
	var atags = document.getElementsByTagName("a");
	for(var i=0; i<atags.length; i++){
	  var atag = atags.item(i);
	  if(atag.getAttribute("href")=="#tabs-"+mode){
	  	atag.click();
	  	break;
	  }
	}
})();

javascript:(function(){var mode=2;/*1=pgview,2=srcview,3=relview*/var atags = document.getElementsByTagName("a");for(var i=0; i<atags.length; i++){var atag = atags.item(i);if(atag.getAttribute("href")=="#tabs-"+mode){atag.click();break;}}})();

//マイエディタ
javascript:(function(){
	trgr();
	function trgr(){
		d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>MyEditor</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('ul {margin:0;padding:0 0 0 10px;}');
		d.writeln('ul li {color:#4040FF; text-decoration: underline; font-size: 90%;}');
		d.writeln('#editor {font-size:80%; width: 100%; height: 20em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('var strg = window.localStorage;');
		d.writeln('function list_update() {');
		d.writeln('document.getElementById("files").innerHTML = "";');
		d.writeln('for (var i = 0; i < strg.length; i++) {');
		d.writeln('var key = strg.key(i);');
		d.writeln('var dat = strg.getItem(key);');
		d.writeln('var uls = document.getElementById("files");');
		d.writeln('var li = document.createElement("li");');
		d.writeln('li.setAttribute("id", "file-" + i);');
		d.writeln('uls.appendChild(li);');
		d.writeln('var lir = document.getElementById("file-" + i);');
		d.writeln('var at = document.createElement("a");');
		d.writeln('at.setAttribute("onclick", "myeditor_load(\'" + key + "\')");');
		d.writeln('at.innerHTML = key;');
		d.writeln('lir.appendChild(at);');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function myeditor_save() {');
		d.writeln('var filename = document.getElementById("filename").value;');
		d.writeln('var pat = new RegExp(/[a-zA-Z0-9_ \-]+/);');
		d.writeln('if (filename !== "") {');
		d.writeln('if (filename.match(pat)) {');
		d.writeln('var contents = document.getElementById("editor").value;');
		d.writeln('try{');
		d.writeln('strg.setItem(filename, contents);');
		d.writeln('alert("保存が完了しました！");');
		d.writeln('}catch(e){');
		d.writeln('alert("Error:" + e);');
		d.writeln('}finally{}');
		d.writeln('list_update();');
		d.writeln('list_update();');
		d.writeln('} else {');
		d.writeln('alert("ファイル名は半角文字で、英字・数字・ハイフン(-)・アンダーバー(_)だけが使用できます!");');
		d.writeln('}');
		d.writeln('} else {');
		d.writeln('alert("ファイル名が入力されていません！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function clear_text() {');
		d.writeln('document.getElementById("contents").value = "";');
		d.writeln('}');
		d.writeln('function myeditor_load(name) {');
		d.writeln('var contents = strg.getItem(name);');
		d.writeln('document.getElementById("editor").value = contents;');
		d.writeln('document.getElementById("filename").value = name;');
		d.writeln('}');
		d.writeln('function myeditor_delete() {');
		d.writeln('var filename = document.getElementById("filename").value;');
		d.writeln('if (filename !== "") {');
		d.writeln('var contents = document.getElementById("editor").value;');
		d.writeln('try {');
		d.writeln('strg.removeItem(filename);');
		d.writeln('document.getElementById("filename").value = "";');
		d.writeln('document.getElementById("editor").value = "";');
		d.writeln('} catch (e) {');
		d.writeln('alert("Error:" + e);');
		d.writeln('} finally { }');
		d.writeln('list_update();');
		d.writeln('} else {');
		d.writeln('alert("ファイル名が指定されていません！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function myeditor_deletall() {');
		d.writeln('alert("本当に全てのファイルを削除しますか？");');
		d.writeln('strg.clear();');
		d.writeln('document.getElementById("filename").value = "";');
		d.writeln('document.getElementById("editor").value = "";');
		d.writeln('list_update();');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>MyEditor</h1>');
		d.writeln('<dl>');
		d.writeln('<dt>File Lists:<button onclick="list_update()">Load</button></dt>');
		d.writeln('<dd><ul id="files"></ul></dd>');
		d.writeln('</dl>');
		d.writeln('<label for="filename">File Name:</label>');
		d.writeln('<input type="text" id="filename">');
		d.writeln('<button onclick="myeditor_save()">Save</button>');
		d.writeln('<button onclick="clear_text()">Clear</button>');
		d.writeln('<button onclick="myeditor_delete()">Delete</button>');
		d.writeln('<button onclick="myeditor_deletall()">DelAll</button>');
		d.writeln('<textarea id="editor"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
	}
})();

javascript:(function(){trgr();function trgr(){d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>MyEditor</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('ul {margin:0;padding:0 0 0 10px;}');d.writeln('ul li {color:#4040FF; text-decoration: underline; font-size: 90%;}');d.writeln('#editor {font-size:80%; width: 100%; height: 20em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('var strg = window.localStorage;');d.writeln('function list_update() {');d.writeln('document.getElementById("files").innerHTML = "";');d.writeln('for (var i = 0; i < strg.length; i++) {');d.writeln('var key = strg.key(i);');d.writeln('var dat = strg.getItem(key);');d.writeln('var uls = document.getElementById("files");');d.writeln('var li = document.createElement("li");');d.writeln('li.setAttribute("id", "file-" + i);');d.writeln('uls.appendChild(li);');d.writeln('var lir = document.getElementById("file-" + i);');d.writeln('var at = document.createElement("a");');d.writeln('at.setAttribute("onclick", "myeditor_load(\'" + key + "\')");');d.writeln('at.innerHTML = key;');d.writeln('lir.appendChild(at);');d.writeln('}');d.writeln('}');d.writeln('function myeditor_save() {');d.writeln('var filename = document.getElementById("filename").value;');d.writeln('var pat = new RegExp(/[a-zA-Z0-9_ \-]+/);');d.writeln('if (filename !== "") {');d.writeln('if (filename.match(pat)) {');d.writeln('var contents = document.getElementById("editor").value;');d.writeln('try{');d.writeln('strg.setItem(filename, contents);');d.writeln('alert("保存が完了しました！");');d.writeln('}catch(e){');d.writeln('alert("Error:" + e);');d.writeln('}finally{}');d.writeln('list_update();');d.writeln('list_update();');d.writeln('} else {');d.writeln('alert("ファイル名は半角文字で、英字・数字・ハイフン(-)・アンダーバー(_)だけが使用できます!");');d.writeln('}');d.writeln('} else {');d.writeln('alert("ファイル名が入力されていません！");');d.writeln('}');d.writeln('}');d.writeln('function clear_text() {');d.writeln('document.getElementById("contents").value = "";');d.writeln('}');d.writeln('function myeditor_load(name) {');d.writeln('var contents = strg.getItem(name);');d.writeln('document.getElementById("editor").value = contents;');d.writeln('document.getElementById("filename").value = name;');d.writeln('}');d.writeln('function myeditor_delete() {');d.writeln('var filename = document.getElementById("filename").value;');d.writeln('if (filename !== "") {');d.writeln('var contents = document.getElementById("editor").value;');d.writeln('try {');d.writeln('strg.removeItem(filename);');d.writeln('document.getElementById("filename").value = "";');d.writeln('document.getElementById("editor").value = "";');d.writeln('} catch (e) {');d.writeln('alert("Error:" + e);');d.writeln('} finally { }');d.writeln('list_update();');d.writeln('} else {');d.writeln('alert("ファイル名が指定されていません！");');d.writeln('}');d.writeln('}');d.writeln('function myeditor_deletall() {');d.writeln('alert("本当に全てのファイルを削除しますか？");');d.writeln('strg.clear();');d.writeln('document.getElementById("filename").value = "";');d.writeln('document.getElementById("editor").value = "";');d.writeln('list_update();');d.writeln('}');d.writeln('</script>');d.writeln('<h1>MyEditor</h1>');d.writeln('<dl>');d.writeln('<dt>File Lists:<button onclick="list_update()">Load</button></dt>');d.writeln('<dd><ul id="files"></ul></dd>');d.writeln('</dl>');d.writeln('<label for="filename">File Name:</label>');d.writeln('<input type="text" id="filename">');d.writeln('<button onclick="myeditor_save()">Save</button>');d.writeln('<button onclick="clear_text()">Clear</button>');d.writeln('<button onclick="myeditor_delete()">Delete</button>');d.writeln('<button onclick="myeditor_deletall()">DelAll</button>');d.writeln('<textarea id="editor"></textarea>');d.writeln('</body>');d.writeln('</html>');}})();

//H2自動修正
javascript:(function(){
	click_for("FAIL");
	var linktag = "";
	var imgtag = "";
	var alttxt = "";
	var rdmlinktag = "";
	var rdmimgtag = "";
	linktag=document.getElementById("srccode").value;
	linktag = clean(linktag);
	var pat0 = new RegExp(/(<.*?>)(.+?)(<\/.*?>)/);
	var arr0 = linktag.match(pat0);
	if(arr0!==null){
		imgtag = arr0[2].toString();
	}
	var pat1 = new RegExp(/alt=\"*(.*?)\"/);
	var arr1 = imgtag.match(pat1);
	if(arr1!==null){
		alttxt = arr1[1].toString();
	}
	rdmimgtag = imgtag.replace(pat1, 'alt=""');
	rdmlinktag = arr0[1].toString() + rdmimgtag + alttxt + arr0[3].toString();
	document.getElementById("srccode").value=rdmlinktag;
	set_comment("同じリンク先の隣り合うa要素は、単一のa要素で記述する");
	click_for_submit();

	/*コメント挿入関数*/
	function set_comment(str){
		document.getElementById("comments").value = str;
	}
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
	/*登録ボタンクリック関数*/
	function click_for_submit(){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].type;
			if(obj=="submit"){
				form.elements[i].click();
				break;
			}
		}
	}
	/*行頭のspace,tab,改行除去関数*/
    function clean(str){
    str=str.replace(/^ +/m,"");
    str=str.replace(/\t+/m,"");
    str=str.replace(/(\r\n|\r|\n)/g,""); 
    return str;
  }
})();

javascript:(function(){click_for("FAIL");var linktag = "";var imgtag = "";var alttxt = "";var rdmlinktag = "";var rdmimgtag = "";linktag=document.getElementById("srccode").value;linktag = clean(linktag);var pat0 = new RegExp(/(<.*?>)(.+?)(<\/.*?>)/);var arr0 = linktag.match(pat0);if(arr0!==null){imgtag = arr0[2].toString();}var pat1 = new RegExp(/alt=\"*(.*?)\"/);var arr1 = imgtag.match(pat1);if(arr1!==null){alttxt = arr1[1].toString();}rdmimgtag = imgtag.replace(pat1, 'alt=""');rdmlinktag = arr0[1].toString() + rdmimgtag + alttxt + arr0[3].toString();document.getElementById("srccode").value=rdmlinktag;set_comment("同じリンク先の隣り合うa要素は、単一のa要素で記述する");click_for_submit();/*コメント挿入関数*/function set_comment(str){document.getElementById("comments").value = str;}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}/*登録ボタンクリック関数*/function click_for_submit(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}}/*行頭のspace,tab,改行除去関数*/function clean(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;}})();

//JSレポート
javascript:(function(){

	var scarr = new Array();
	var scp = document.getElementsByTagName("script");
	var os_cnt = 0;
	var is_cnt = 0;
	for(var i=0; i<scp.length; i++){
	  var cnt = scarr.length;
	  scarr[cnt] = new Array();
	  if(scp.item(i).src!==""){
	    var row = scp.item(i).src;
	    var scp_name = get_script_name(row);
	    scarr[cnt].push(scp_name);
	    scarr[cnt].push('<a href="' + row + '" target="_blank">' + row + '</a>');
	    scarr[cnt].push("outer");
	    os_cnt++;
	  }else{
	    scarr[cnt].push('Inline-script');
	    scarr[cnt].push('<pre>'+scp.item(i).innerHTML+'</pre>');
	    scarr[cnt].push("inner");
	    is_cnt++;
	  }
	}

	trgr();

	function get_script_name(str){
	  var ret = "";
	  var pat = new RegExp(/http.*\/(.*\..*)/);
	  var arr = str.match(pat);
	  if(arr!==null){
	    ret = arr[1].toString();
	  }
	  return ret;
	}
	    

	function trgr(){
	    d = window.open().document;
		d.write('<!DOCTYPE html><head>');
		d.write('<title>JSレポート</title>');
		d.write('<style>');
	    d.write('* {font-family:"メイリオ",Meiryo;}');
		d.write('h1 {font-family:"メイリオ",Meiryo;}');
		d.write('.pickup { background:#ffeecc;font-weight:bold;}');
		d.write('.caution {color:red;font-size:90%;font-weight:bold;background:yellow;}');
		d.write('.docpickup {color:red;font-size:90%;font-weight:bold;background:#C0FFFF;}');
		d.write('#srcrepo {font-family:"メイリオ",Meiryo;}');
		d.write('#srcrepo dt {margin-bottom:8px; font-size:96%;}');
		d.write('#srcrepo dd {font-size:80%;background:#FFFFC0;margin:0 0 8px 20px;}');
		d.write('</style>');
		d.write('</head><body>');
		d.write('<h1>JSレポート</h1>');
	    d.write('<p><strong>外部スクリプト:</strong> '+os_cnt+'&nbsp;&nbsp;&nbsp;&nbsp;<strong>内部スクリプト:</strong> '+is_cnt);
		d.write('</body></html>');
	    var bd = d.getElementsByTagName("body").item(0);
	    var dl = d.createElement("dl");
	    dl.setAttribute("id", "scprepo");
	    bd.appendChild(dl);
	    var tdl = d.getElementById("scprepo");
	    for(var i=0; i<scarr.length; i++){
	      var dt = d.createElement("dt");
	      dt.innerHTML = scarr[i][0].toString();
	      tdl.appendChild(dt);
	      var tp = scarr[i][2].toString();

	      if(tp=="outer"){
	        var dd = d.createElement("dd");
	        dd.innerHTML = scarr[i][1].toString();
	        tdl.appendChild(dd);
	      }else{
	        var dd = d.createElement("dd");
	        dd.setAttribute("id", "dd-r"+i);
	        tdl.appendChild(dd);
	        var tdd = d.getElementById("dd-r"+i);
	        var pre = d.createElement("pre");
	        pre.textContent = scarr[i][1].toString();
	        tdd.appendChild(pre);
	      }
	    }
	}

})();

javascript:(function(){var scarr = new Array();var scp = document.getElementsByTagName("script");var os_cnt = 0;var is_cnt = 0;for(var i=0; i<scp.length; i++){var cnt = scarr.length;scarr[cnt] = new Array();if(scp.item(i).src!==""){var row = scp.item(i).src;var scp_name = get_script_name(row);scarr[cnt].push(scp_name);scarr[cnt].push('<a href="' + row + '" target="_blank">' + row + '</a>');scarr[cnt].push("outer");os_cnt++;}else{scarr[cnt].push('Inline-script');scarr[cnt].push('<pre>'+scp.item(i).innerHTML+'</pre>');scarr[cnt].push("inner");is_cnt++;}}trgr();function get_script_name(str){var ret = "";var pat = new RegExp(/http.*\/(.*\..*)/);var arr = str.match(pat);if(arr!==null){ret = arr[1].toString();}return ret;}function trgr(){d = window.open().document;d.write('<!DOCTYPE html><head>');d.write('<title>JSレポート</title>');d.write('<style>');d.write('* {font-family:"メイリオ",Meiryo;}');d.write('h1 {font-family:"メイリオ",Meiryo;}');d.write('.pickup { background:#ffeecc;font-weight:bold;}');d.write('.caution {color:red;font-size:90%;font-weight:bold;background:yellow;}');d.write('.docpickup {color:red;font-size:90%;font-weight:bold;background:#C0FFFF;}');d.write('#srcrepo {font-family:"メイリオ",Meiryo;}');d.write('#srcrepo dt {margin-bottom:8px; font-size:96%;}');d.write('#srcrepo dd {font-size:80%;background:#FFFFC0;margin:0 0 8px 20px;}');d.write('</style>');d.write('</head><body>');d.write('<h1>JSレポート</h1>');d.write('<p><strong>外部スクリプト:</strong> '+os_cnt+'&nbsp;&nbsp;&nbsp;&nbsp;<strong>内部スクリプト:</strong> '+is_cnt);d.write('</body></html>');var bd = d.getElementsByTagName("body").item(0);var dl = d.createElement("dl");dl.setAttribute("id", "scprepo");bd.appendChild(dl);var tdl = d.getElementById("scprepo");for(var i=0; i<scarr.length; i++){var dt = d.createElement("dt");dt.innerHTML = scarr[i][0].toString();tdl.appendChild(dt);var tp = scarr[i][2].toString();if(tp=="outer"){var dd = d.createElement("dd");dd.innerHTML = scarr[i][1].toString();tdl.appendChild(dd);}else{var dd = d.createElement("dd");dd.setAttribute("id", "dd-r"+i);tdl.appendChild(dd);var tdd = d.getElementById("dd-r"+i);var pre = d.createElement("pre");pre.textContent = scarr[i][1].toString();tdd.appendChild(pre);}}}})();

//不正dlタグの修正
javascript:(function(){
	click_for("FAIL");
	var src = document.getElementById("srccode").value;
	src = clean(src);
	var ddintxt = "";
	var pat = new RegExp(/(<dd.*?>)(.*?)(<\/dd>)/);
	var arr = src.match(pat);
	if(arr!==null){
		ddintxt = arr[2].toString();
	}
	if(ddintxt!==""){
		document.getElementById("srccode").value=ddintxt;
	}
	set_comment("レイアウト目的でdl要素を使用すべきでない");
	click_for_submit();

	/*コメント挿入関数*/
	function set_comment(str){
		document.getElementById("comments").value = str;
	}
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
	/*登録ボタンクリック関数*/
	function click_for_submit(){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].type;
			if(obj=="submit"){
				form.elements[i].click();
				break;
			}
		}
	}
	/*行頭のspace,tab,改行除去関数*/
    function clean(str){
    str=str.replace(/^ +/m,"");
    str=str.replace(/\t+/m,"");
    str=str.replace(/(\r\n|\r|\n)/g,""); 
    return str;
  }
})();

javascript:(function(){click_for("FAIL");var src = document.getElementById("srccode").value;src = clean(src);var ddintxt = "";var pat = new RegExp(/(<dd.*?>)(.*?)(<\/dd>)/);var arr = src.match(pat);if(arr!==null){ddintxt = arr[2].toString();}if(ddintxt!==""){document.getElementById("srccode").value=ddintxt;}set_comment("レイアウト目的でdl要素を使用すべきでない");click_for_submit();/*コメント挿入関数*/function set_comment(str){document.getElementById("comments").value = str;}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}/*登録ボタンクリック関数*/function click_for_submit(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}}/*行頭のspace,tab,改行除去関数*/function clean(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;}})();


//ソース表示、グループ表示の条件で再バリデート
javascript:(function(){
	var form = document.forms["form"];
	for(var i=0; i<form.elements.length; i++){
		var row = form.elements[i];
		if(row.name=="ss" && row.value=="1"){
			if(row.checked!==true){
				row.click();
			}
			break;
		}
	}
	for(var i=0; i<form.elements.length; i++){
		var row = form.elements[i];
		if(row.name=="group" && row.value=="1"){
			row.click();
			break;
		}
	}
	for(var i=0; i<form.elements.length; i++){
		var row = form.elements[i];
		if(row.type=="submit" && row.value=="Revalidate"){
			row.click();
			break;
		}
	}
})();

javascript:(function(){var form = document.forms["form"];for(var i=0; i<form.elements.length; i++){var row = form.elements[i];if(row.name=="ss" && row.value=="1"){if(row.checked!==true){row.click();}break;}}for(var i=0; i<form.elements.length; i++){var row = form.elements[i];if(row.name=="group" && row.value=="1"){row.click();break;}}for(var i=0; i<form.elements.length; i++){var row = form.elements[i];if(row.type=="submit" && row.value=="Revalidate"){row.click();break;}}})();

//W3Cコメントエディタ
javascript:(function(){
	var keywords = "●タグの中に●タグは置けない|●タグは非推奨要素|ulタグの直下に文字は置けない|コメントの書き方が不正|以下を削除する|中身が空のタグがある|開始タグがない/終了タグがない|タグが閉じられていない|XHTML1.0では空要素は />で閉じなければならない|XHTML1.0ではタグは小文字でなければならない|alt属性がない|&は&amp;としてください";
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>W3C-CE</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('#comments,#comments2 {min-width: 320px;}');
		d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function get_line_num(){');
		d.writeln('var src = document.getElementById("ta_before").value;');
		d.writeln('src = clean(src);');
		d.writeln('var pat = new RegExp(/, .+/g);');
		d.writeln('var arr = src.match(pat);');
		d.writeln('if(arr!==null){');
		d.writeln('src = src.replace(pat, "");');
		d.writeln('document.getElementById("ta_after").value = src;');
		d.writeln('}else{');
		d.writeln('alert("W3Cバリデータの結果が貼り付けられていません！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function tagline_delete(target){');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('var pat = new RegExp(/<.*/g);');
		d.writeln('var arr = src.match(pat);');
		d.writeln('if(arr!==null){');
		d.writeln('src = src.replace(pat, "");');
		d.writeln('document.getElementById(target).value = src;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function br2_delete(target){');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('src = src.replace(/^\\n+/mg, "");');
		d.writeln('document.getElementById(target).value=src;');
		d.writeln('}');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function this_text_insert(src, target){');
		d.writeln('var sc = document.getElementById(src);');
		d.writeln('var text = "";');
		d.writeln('for(var i=0; i<sc.options.length; i++){');
		d.writeln('var row = sc.options[i];');
		d.writeln('if(row.selected == true){');
		d.writeln('text = row.text;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('text_insert(target, text);');
		d.writeln('}');
		d.writeln('function copy_up(){');
		d.writeln('var src = document.getElementById("ta_sub").value;');
		d.writeln('document.getElementById("ta_after").value = src;');
		d.writeln('}');
		d.writeln('function copy_down(){');
		d.writeln('var src = document.getElementById("ta_after").value;');
		d.writeln('document.getElementById("ta_sub").value = src;');
		d.writeln('}');
		d.writeln('function delete_this_text(target){');
		d.writeln('document.getElementById(target).value="";');
		d.writeln('}');
		d.writeln('function delete_all_text(){');
		d.writeln('var tas = document.getElementsByTagName("textarea");');
		d.writeln('for(var i=0; i<tas.length; i++){');
		d.writeln('var row = tas.item(i);');
		d.writeln('row.value = "";');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function clean(str){');
		d.writeln('str=str.replace(/^ +/mg,"");');
		d.writeln('str=str.replace(/^\\t+/mg,"");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function tag_reference(){');
		d.writeln('window.open("http://www.tohoho-web.com/html/");');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>W3C Comment-Editor</h1>');
		d.writeln('<label for="ta_before">Before Text:</label>');
		d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');
		d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');
		d.writeln('<button onclick="tag_reference()">TagReference</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_before"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_after">After Text:</label>');
		d.writeln('<button onclick="get_line_num()">LineNum</button>');
		d.writeln('<button onclick="tagline_delete(\'ta_after\')">TagDel</button>');
		d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');
		d.writeln('<select id="comments"></select>');
		d.writeln('<button onclick="this_text_insert(\'comments\', \'ta_after\')">Insert</button>');
		d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_after"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_sub">Sub Text:</label>');
		d.writeln('<button onclick="copy_down()">CpDown</button>');
		d.writeln('<button onclick="copy_up()">CpUp</button>');
		d.writeln('<select id="comments2"></select>');
		d.writeln('<button onclick="this_text_insert(\'comments2\', \'ta_sub\')">Insert</button>');
		d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_sub"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
		var sc = d.getElementById("comments");
		var arr = keywords.split("|");
		if(arr!==null){
			arr = arr.reverse();
			for(var i=0; i<arr.length; i++){
				var opt = d.createElement("option");
				opt.setAttribute("value", i);
				opt.textContent = arr[i].toString();
				sc.appendChild(opt);
			}
		}
		var sc2 = d.getElementById("comments2");
		sc2.innerHTML = sc.innerHTML;
	}
})();

javascript:(function(){var keywords = "●タグの中に●タグは置けない|●タグは非推奨要素|ulタグの直下に文字は置けない|コメントの書き方が不正|以下を削除する|中身が空のタグがある|開始タグがない/終了タグがない|タグが閉じられていない|XHTML1.0では空要素は />で閉じなければならない|XHTML1.0ではタグは小文字でなければならない|alt属性がない|&は&amp;としてください";trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>W3C-CE</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('#comments,#comments2 {min-width: 320px;}');d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function get_line_num(){');d.writeln('var src = document.getElementById("ta_before").value;');d.writeln('src = clean(src);');d.writeln('var pat = new RegExp(/, .+/g);');d.writeln('var arr = src.match(pat);');d.writeln('if(arr!==null){');d.writeln('src = src.replace(pat, "");');d.writeln('document.getElementById("ta_after").value = src;');d.writeln('}else{');d.writeln('alert("W3Cバリデータの結果が貼り付けられていません！");');d.writeln('}');d.writeln('}');d.writeln('function tagline_delete(target){');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('var pat = new RegExp(/<.*/g);');d.writeln('var arr = src.match(pat);');d.writeln('if(arr!==null){');d.writeln('src = src.replace(pat, "");');d.writeln('document.getElementById(target).value = src;');d.writeln('}');d.writeln('}');d.writeln('function br2_delete(target){');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('src = src.replace(/^\\n+/mg, "");');d.writeln('document.getElementById(target).value=src;');d.writeln('}');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function this_text_insert(src, target){');d.writeln('var sc = document.getElementById(src);');d.writeln('var text = "";');d.writeln('for(var i=0; i<sc.options.length; i++){');d.writeln('var row = sc.options[i];');d.writeln('if(row.selected == true){');d.writeln('text = row.text;');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('text_insert(target, text);');d.writeln('}');d.writeln('function copy_up(){');d.writeln('var src = document.getElementById("ta_sub").value;');d.writeln('document.getElementById("ta_after").value = src;');d.writeln('}');d.writeln('function copy_down(){');d.writeln('var src = document.getElementById("ta_after").value;');d.writeln('document.getElementById("ta_sub").value = src;');d.writeln('}');d.writeln('function delete_this_text(target){');d.writeln('document.getElementById(target).value="";');d.writeln('}');d.writeln('function delete_all_text(){');d.writeln('var tas = document.getElementsByTagName("textarea");');d.writeln('for(var i=0; i<tas.length; i++){');d.writeln('var row = tas.item(i);');d.writeln('row.value = "";');d.writeln('}');d.writeln('}');d.writeln('function clean(str){');d.writeln('str=str.replace(/^ +/mg,"");');d.writeln('str=str.replace(/^\\t+/mg,"");');d.writeln('return str;');d.writeln('}');d.writeln('function tag_reference(){');d.writeln('window.open("http://www.tohoho-web.com/html/");');d.writeln('}');d.writeln('</script>');d.writeln('<h1>W3C Comment-Editor</h1>');d.writeln('<label for="ta_before">Before Text:</label>');d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');d.writeln('<button onclick="tag_reference()">TagReference</button>');d.writeln('<br>');d.writeln('<textarea id="ta_before"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_after">After Text:</label>');d.writeln('<button onclick="get_line_num()">LineNum</button>');d.writeln('<button onclick="tagline_delete(\'ta_after\')">TagDel</button>');d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');d.writeln('<select id="comments"></select>');d.writeln('<button onclick="this_text_insert(\'comments\', \'ta_after\')">Insert</button>');d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');d.writeln('<br>');d.writeln('<textarea id="ta_after"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_sub">Sub Text:</label>');d.writeln('<button onclick="copy_down()">CpDown</button>');d.writeln('<button onclick="copy_up()">CpUp</button>');d.writeln('<select id="comments2"></select>');d.writeln('<button onclick="this_text_insert(\'comments2\', \'ta_sub\')">Insert</button>');d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');d.writeln('<br>');d.writeln('<textarea id="ta_sub"></textarea>');d.writeln('</body>');d.writeln('</html>');var sc = d.getElementById("comments");var arr = keywords.split("|");if(arr!==null){arr = arr.reverse();for(var i=0; i<arr.length; i++){var opt = d.createElement("option");opt.setAttribute("value", i);opt.textContent = arr[i].toString();sc.appendChild(opt);}}var sc2 = d.getElementById("comments2");sc2.innerHTML = sc.innerHTML;}})();

//W3CコメントエディタV2
javascript:(function(){
	var keywords = "●タグの中に●タグは置けない|●タグは非推奨要素|ulタグの直下に文字は置けない|コメントの書き方が不正|以下を削除する|中身が空のタグがある|開始タグがない/終了タグがない|タグが閉じられていない|XHTML1.0では空要素は />で閉じなければならない|XHTML1.0ではタグは小文字でなければならない|alt属性がない|&は&amp;としてください";
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>W3C-CE</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('#comments,#comments2 {min-width: 320px;}');
		d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function get_line_num(){');
		d.writeln('var src = document.getElementById("ta_before").value;');
		d.writeln('src = clean(src);');
		d.writeln('var pat = new RegExp(/, .+/g);');
		d.writeln('var arr = src.match(pat);');
		d.writeln('if(arr!==null){');
		d.writeln('src = src.replace(pat, "");');
		d.writeln('document.getElementById("ta_after").value = src;');
		d.writeln('}else{');
		d.writeln('alert("W3Cバリデータの結果が貼り付けられていません！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function tagline_delete(target){');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('var pat = new RegExp(/<.*/g);');
		d.writeln('var arr = src.match(pat);');
		d.writeln('if(arr!==null){');
		d.writeln('src = src.replace(pat, "");');
		d.writeln('document.getElementById(target).value = src;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function br2_delete(target){');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('src = src.replace(/^\\n+/mg, "");');
		d.writeln('document.getElementById(target).value=src;');
		d.writeln('}');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function this_text_insert(src, target){');
		d.writeln('var sc = document.getElementById(src);');
		d.writeln('var text = "";');
		d.writeln('for(var i=0; i<sc.options.length; i++){');
		d.writeln('var row = sc.options[i];');
		d.writeln('if(row.selected == true){');
		d.writeln('text = row.text;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('text_insert(target, text);');
		d.writeln('}');
		d.writeln('function copy_up(){');
		d.writeln('var src = document.getElementById("ta_sub").value;');
		d.writeln('document.getElementById("ta_after").value = src;');
		d.writeln('}');
		d.writeln('function copy_down(){');
		d.writeln('var src = document.getElementById("ta_after").value;');
		d.writeln('document.getElementById("ta_sub").value = src;');
		d.writeln('}');
		d.writeln('function delete_this_text(target){');
		d.writeln('document.getElementById(target).value="";');
		d.writeln('}');
		d.writeln('function delete_all_text(){');
		d.writeln('var tas = document.getElementsByTagName("textarea");');
		d.writeln('for(var i=0; i<tas.length; i++){');
		d.writeln('var row = tas.item(i);');
		d.writeln('row.value = "";');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function clean(str){');
		d.writeln('str=str.replace(/^ +/mg,"");');
		d.writeln('str=str.replace(/^\\t+/mg,"");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function tag_reference(){');
		d.writeln('window.open("http://www.tohoho-web.com/html/");');
		d.writeln('}');
		d.writeln('function send_parent(from, target){');
		d.writeln('var src = document.getElementById(from).value;');
		d.writeln('window.opener.document.getElementById(target).value = src;');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>W3C Comment-Editor&nbsp;<small>(V2)</small></h1>');
		d.writeln('<label for="ta_before">Before Text:</label>');
		d.writeln('<button onclick="get_line_num()">LineNum</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');
		d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');
		d.writeln('<button onclick="tag_reference()">TagReference</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_before"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_after">After Text:</label>');
		d.writeln('<button onclick="tagline_delete(\'ta_after\')">TagDel</button>');
		d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');
		d.writeln('<select id="comments"></select>');
		d.writeln('<button onclick="this_text_insert(\'comments\', \'ta_after\')">Insert</button>');
		d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');
		d.writeln('<button onclick="send_parent(\'ta_after\',\'description\')">Send</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_after"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_sub">Sub Text:</label>');
		d.writeln('<button onclick="copy_down()">CpDown</button>');
		d.writeln('<button onclick="copy_up()">CpUp</button>');
		d.writeln('<select id="comments2"></select>');
		d.writeln('<button onclick="this_text_insert(\'comments2\', \'ta_sub\')">Insert</button>');
		d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');
		d.writeln('<button onclick="send_parent(\'ta_sub\',\'srccode\')">Send</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_sub"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
		var sc = d.getElementById("comments");
		var arr = keywords.split("|");
		if(arr!==null){
			arr = arr.reverse();
			for(var i=0; i<arr.length; i++){
				var opt = d.createElement("option");
				opt.setAttribute("value", i);
				opt.textContent = arr[i].toString();
				sc.appendChild(opt);
			}
		}
		var sc2 = d.getElementById("comments2");
		sc2.innerHTML = sc.innerHTML;
	}
})();

javascript:(function(){var keywords = "●タグの中に●タグは置けない|●タグは非推奨要素|ulタグの直下に文字は置けない|コメントの書き方が不正|以下を削除する|中身が空のタグがある|開始タグがない/終了タグがない|タグが閉じられていない|XHTML1.0では空要素は />で閉じなければならない|XHTML1.0ではタグは小文字でなければならない|alt属性がない|&は&amp;としてください";trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>W3C-CE</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('#comments,#comments2 {min-width: 320px;}');d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function get_line_num(){');d.writeln('var src = document.getElementById("ta_before").value;');d.writeln('src = clean(src);');d.writeln('var pat = new RegExp(/, .+/g);');d.writeln('var arr = src.match(pat);');d.writeln('if(arr!==null){');d.writeln('src = src.replace(pat, "");');d.writeln('document.getElementById("ta_after").value = src;');d.writeln('}else{');d.writeln('alert("W3Cバリデータの結果が貼り付けられていません！");');d.writeln('}');d.writeln('}');d.writeln('function tagline_delete(target){');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('var pat = new RegExp(/<.*/g);');d.writeln('var arr = src.match(pat);');d.writeln('if(arr!==null){');d.writeln('src = src.replace(pat, "");');d.writeln('document.getElementById(target).value = src;');d.writeln('}');d.writeln('}');d.writeln('function br2_delete(target){');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('src = src.replace(/^\\n+/mg, "");');d.writeln('document.getElementById(target).value=src;');d.writeln('}');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function this_text_insert(src, target){');d.writeln('var sc = document.getElementById(src);');d.writeln('var text = "";');d.writeln('for(var i=0; i<sc.options.length; i++){');d.writeln('var row = sc.options[i];');d.writeln('if(row.selected == true){');d.writeln('text = row.text;');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('text_insert(target, text);');d.writeln('}');d.writeln('function copy_up(){');d.writeln('var src = document.getElementById("ta_sub").value;');d.writeln('document.getElementById("ta_after").value = src;');d.writeln('}');d.writeln('function copy_down(){');d.writeln('var src = document.getElementById("ta_after").value;');d.writeln('document.getElementById("ta_sub").value = src;');d.writeln('}');d.writeln('function delete_this_text(target){');d.writeln('document.getElementById(target).value="";');d.writeln('}');d.writeln('function delete_all_text(){');d.writeln('var tas = document.getElementsByTagName("textarea");');d.writeln('for(var i=0; i<tas.length; i++){');d.writeln('var row = tas.item(i);');d.writeln('row.value = "";');d.writeln('}');d.writeln('}');d.writeln('function clean(str){');d.writeln('str=str.replace(/^ +/mg,"");');d.writeln('str=str.replace(/^\\t+/mg,"");');d.writeln('return str;');d.writeln('}');d.writeln('function tag_reference(){');d.writeln('window.open("http://www.tohoho-web.com/html/");');d.writeln('}');d.writeln('function send_parent(from, target){');d.writeln('var src = document.getElementById(from).value;');d.writeln('window.opener.document.getElementById(target).value = src;');d.writeln('}');d.writeln('</script>');d.writeln('<h1>W3C Comment-Editor&nbsp;<small>(V2)</small></h1>');d.writeln('<label for="ta_before">Before Text:</label>');d.writeln('<button onclick="get_line_num()">LineNum</button>');d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');d.writeln('<button onclick="tag_reference()">TagReference</button>');d.writeln('<br>');d.writeln('<textarea id="ta_before"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_after">After Text:</label>');d.writeln('<button onclick="tagline_delete(\'ta_after\')">TagDel</button>');d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');d.writeln('<select id="comments"></select>');d.writeln('<button onclick="this_text_insert(\'comments\', \'ta_after\')">Insert</button>');d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');d.writeln('<button onclick="send_parent(\'ta_after\',\'description\')">Send</button>');d.writeln('<br>');d.writeln('<textarea id="ta_after"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_sub">Sub Text:</label>');d.writeln('<button onclick="copy_down()">CpDown</button>');d.writeln('<button onclick="copy_up()">CpUp</button>');d.writeln('<select id="comments2"></select>');d.writeln('<button onclick="this_text_insert(\'comments2\', \'ta_sub\')">Insert</button>');d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');d.writeln('<button onclick="send_parent(\'ta_sub\',\'srccode\')">Send</button>');d.writeln('<br>');d.writeln('<textarea id="ta_sub"></textarea>');d.writeln('</body>');d.writeln('</html>');var sc = d.getElementById("comments");var arr = keywords.split("|");if(arr!==null){arr = arr.reverse();for(var i=0; i<arr.length; i++){var opt = d.createElement("option");opt.setAttribute("value", i);opt.textContent = arr[i].toString();sc.appendChild(opt);}}var sc2 = d.getElementById("comments2");sc2.innerHTML = sc.innerHTML;}})();

//V3
javascript:(function(){
	var keywords = "(以下を削除)| タグは開始されていない| タグが閉じられていない|●タグの中に●タグは置けない|●タグは非推奨要素|ulタグの直下に文字は置けない|コメントの書き方が不正|以下を削除する|中身が空のタグがある|開始タグがない/終了タグがない|タグが閉じられていない|XHTML1.0では空要素は />で閉じなければならない|XHTML1.0ではタグは小文字でなければならない|alt属性がない|&は&amp;としてください";
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>W3C-CE</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('#comments,#comments2 {min-width: 320px;}');
		d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function get_line_num(){');
		d.writeln('var src = document.getElementById("ta_before").value;');
		d.writeln('src = clean(src);');
		d.writeln('var pat = new RegExp(/, .+/g);');
		d.writeln('var arr = src.match(pat);');
		d.writeln('if(arr!==null){');
		d.writeln('src = src.replace(pat, "");');
		d.writeln('document.getElementById("ta_after").value = src;');
		d.writeln('}else{');
		d.writeln('alert("W3Cバリデータの結果が貼り付けられていません！");');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function tagline_delete(target){');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('var pat = new RegExp(/<.*/g);');
		d.writeln('var arr = src.match(pat);');
		d.writeln('if(arr!==null){');
		d.writeln('src = src.replace(pat, "");');
		d.writeln('document.getElementById(target).value = src;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function br2_delete(target){');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('src = src.replace(/^\\n+/mg, "");');
		d.writeln('document.getElementById(target).value=src;');
		d.writeln('}');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function this_text_insert(src, target){');
		d.writeln('var sc = document.getElementById(src);');
		d.writeln('var text = "";');
		d.writeln('for(var i=0; i<sc.options.length; i++){');
		d.writeln('var row = sc.options[i];');
		d.writeln('if(row.selected == true){');
		d.writeln('text = row.text;');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('}');
		d.writeln('text_insert(target, text);');
		d.writeln('}');
		d.writeln('function copy_up(){');
		d.writeln('var src = document.getElementById("ta_sub").value;');
		d.writeln('document.getElementById("ta_after").value = src;');
		d.writeln('}');
		d.writeln('function copy_down(){');
		d.writeln('var src = document.getElementById("ta_after").value;');
		d.writeln('document.getElementById("ta_sub").value = src;');
		d.writeln('}');
		d.writeln('function delete_this_text(target){');
		d.writeln('document.getElementById(target).value="";');
		d.writeln('}');
		d.writeln('function delete_all_text(){');
		d.writeln('var tas = document.getElementsByTagName("textarea");');
		d.writeln('for(var i=0; i<tas.length; i++){');
		d.writeln('var row = tas.item(i);');
		d.writeln('row.value = "";');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function clean(str){');
		d.writeln('str=str.replace(/^ +/mg,"");');
		d.writeln('str=str.replace(/^\\t+/mg,"");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function tag_reference(){');
		d.writeln('window.open("http://www.tohoho-web.com/html/");');
		d.writeln('}');
		d.writeln('function send_parent(from, target){');
		d.writeln('var src = document.getElementById(from).value;');
		d.writeln('window.opener.document.getElementById(target).value = src;');
		d.writeln('}');
		d.writeln('function data_export(){');
		d.writeln('var data_after = document.getElementById("ta_after").value;');
		d.writeln('var data_sub = document.getElementById("ta_sub").value;');
		d.writeln('var d = window.open().document;');
		d.writeln('d.writeln(\'<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><title>Export</title>\');');
		d.writeln('d.writeln(\'<style>*{font-family:"メイリオ",Meiryo,sans-serif;margin:0;}\');');
		d.writeln('d.writeln(\'h1{margin: 10px 0;}dt{margin:20px 0 8px 0;}pre{font-size:90%;}</style></head>\');');
		d.writeln('d.writeln(\'<body></body></html>\');');
		d.writeln('var pr = d.getElementsByTagName("body").item(0);');
		d.writeln('var elm_h1 = d.createElement("h1");');
		d.writeln('elm_h1.textContent = "Export";');
		d.writeln('pr.appendChild(elm_h1);');
		d.writeln('var elm_dl = d.createElement("dl");');
		d.writeln('elm_dl.setAttribute("id", "exportdl");');
		d.writeln('pr.appendChild(elm_dl);');
		d.writeln('var pr_elm = d.getElementById("exportdl");');
		d.writeln('var dt1 = d.createElement("dt");');
		d.writeln('dt1.innerHTML = "<strong>After Text:</strong>";');
		d.writeln('pr_elm.appendChild(dt1);');
		d.writeln('var pre1 = d.createElement("pre");');
		d.writeln('pre1.textContent = data_after;');
		d.writeln('pr_elm.appendChild(pre1);');
		d.writeln('var dt2 = d.createElement("dt");');
		d.writeln('dt2.innerHTML = "<strong>Sub Text:</strong>";');
		d.writeln('pr_elm.appendChild(dt2);');
		d.writeln('var pre2 = d.createElement("pre");');
		d.writeln('pre2.textContent = data_sub;');
		d.writeln('pr_elm.appendChild(pre2);');
		d.writeln('}');
		d.writeln('function browse_w3c_valid(){');
		d.writeln('window.open("http://validator.w3.org/#validate_by_input");');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>W3C Comment-Editor&nbsp;<small>(V2)</small></h1>');
		d.writeln('<label for="ta_before">Before Text:</label>');
		d.writeln('<button onclick="get_line_num()">LineNum</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');
		d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');
		d.writeln('<button onclick="tag_reference()">TagReference</button>');
		d.writeln('<button onclick="data_export()">Export</button>');
		d.writeln('<button onclick="browse_w3c_valid()">BrowseW3C</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_before"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_after">After Text:</label>');
		d.writeln('<button onclick="tagline_delete(\'ta_after\')">TagDel</button>');
		d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');
		d.writeln('<select id="comments"></select>');
		d.writeln('<button onclick="this_text_insert(\'comments\', \'ta_after\')">Insert</button>');
		d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');
		d.writeln('<button onclick="send_parent(\'ta_after\',\'description\')">Send</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_after"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_sub">Sub Text:</label>');
		d.writeln('<button onclick="copy_down()">CpDown</button>');
		d.writeln('<button onclick="copy_up()">CpUp</button>');
		d.writeln('<select id="comments2"></select>');
		d.writeln('<button onclick="this_text_insert(\'comments2\', \'ta_sub\')">Insert</button>');
		d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');
		d.writeln('<button onclick="send_parent(\'ta_sub\',\'srccode\')">Send</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_sub"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
		var sc = d.getElementById("comments");
		var arr = keywords.split("|");
		if(arr!==null){
			arr = arr.reverse();
			for(var i=0; i<arr.length; i++){
				var opt = d.createElement("option");
				opt.setAttribute("value", i);
				opt.textContent = arr[i].toString();
				sc.appendChild(opt);
			}
		}
		var sc2 = d.getElementById("comments2");
		sc2.innerHTML = sc.innerHTML;
	}
})();


javascript:(function(){var keywords = "(以下を削除)| タグは開始されていない| タグが閉じられていない|●タグの中に●タグは置けない|●タグは非推奨要素|ulタグの直下に文字は置けない|コメントの書き方が不正|以下を削除する|中身が空のタグがある|開始タグがない/終了タグがない|タグが閉じられていない|XHTML1.0では空要素は />で閉じなければならない|XHTML1.0ではタグは小文字でなければならない|alt属性がない|&は&amp;としてください";trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>W3C-CE</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('#comments,#comments2 {min-width: 320px;}');d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function get_line_num(){');d.writeln('var src = document.getElementById("ta_before").value;');d.writeln('src = clean(src);');d.writeln('var pat = new RegExp(/, .+/g);');d.writeln('var arr = src.match(pat);');d.writeln('if(arr!==null){');d.writeln('src = src.replace(pat, "");');d.writeln('document.getElementById("ta_after").value = src;');d.writeln('}else{');d.writeln('alert("W3Cバリデータの結果が貼り付けられていません！");');d.writeln('}');d.writeln('}');d.writeln('function tagline_delete(target){');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('var pat = new RegExp(/<.*/g);');d.writeln('var arr = src.match(pat);');d.writeln('if(arr!==null){');d.writeln('src = src.replace(pat, "");');d.writeln('document.getElementById(target).value = src;');d.writeln('}');d.writeln('}');d.writeln('function br2_delete(target){');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('src = src.replace(/^\\n+/mg, "");');d.writeln('document.getElementById(target).value=src;');d.writeln('}');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function this_text_insert(src, target){');d.writeln('var sc = document.getElementById(src);');d.writeln('var text = "";');d.writeln('for(var i=0; i<sc.options.length; i++){');d.writeln('var row = sc.options[i];');d.writeln('if(row.selected == true){');d.writeln('text = row.text;');d.writeln('break;');d.writeln('}');d.writeln('}');d.writeln('text_insert(target, text);');d.writeln('}');d.writeln('function copy_up(){');d.writeln('var src = document.getElementById("ta_sub").value;');d.writeln('document.getElementById("ta_after").value = src;');d.writeln('}');d.writeln('function copy_down(){');d.writeln('var src = document.getElementById("ta_after").value;');d.writeln('document.getElementById("ta_sub").value = src;');d.writeln('}');d.writeln('function delete_this_text(target){');d.writeln('document.getElementById(target).value="";');d.writeln('}');d.writeln('function delete_all_text(){');d.writeln('var tas = document.getElementsByTagName("textarea");');d.writeln('for(var i=0; i<tas.length; i++){');d.writeln('var row = tas.item(i);');d.writeln('row.value = "";');d.writeln('}');d.writeln('}');d.writeln('function clean(str){');d.writeln('str=str.replace(/^ +/mg,"");');d.writeln('str=str.replace(/^\\t+/mg,"");');d.writeln('return str;');d.writeln('}');d.writeln('function tag_reference(){');d.writeln('window.open("http://www.tohoho-web.com/html/");');d.writeln('}');d.writeln('function send_parent(from, target){');d.writeln('var src = document.getElementById(from).value;');d.writeln('window.opener.document.getElementById(target).value = src;');d.writeln('}');d.writeln('function data_export(){');d.writeln('var data_after = document.getElementById("ta_after").value;');d.writeln('var data_sub = document.getElementById("ta_sub").value;');d.writeln('var d = window.open().document;');d.writeln('d.writeln(\'<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8"><title>Export</title>\');');d.writeln('d.writeln(\'<style>*{font-family:"メイリオ",Meiryo,sans-serif;margin:0;}\');');d.writeln('d.writeln(\'h1{margin: 10px 0;}dt{margin:20px 0 8px 0;}pre{font-size:90%;}</style></head>\');');d.writeln('d.writeln(\'<body></body></html>\');');d.writeln('var pr = d.getElementsByTagName("body").item(0);');d.writeln('var elm_h1 = d.createElement("h1");');d.writeln('elm_h1.textContent = "Export";');d.writeln('pr.appendChild(elm_h1);');d.writeln('var elm_dl = d.createElement("dl");');d.writeln('elm_dl.setAttribute("id", "exportdl");');d.writeln('pr.appendChild(elm_dl);');d.writeln('var pr_elm = d.getElementById("exportdl");');d.writeln('var dt1 = d.createElement("dt");');d.writeln('dt1.innerHTML = "<strong>After Text:</strong>";');d.writeln('pr_elm.appendChild(dt1);');d.writeln('var pre1 = d.createElement("pre");');d.writeln('pre1.textContent = data_after;');d.writeln('pr_elm.appendChild(pre1);');d.writeln('var dt2 = d.createElement("dt");');d.writeln('dt2.innerHTML = "<strong>Sub Text:</strong>";');d.writeln('pr_elm.appendChild(dt2);');d.writeln('var pre2 = d.createElement("pre");');d.writeln('pre2.textContent = data_sub;');d.writeln('pr_elm.appendChild(pre2);');d.writeln('}');d.writeln('function browse_w3c_valid(){');d.writeln('window.open("http://validator.w3.org/#validate_by_input");');d.writeln('}');d.writeln('</script>');d.writeln('<h1>W3C Comment-Editor&nbsp;<small>(V2)</small></h1>');d.writeln('<label for="ta_before">Before Text:</label>');d.writeln('<button onclick="get_line_num()">LineNum</button>');d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');d.writeln('<button onclick="tag_reference()">TagReference</button>');d.writeln('<button onclick="data_export()">Export</button>');d.writeln('<button onclick="browse_w3c_valid()">BrowseW3C</button>');d.writeln('<br>');d.writeln('<textarea id="ta_before"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_after">After Text:</label>');d.writeln('<button onclick="tagline_delete(\'ta_after\')">TagDel</button>');d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');d.writeln('<select id="comments"></select>');d.writeln('<button onclick="this_text_insert(\'comments\', \'ta_after\')">Insert</button>');d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');d.writeln('<button onclick="send_parent(\'ta_after\',\'description\')">Send</button>');d.writeln('<br>');d.writeln('<textarea id="ta_after"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_sub">Sub Text:</label>');d.writeln('<button onclick="copy_down()">CpDown</button>');d.writeln('<button onclick="copy_up()">CpUp</button>');d.writeln('<select id="comments2"></select>');d.writeln('<button onclick="this_text_insert(\'comments2\', \'ta_sub\')">Insert</button>');d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');d.writeln('<button onclick="send_parent(\'ta_sub\',\'srccode\')">Send</button>');d.writeln('<br>');d.writeln('<textarea id="ta_sub"></textarea>');d.writeln('</body>');d.writeln('</html>');var sc = d.getElementById("comments");var arr = keywords.split("|");if(arr!==null){arr = arr.reverse();for(var i=0; i<arr.length; i++){var opt = d.createElement("option");opt.setAttribute("value", i);opt.textContent = arr[i].toString();sc.appendChild(opt);}}var sc2 = d.getElementById("comments2");sc2.innerHTML = sc.innerHTML;}})();

//H58自動判定
javascript:(function(){
	var langstr = prompt("言語属性値を指定してください（半角）","en");
	click_for("FAIL");
	var tag = "";
	var imgtag = "";
	var type = "text";
	var doctype = "";
	var rdmtag = "";
	tag=document.getElementById("srccode").value;
	doctype = get_doctype();
	tag = clean(tag);
	var pat0 = new RegExp(/(<.*?>)(.+?)(<\/.*?>)/);
	var arr0 = tag.match(pat0);
	if(arr0!==null){
		tag = arr0[2].toString();
	}
	var pat1 = new RegExp(/<img.*?>/);
	var arr1 = tag.match(pat1);
	if(arr1!==null){
		type = "img";
		imgtag = arr1[0].toString();
	}
	switch(type){
		case "text":
		  var firsttag = arr0[1].toString();
		  var content = arr0[2].toString();
		  var endtag = arr0[3].toString();
		  if(doctype=="xhtml"){
		  	firsttag = firsttag.replace('>',' xml:lang="'+langstr+'" lang="'+langstr+'">');
		  }else{
		  	firsttag = firsttag.replace('>','" lang="'+langstr+'">');
		  }
		  rdmtag = firsttag + content + endtag;
		  break;
		case "img":
		  if(doctype=="xhtml"){
		  	imgtag = imgtag.replace('<img', '<img xml:lang="'+langstr+'" lang="'+langstr+'"');
		  }else{
		  	imgtag = imgtag.replace('<img', '<img lang="'+langstr+'"');
		  }
		  rdmtag = imgtag;
		  break;
		default:
		  break;
	}
	document.getElementById("srccode").value=rdmtag;
	set_comment("lang属性（"+langstr+")が設定されていない");
	/*DOCTYPE判定関数*/
	function get_doctype(){
		var doctype = "";
		var type = "html";
		var　d=document.getElementById("source");
		var　dch=d.childNodes;
		try{doctype = dch.item(2).nodeValue;}finally{}
		if(doctype!==""){
	     var pat1 = new RegExp(/<\?xml.*?>/);
	     var pat2 = new RegExp(/.*XHTML.*/);
	     if(doctype.match(pat1)!==null||doctype.match(pat2)!==null){
				type = "xhtml";
			}		
		}
		return type;
	}
	/*コメント挿入関数*/
	function set_comment(str){
		document.getElementById("comments").value = str;
	}
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
	/*行頭のspace,tab,改行除去関数*/
	   function clean(str){
	   str=str.replace(/^ +/m,"");
	   str=str.replace(/\t+/m,"");
	   str=str.replace(/(\r\n|\r|\n)/g,""); 
	   return str;
	}
})();



javascript:(function(){var langstr = prompt("言語属性値を指定してください（半角）","en");click_for("FAIL");var tag = "";var imgtag = "";var type = "text";var doctype = "";var rdmtag = "";tag=document.getElementById("srccode").value;doctype = get_doctype();tag = clean(tag);var pat0 = new RegExp(/(<.*?>)(.+?)(<\/.*?>)/);var arr0 = tag.match(pat0);if(arr0!==null){tag = arr0[2].toString();}var pat1 = new RegExp(/<img.*?>/);var arr1 = tag.match(pat1);if(arr1!==null){type = "img";imgtag = arr1[0].toString();}switch(type){case "text":var firsttag = arr0[1].toString();var content = arr0[2].toString();var endtag = arr0[3].toString();if(doctype=="xhtml"){firsttag = firsttag.replace('>',' xml:lang="'+langstr+'" lang="'+langstr+'">');}else{firsttag = firsttag.replace('>','" lang="'+langstr+'">');}rdmtag = firsttag + content + endtag;break;case "img":if(doctype=="xhtml"){imgtag = imgtag.replace('<img', '<img xml:lang="'+langstr+'" lang="'+langstr+'"');}else{imgtag = imgtag.replace('<img', '<img lang="'+langstr+'"');}rdmtag = imgtag;break;default:break;}document.getElementById("srccode").value=rdmtag;set_comment("lang属性（"+langstr+")が設定されていない");/*DOCTYPE判定関数*/function get_doctype(){var doctype = "";var type = "html";var　d=document.getElementById("source");var　dch=d.childNodes;try{doctype = dch.item(2).nodeValue;}finally{}if(doctype!==""){var pat1 = new RegExp(/<\?xml.*?>/);var pat2 = new RegExp(/.*XHTML.*/);if(doctype.match(pat1)!==null||doctype.match(pat2)!==null){type = "xhtml";}		}return type;}/*コメント挿入関数*/function set_comment(str){document.getElementById("comments").value = str;}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}/*行頭のspace,tab,改行除去関数*/function clean(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;}})();

//V2
javascript:(function(){
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>H58 SE</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%; margin-top:0;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:500px; height: 8em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function doit(){');
		d.writeln('var langstr = prompt("言語属性値を指定してください（半角）","en");');
		d.writeln('var tag = "";');
		d.writeln('var imgtag = "";');
		d.writeln('var type = "text";');
		d.writeln('var doctype = "";');
		d.writeln('var rdmtag = "";');
		d.writeln('tag=document.getElementById("ta_before").value;');
		d.writeln('add_description(tag);');
		d.writeln('doctype = get_doctype();');
		d.writeln('tag = clean(tag);');
		d.writeln('var pat0 = new RegExp(/(<.*?>)(.+?)(<\\/.*?>)/);');
		d.writeln('var arr0 = tag.match(pat0);');
		d.writeln('if(arr0!==null){');
		d.writeln('tag = arr0[2].toString();');
		d.writeln('}');
		d.writeln('var pat1 = new RegExp(/<img.*?>/);');
		d.writeln('var arr1 = tag.match(pat1);');
		d.writeln('if(arr1!==null){');
		d.writeln('if(arr0!==null){');
		d.writeln('type="alternate";');
		d.writeln('}else{');
		d.writeln('type = "img";');
		d.writeln('imgtag = arr1[0].toString();');
		d.writeln('}');
		d.writeln('}');
		d.writeln('switch(type){');
		d.writeln('case "text":');
		d.writeln('case "alternate":');
		d.writeln('var firsttag = arr0[1].toString();');
		d.writeln('var content = arr0[2].toString();');
		d.writeln('var endtag = arr0[3].toString();');
		d.writeln('if(doctype=="xhtml"){');
		d.writeln('firsttag = firsttag.replace(\'>\',\' xml:lang="\'+langstr+\'" lang="\'+langstr+\'">\');');
		d.writeln('}else{');
		d.writeln('firsttag = firsttag.replace(\'>\',\' lang="\'+langstr+\'">\');');
		d.writeln('}');
		d.writeln('rdmtag = firsttag + content + endtag;');
		d.writeln('break;');
		d.writeln('case "img":');
		d.writeln('if(doctype=="xhtml"){');
		d.writeln('imgtag = imgtag.replace(\'<img\', \'<img xml:lang="\'+langstr+\'" lang="\'+langstr+\'"\');');
		d.writeln('}else{');
		d.writeln('imgtag = imgtag.replace(\'<img\', \'<img lang="\'+langstr+\'"\');');
		d.writeln('}');
		d.writeln('rdmtag = imgtag;');
		d.writeln('break;');
		d.writeln('default:');
		d.writeln('break;');
		d.writeln('}');
		d.writeln('document.getElementById("ta_after").value=rdmtag;');
		d.writeln('}');
		d.writeln('function get_doctype(){');
		d.writeln('var doctype = "";');
		d.writeln('var type = "html";');
		d.writeln('var　d=window.opener.document.getElementById("source");');
		d.writeln('var　dch=d.childNodes;');
		d.writeln('try{doctype = dch.item(2).nodeValue;}finally{}');
		d.writeln('if(doctype!==""){');
		d.writeln('var pat1 = new RegExp(/<\\?xml.*?>/);');
		d.writeln('var pat2 = new RegExp(/.*XHTML.*/);');
		d.writeln('if(doctype.match(pat1)!==null||doctype.match(pat2)!==null){');
		d.writeln('type = "xhtml";');
		d.writeln('}');
		d.writeln('}');
		d.writeln('return type;');
		d.writeln('}');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function this_text_insert(src, target){');
		d.writeln('var sc = document.getElementById(src);');
		d.writeln('var text = sc.value;');
		d.writeln('text_insert(target, text);');
		d.writeln('}');
		d.writeln('function clean(str){');
		d.writeln('str=str.replace(/^ +/m,"");');
		d.writeln('str=str.replace(/\\t+/m,"");');
		d.writeln('str=str.replace(/(\\r\\n|\\r|\\n)/g,""); ');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function delete_this_text(target){');
		d.writeln('document.getElementById(target).value="";');
		d.writeln('}');
		d.writeln('function delete_all_text(){');
		d.writeln('var tas = document.getElementsByTagName("textarea");');
		d.writeln('for(var i=0; i<tas.length; i++){');
		d.writeln('var row = tas.item(i);');
		d.writeln('row.value = "";');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function add_description(str){');
		d.writeln('var target = window.opener.document.getElementById("description");');
		d.writeln('var tarval = target.value;');
		d.writeln('tarval = tarval + str + "\\n";');
		d.writeln('target.value = tarval;');
		d.writeln('}');
		d.writeln('function send_to(){');
		d.writeln('var target = window.opener.document.getElementById("srccode");');
		d.writeln('var from = document.getElementById("ta_sub").value;');
		d.writeln('target.value = from;');
		d.writeln('}');
		d.writeln('function langcode_reference(){');
		d.writeln('window.open("http://www.tagindex.com/html5/basic/langcode.html");');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>H58 Source-Editor</h1>');
		d.writeln('<label for="ta_before"><strong>Before Text:</strong></label>');
		d.writeln('<button onclick="doit()">DoIt!</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');
		d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');
		d.writeln('<button onclick="langcode_reference()">LCReference</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_before"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_after"><strong>After Text:</strong></label>');
		d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_after"></textarea>');
		d.writeln('<br>');
		d.writeln('<button onclick="this_text_insert(\'ta_after\',\'ta_sub\')">Insert</button>');
		d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');
		d.writeln('<button onclick="send_to()">Send</button>');
		d.writeln('<br>');
		d.writeln('<label for="ta_sub"><strong>Sub Text:</strong></label>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_sub"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
	}
})();

javascript:(function(){trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>H58 SE</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%; margin-top:0;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:500px; height: 8em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function doit(){');d.writeln('var langstr = prompt("言語属性値を指定してください（半角）","en");');d.writeln('var tag = "";');d.writeln('var imgtag = "";');d.writeln('var type = "text";');d.writeln('var doctype = "";');d.writeln('var rdmtag = "";');d.writeln('tag=document.getElementById("ta_before").value;');d.writeln('add_description(tag);');d.writeln('doctype = get_doctype();');d.writeln('tag = clean(tag);');d.writeln('var pat0 = new RegExp(/(<.*?>)(.+?)(<\\/.*?>)/);');d.writeln('var arr0 = tag.match(pat0);');d.writeln('if(arr0!==null){');d.writeln('tag = arr0[2].toString();');d.writeln('}');d.writeln('var pat1 = new RegExp(/<img.*?>/);');d.writeln('var arr1 = tag.match(pat1);');d.writeln('if(arr1!==null){');d.writeln('if(arr0!==null){');d.writeln('type="alternate";');d.writeln('}else{');d.writeln('type = "img";');d.writeln('imgtag = arr1[0].toString();');d.writeln('}');d.writeln('}');d.writeln('switch(type){');d.writeln('case "text":');d.writeln('case "alternate":');d.writeln('var firsttag = arr0[1].toString();');d.writeln('var content = arr0[2].toString();');d.writeln('var endtag = arr0[3].toString();');d.writeln('if(doctype=="xhtml"){');d.writeln('firsttag = firsttag.replace(\'>\',\' xml:lang="\'+langstr+\'" lang="\'+langstr+\'">\');');d.writeln('}else{');d.writeln('firsttag = firsttag.replace(\'>\',\' lang="\'+langstr+\'">\');');d.writeln('}');d.writeln('rdmtag = firsttag + content + endtag;');d.writeln('break;');d.writeln('case "img":');d.writeln('if(doctype=="xhtml"){');d.writeln('imgtag = imgtag.replace(\'<img\', \'<img xml:lang="\'+langstr+\'" lang="\'+langstr+\'"\');');d.writeln('}else{');d.writeln('imgtag = imgtag.replace(\'<img\', \'<img lang="\'+langstr+\'"\');');d.writeln('}');d.writeln('rdmtag = imgtag;');d.writeln('break;');d.writeln('default:');d.writeln('break;');d.writeln('}');d.writeln('document.getElementById("ta_after").value=rdmtag;');d.writeln('}');d.writeln('function get_doctype(){');d.writeln('var doctype = "";');d.writeln('var type = "html";');d.writeln('var　d=window.opener.document.getElementById("source");');d.writeln('var　dch=d.childNodes;');d.writeln('try{doctype = dch.item(2).nodeValue;}finally{}');d.writeln('if(doctype!==""){');d.writeln('var pat1 = new RegExp(/<\\?xml.*?>/);');d.writeln('var pat2 = new RegExp(/.*XHTML.*/);');d.writeln('if(doctype.match(pat1)!==null||doctype.match(pat2)!==null){');d.writeln('type = "xhtml";');d.writeln('}');d.writeln('}');d.writeln('return type;');d.writeln('}');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function this_text_insert(src, target){');d.writeln('var sc = document.getElementById(src);');d.writeln('var text = sc.value;');d.writeln('text_insert(target, text);');d.writeln('}');d.writeln('function clean(str){');d.writeln('str=str.replace(/^ +/m,"");');d.writeln('str=str.replace(/\\t+/m,"");');d.writeln('str=str.replace(/(\\r\\n|\\r|\\n)/g,""); ');d.writeln('return str;');d.writeln('}');d.writeln('function delete_this_text(target){');d.writeln('document.getElementById(target).value="";');d.writeln('}');d.writeln('function delete_all_text(){');d.writeln('var tas = document.getElementsByTagName("textarea");');d.writeln('for(var i=0; i<tas.length; i++){');d.writeln('var row = tas.item(i);');d.writeln('row.value = "";');d.writeln('}');d.writeln('}');d.writeln('function add_description(str){');d.writeln('var target = window.opener.document.getElementById("description");');d.writeln('var tarval = target.value;');d.writeln('tarval = tarval + str + "\\n";');d.writeln('target.value = tarval;');d.writeln('}');d.writeln('function send_to(){');d.writeln('var target = window.opener.document.getElementById("srccode");');d.writeln('var from = document.getElementById("ta_sub").value;');d.writeln('target.value = from;');d.writeln('}');d.writeln('function langcode_reference(){');d.writeln('window.open("http://www.tagindex.com/html5/basic/langcode.html");');d.writeln('}');d.writeln('</script>');d.writeln('<h1>H58 Source-Editor</h1>');d.writeln('<label for="ta_before"><strong>Before Text:</strong></label>');d.writeln('<button onclick="doit()">DoIt!</button>');d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');d.writeln('<button onclick="delete_all_text()">ClearAllText</button>');d.writeln('<button onclick="langcode_reference()">LCReference</button>');d.writeln('<br>');d.writeln('<textarea id="ta_before"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_after"><strong>After Text:</strong></label>');d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');d.writeln('<br>');d.writeln('<textarea id="ta_after"></textarea>');d.writeln('<br>');d.writeln('<button onclick="this_text_insert(\'ta_after\',\'ta_sub\')">Insert</button>');d.writeln('<button onclick="br_insert(\'ta_sub\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_sub\')">Clear</button>');d.writeln('<button onclick="send_to()">Send</button>');d.writeln('<br>');d.writeln('<label for="ta_sub"><strong>Sub Text:</strong></label>');d.writeln('<br>');d.writeln('<textarea id="ta_sub"></textarea>');d.writeln('</body>');d.writeln('</html>');}})();

//V3（公開用V2）
javascript:(function(){
	var comments = [
		"適切なlang属性が指定されていない"
	];
	var tags = {
		span: "<span></span>",
		div: "<div></div>",
		p: "<p></p>"
	};
	var attrs = {
		xml_lang: "xml:lang",
		lang: "lang"
	};
	var langs = {
		en: "英語",
		ja: "日本語",
		zh: "中国語",
		ko: "韓国語",
		de: "ドイツ語",
		fr: "フランス語",
		it: "イタリア語",
		nl: "オランダ語",
		pt: "ポルトガル語",
		es: "スペイン語",
		pl: "ポーランド語",
		el: "ギリシャ語",
		ru: "ロシア語",
		he: "ヘブライ語",
		hi: "ヒンディー語",
		ar: "アラビア語",
		la: "ラテン語",
		sw: "スワヒリ語"
	};
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>H58 SE(V2)</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%; margin-top:0;}');
		d.writeln('label {font-size: 90%; margin-right: 5px;}');
		d.writeln('#lang_select,#lang_select2,#attr_select{width:55px;}');
		d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:500px; height: 13em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function lang_insert(target, from){');
		d.writeln('var src = document.getElementById(from);');
		d.writeln('var idx = src.selectedIndex;');
		d.writeln('var tarval = src.options[idx].value;');
		d.writeln('var doctype = "";');
		d.writeln('try{');
		d.writeln('doctype = get_doctype();');
		d.writeln('}finally{}');
		d.writeln('var str = "";');
		d.writeln('if(doctype=="xhtml"){');
		d.writeln('str = \' xml:lang="\' + tarval + \'" lang="\' + tarval + \'"\';');
		d.writeln('}else{');
		d.writeln('str = \' lang="\' + tarval + \'"\';');
		d.writeln('}');
		d.writeln('text_insert(target, str);');
		d.writeln('}');
		d.writeln('function get_doctype(){');
		d.writeln('var doctype = "";');
		d.writeln('var type = "html";');
		d.writeln('if(window.opener!==null){');
		d.writeln('var d = window.opener.document.getElementById("source");');
		d.writeln('var dch=d.childNodes;');
		d.writeln('doctype = dch.item(2).nodeValue;');
		d.writeln('if(doctype!==""){');
		d.writeln('var pat1 = new RegExp(/<\\?xml.*?>/);');
		d.writeln('var pat2 = new RegExp(/.*XHTML.*/);');
		d.writeln('if(doctype.match(pat1)!==null||doctype.match(pat2)!==null){');
		d.writeln('type = "xhtml";');
		d.writeln('}');
		d.writeln('}');
		d.writeln('}');
		d.writeln('return type;');
		d.writeln('}');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function copy_bottom(){');
		d.writeln('var sc = document.getElementById("ta_before");');
		d.writeln('var text = sc.value;');
		d.writeln('text_insert("ta_after", text);');
		d.writeln('}');
		d.writeln('function clean(str){');
		d.writeln('str=str.replace(/^ +/m,"");');
		d.writeln('str=str.replace(/\\t+/m,"");');
		d.writeln('str=str.replace(/(\\r\\n|\\r|\\n)/g,""); ');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('function delete_this_text(target){');
		d.writeln('document.getElementById(target).value="";');
		d.writeln('}');
		d.writeln('function delete_all_text(){');
		d.writeln('var tas = document.getElementsByTagName("textarea");');
		d.writeln('for(var i=0; i<tas.length; i++){');
		d.writeln('var row = tas.item(i);');
		d.writeln('row.value = "";');
		d.writeln('}');
		d.writeln('}');
		d.writeln('function send_comment(){');
		d.writeln('var src = document.getElementById("comment_select");');
		d.writeln('var idx = src.selectedIndex;');
		d.writeln('var srcval = src.options[idx].text;');
		d.writeln('var target = window.opener.document.getElementById("comments");');
		d.writeln('var tarval = target.value;');
		d.writeln('tarval = tarval + srcval + "\\n";');
		d.writeln('target.value = tarval;');
		d.writeln('}');
		d.writeln('function tag_insert(target, from){');
		d.writeln('var src = document.getElementById(from);');
		d.writeln('var idx = src.selectedIndex;');
		d.writeln('var srcval = src.options[idx].value;');
		d.writeln('text_insert(target, srcval);');
		d.writeln('}');
		d.writeln('function attr_insert(target, from){');
		d.writeln('var src = document.getElementById(from);');
		d.writeln('var idx = src.selectedIndex;');
		d.writeln('var srcval = src.options[idx].value;');
		d.writeln('var attrval = prompt("lang属性値を入力してください");');
		d.writeln('srcval = " " + srcval + \'="\' + attrval + \'"\';');
		d.writeln('text_insert(target, srcval);');
		d.writeln('}');
		d.writeln('function send_to(target, from){');
		d.writeln('var target = window.opener.document.getElementById(target);');
		d.writeln('var tarval = target.value;');
		d.writeln('var src = document.getElementById(from).value;');
		d.writeln('tarval = tarval + src + "\\n";');
		d.writeln('target.value = tarval;');
		d.writeln('}');
		d.writeln('function langcode_reference(){');
		d.writeln('window.open("http://www.tagindex.com/html5/basic/langcode.html");');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>H58 Source-Editor<small>(V2)</small></h1>');
		d.writeln('<label for="comment_select"><strong>Comment: </strong></label>');
		d.writeln('<select id="comment_select">');
		d.writeln('</select>');
		d.writeln('<button onclick="send_comment()">Send</button>');
		d.writeln('<button onclick="langcode_reference()">LCReference</button>');
		d.writeln('<br>');
		d.writeln('<label for="tag_select"><strong>Tag:</strong></label>');
		d.writeln('<select id="tag_select"></select>');
		d.writeln('<button onclick="tag_insert(\'ta_before\', \'tag_select\')">Insert</button>');
		d.writeln('<label for="lang_select"><strong>Lang:</strong></label>');
		d.writeln('<select id="lang_select"></select>');
		d.writeln('<button onclick="lang_insert(\'ta_before\', \'lang_select\')">Insert</button>');
		d.writeln('<label for="attr_select"><strong>Attr:</strong></label>');
		d.writeln('<select id="attr_select"></select>');
		d.writeln('<button onclick="attr_insert(\'ta_before\', \'attr_select\')">Insert</button>');
		d.writeln('<br>');
		d.writeln('<br>');
		d.writeln('<label for="ta_before"><strong>Before Text:</strong></label>');
		d.writeln('<button onclick="br_insert(\'ta_before\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');
		d.writeln('<button onclick="delete_all_text()">ClearAll</button>');
		d.writeln('<button onclick="send_to(\'description\', \'ta_before\')">Send</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_before"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_after"><strong>After Text:</strong></label>');
		d.writeln('<button onclick="copy_bottom()">CpBottom</button>');
		d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');
		d.writeln('<button onclick="send_to(\'srccode\', \'ta_after\')">Send</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_after"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
		var src1 = d.getElementById("comment_select");
		for(var i=0; i<comments.length; i++){
			var opt = d.createElement("option");
			opt.setAttribute("value", i);
			opt.textContent = comments[i].toString();
			src1.appendChild(opt);
		}
		var src2 = d.getElementById("tag_select");
		for(var key in tags){
			var opt = d.createElement("option");
			opt.setAttribute("value", tags[key]);
			opt.textContent = key;
			src2.appendChild(opt);
		}
		var src3 = d.getElementById("lang_select");
		for(var key in langs){
			var opt = d.createElement("option");
			opt.setAttribute("value", key);
			opt.textContent = langs[key] + "(" + key + ")";
			src3.appendChild(opt);
		}
		var src4 = d.getElementById("attr_select");
		for(var key in attrs){
			var opt = d.createElement("option");
			opt.setAttribute("value", attrs[key]);
			opt.textContent = key;
			src4.appendChild(opt);
		}
	}
})();

javascript:(function(){var comments = ["適切なlang属性が指定されていない"];var tags = {span: "<span></span>",div: "<div></div>",p: "<p></p>"};var attrs = {xml_lang: "xml:lang",lang: "lang"};var langs = {en: "英語",ja: "日本語",zh: "中国語",ko: "韓国語",de: "ドイツ語",fr: "フランス語",it: "イタリア語",nl: "オランダ語",pt: "ポルトガル語",es: "スペイン語",pl: "ポーランド語",el: "ギリシャ語",ru: "ロシア語",he: "ヘブライ語",hi: "ヒンディー語",ar: "アラビア語",la: "ラテン語",sw: "スワヒリ語"};trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>H58 SE(V2)</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%; margin-top:0;}');d.writeln('label {font-size: 90%; margin-right: 5px;}');d.writeln('#lang_select,#lang_select2,#attr_select{width:55px;}');d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:500px; height: 13em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function lang_insert(target, from){');d.writeln('var src = document.getElementById(from);');d.writeln('var idx = src.selectedIndex;');d.writeln('var tarval = src.options[idx].value;');d.writeln('var doctype = "";');d.writeln('try{');d.writeln('doctype = get_doctype();');d.writeln('}finally{}');d.writeln('var str = "";');d.writeln('if(doctype=="xhtml"){');d.writeln('str = \' xml:lang="\' + tarval + \'" lang="\' + tarval + \'"\';');d.writeln('}else{');d.writeln('str = \' lang="\' + tarval + \'"\';');d.writeln('}');d.writeln('text_insert(target, str);');d.writeln('}');d.writeln('function get_doctype(){');d.writeln('var doctype = "";');d.writeln('var type = "html";');d.writeln('if(window.opener!==null){');d.writeln('var d = window.opener.document.getElementById("source");');d.writeln('var dch=d.childNodes;');d.writeln('doctype = dch.item(2).nodeValue;');d.writeln('if(doctype!==""){');d.writeln('var pat1 = new RegExp(/<\\?xml.*?>/);');d.writeln('var pat2 = new RegExp(/.*XHTML.*/);');d.writeln('if(doctype.match(pat1)!==null||doctype.match(pat2)!==null){');d.writeln('type = "xhtml";');d.writeln('}');d.writeln('}');d.writeln('}');d.writeln('return type;');d.writeln('}');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function copy_bottom(){');d.writeln('var sc = document.getElementById("ta_before");');d.writeln('var text = sc.value;');d.writeln('text_insert("ta_after", text);');d.writeln('}');d.writeln('function clean(str){');d.writeln('str=str.replace(/^ +/m,"");');d.writeln('str=str.replace(/\\t+/m,"");');d.writeln('str=str.replace(/(\\r\\n|\\r|\\n)/g,""); ');d.writeln('return str;');d.writeln('}');d.writeln('function delete_this_text(target){');d.writeln('document.getElementById(target).value="";');d.writeln('}');d.writeln('function delete_all_text(){');d.writeln('var tas = document.getElementsByTagName("textarea");');d.writeln('for(var i=0; i<tas.length; i++){');d.writeln('var row = tas.item(i);');d.writeln('row.value = "";');d.writeln('}');d.writeln('}');d.writeln('function send_comment(){');d.writeln('var src = document.getElementById("comment_select");');d.writeln('var idx = src.selectedIndex;');d.writeln('var srcval = src.options[idx].text;');d.writeln('var target = window.opener.document.getElementById("comments");');d.writeln('var tarval = target.value;');d.writeln('tarval = tarval + srcval + "\\n";');d.writeln('target.value = tarval;');d.writeln('}');d.writeln('function tag_insert(target, from){');d.writeln('var src = document.getElementById(from);');d.writeln('var idx = src.selectedIndex;');d.writeln('var srcval = src.options[idx].value;');d.writeln('text_insert(target, srcval);');d.writeln('}');d.writeln('function attr_insert(target, from){');d.writeln('var src = document.getElementById(from);');d.writeln('var idx = src.selectedIndex;');d.writeln('var srcval = src.options[idx].value;');d.writeln('var attrval = prompt("lang属性値を入力してください");');d.writeln('srcval = " " + srcval + \'="\' + attrval + \'"\';');d.writeln('text_insert(target, srcval);');d.writeln('}');d.writeln('function send_to(target, from){');d.writeln('var target = window.opener.document.getElementById(target);');d.writeln('var tarval = target.value;');d.writeln('var src = document.getElementById(from).value;');d.writeln('tarval = tarval + src + "\\n";');d.writeln('target.value = tarval;');d.writeln('}');d.writeln('function langcode_reference(){');d.writeln('window.open("http://www.tagindex.com/html5/basic/langcode.html");');d.writeln('}');d.writeln('</script>');d.writeln('<h1>H58 Source-Editor<small>(V2)</small></h1>');d.writeln('<label for="comment_select"><strong>Comment: </strong></label>');d.writeln('<select id="comment_select">');d.writeln('</select>');d.writeln('<button onclick="send_comment()">Send</button>');d.writeln('<button onclick="langcode_reference()">LCReference</button>');d.writeln('<br>');d.writeln('<label for="tag_select"><strong>Tag:</strong></label>');d.writeln('<select id="tag_select"></select>');d.writeln('<button onclick="tag_insert(\'ta_before\', \'tag_select\')">Insert</button>');d.writeln('<label for="lang_select"><strong>Lang:</strong></label>');d.writeln('<select id="lang_select"></select>');d.writeln('<button onclick="lang_insert(\'ta_before\', \'lang_select\')">Insert</button>');d.writeln('<label for="attr_select"><strong>Attr:</strong></label>');d.writeln('<select id="attr_select"></select>');d.writeln('<button onclick="attr_insert(\'ta_before\', \'attr_select\')">Insert</button>');d.writeln('<br>');d.writeln('<br>');d.writeln('<label for="ta_before"><strong>Before Text:</strong></label>');d.writeln('<button onclick="br_insert(\'ta_before\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');d.writeln('<button onclick="delete_all_text()">ClearAll</button>');d.writeln('<button onclick="send_to(\'description\', \'ta_before\')">Send</button>');d.writeln('<br>');d.writeln('<textarea id="ta_before"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_after"><strong>After Text:</strong></label>');d.writeln('<button onclick="copy_bottom()">CpBottom</button>');d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');d.writeln('<button onclick="send_to(\'srccode\', \'ta_after\')">Send</button>');d.writeln('<br>');d.writeln('<textarea id="ta_after"></textarea>');d.writeln('</body>');d.writeln('</html>');var src1 = d.getElementById("comment_select");for(var i=0; i<comments.length; i++){var opt = d.createElement("option");opt.setAttribute("value", i);opt.textContent = comments[i].toString();src1.appendChild(opt);}var src2 = d.getElementById("tag_select");for(var key in tags){var opt = d.createElement("option");opt.setAttribute("value", tags[key]);opt.textContent = key;src2.appendChild(opt);}var src3 = d.getElementById("lang_select");for(var key in langs){var opt = d.createElement("option");opt.setAttribute("value", key);opt.textContent = langs[key] + "(" + key + ")";src3.appendChild(opt);}var src4 = d.getElementById("attr_select");for(var key in attrs){var opt = d.createElement("option");opt.setAttribute("value", attrs[key]);opt.textContent = key;src4.appendChild(opt);}}})();





//H2-PDF
javascript:(function(){
	var rdmtag = "";
	click_for("FAIL");
	set_comment("リンクテキストを補足するアイコンはａ要素内に記述する");
	var selection = window.getSelection().toString();
	selection = selection.replace(/\n\[.*?\]/,"");
	selection = selection.replace(/(\n|\r|\r\n)/g,"");
	var apat = new RegExp(/^<a.*/);
	var aarr = selection.match(apat);
	var ipat = new RegExp(/<img.+?>$/);
	var iarr = selection.match(ipat);
	if(aarr!==null && iarr!==null){
		var pat = new RegExp(/<img.+?>/);
		var arr = selection.match(pat);
		if(arr!==null){
			var ico = arr[0].toString();
			selection = selection.replace(ico, "");
			selection = selection.replace("</a>", ico + "</a>");
		}else{
			alert('実行エラー！');
		}
	}else{
		alert('選択範囲が正しくありません！');
	}
	document.getElementById("srccode").value = selection;
	/*コメント挿入関数*/
	function set_comment(str){
		document.getElementById("comments").value = str;
	}
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
})();

javascript:(function(){var rdmtag = "";click_for("FAIL");set_comment("リンクテキストを補足するアイコンはａ要素内に記述する");var selection = window.getSelection().toString();selection = selection.replace(/\n\[.*?\]/,"");selection = selection.replace(/(\n|\r|\r\n)/g,"");var apat = new RegExp(/^<a.*/);var aarr = selection.match(apat);var ipat = new RegExp(/<img.+?>$/);var iarr = selection.match(ipat);if(aarr!==null && iarr!==null){var pat = new RegExp(/<img.+?>/);var arr = selection.match(pat);if(arr!==null){var ico = arr[0].toString();selection = selection.replace(ico, "");selection = selection.replace("</a>", ico + "</a>");}else{alert('実行エラー！');}}else{alert('選択範囲が正しくありません！');}document.getElementById("srccode").value = selection;/*コメント挿入関数*/function set_comment(str){document.getElementById("comments").value = str;}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}})();

//V2
javascript:(function(){
	var rdmtag = "";
	click_for("FAIL");
	set_comment("リンクテキストを補足するアイコンはａ要素内に記述する");
	var src = document.getElementById("description").value;
	var atag = prompt("aタグを貼り付けてください");
	atag = text_decode(atag);
	var apat = new RegExp(/^<a.*/);
	var aarr = atag.match(apat);
	if(aarr!=null){
		atag = atag.replace("</a>", src + "</a>");
	}
	document.getElementById("srccode").value = atag;
	function text_decode(str){
		var ret = "";
		var pat = new RegExp(/&#[0-9]+;/);
		var arr = str.match(pat);
		if(arr!==null){
			ret = str.replace(pat, "");
			return ret;
		}
		return str;
	}
	/*コメント挿入関数*/
	function set_comment(str){
		document.getElementById("comments").value = str;
	}
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
})();

javascript:(function(){var rdmtag = "";click_for("FAIL");set_comment("リンクテキストを補足するアイコンはａ要素内に記述する");var src = document.getElementById("description").value;var atag = prompt("aタグを貼り付けてください");atag = text_decode(atag);var apat = new RegExp(/^<a.*/);var aarr = atag.match(apat);if(aarr!=null){atag = atag.replace("</a>", src + "</a>");}document.getElementById("srccode").value = atag;function text_decode(str){var ret = "";var pat = new RegExp(/&#[0-9]+;/);var arr = str.match(pat);if(arr!==null){ret = str.replace(pat, "");return ret;}return str;}/*コメント挿入関数*/function set_comment(str){document.getElementById("comments").value = str;}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}})();

//V3-総務省仕様
javascript:(function(){
	var rdmtag = "";
	var icon = '<img alt="PDF" height="15" src="/main_content/000000011.gif" width="15" />';
	click_for("FAIL");
	set_comment("リンクテキストを補足するアイコンはａ要素内に記述する");
	var src = document.getElementById("description").value;
	var atag = prompt("aタグを貼り付けてください");
	atag = text_decode(atag);
	var apat = new RegExp(/<a.*/);
	var aarr = atag.match(apat);
	if(aarr!=null){
		rdmtag = aarr[0].toString();
		rdmtag = rdmtag.replace("</a>", icon + "</a>");
	}
	document.getElementById("srccode").value = rdmtag;
	function text_decode(str){
		var ret = "";
		var pat = new RegExp(/&#[0-9]+;/);
		var arr = str.match(pat);
		if(arr!==null){
			ret = str.replace(pat, "");
			return ret;
		}
		return str;
	}
	/*コメント挿入関数*/
	function set_comment(str){
		document.getElementById("comments").value = str;
	}
	/*ボタンクリック関数*/
	function click_for(flag){
		var form=document.forms["diag_form"];
		for(var i=0;i<form.elements.length;i++){
			var obj=form.elements[i].value;
			if(obj==flag){
				form.elements[i].click();
				break;
			}
		}
	}
})();


javascript:(function(){var rdmtag = "";var icon = '<img alt="PDF" height="15" src="/main_content/000000011.gif" width="15" />';click_for("FAIL");set_comment("リンクテキストを補足するアイコンはａ要素内に記述する");var src = document.getElementById("description").value;var atag = prompt("aタグを貼り付けてください");atag = text_decode(atag);var apat = new RegExp(/<a.*/);var aarr = atag.match(apat);if(aarr!=null){rdmtag = aarr[0].toString();rdmtag = rdmtag.replace("</a>", icon + "</a>");}document.getElementById("srccode").value = rdmtag;function text_decode(str){var ret = "";var pat = new RegExp(/&#[0-9]+;/);var arr = str.match(pat);if(arr!==null){ret = str.replace(pat, "");return ret;}return str;}/*コメント挿入関数*/function set_comment(str){document.getElementById("comments").value = str;}/*ボタンクリック関数*/function click_for(flag){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}}})();

//フォーカス一発ジャンプ
javascript:(function(){
	var txt = get_prompt("調査対象のURLまたはタグをペーストしてください");
	if(is_href(txt)){
	  atag_href_focus(txt);
	}else if(is_tag(txt)){
	  if(is_id(txt)){
	    var pat = new RegExp(/(id=")(.+?)(")/);
	    var arr = txt.match(pat);
	    var idval = "";
	    if(arr!==null){
	      idval = arr[2].toString();
	      if(is_button(txt)){
	      	var gvalue = get_btn_value(txt);
	      	var galt = get_btn_alt(txt);
	      	if(gvalue!==null && galt==null){
	      		btn_focus(gvalue, null);
	      	}else if(gvalue==null && galt!==null){
	      		btn_focus(null, galt);
	      	}
	      }else{
	      	atag_id_focus(idval);
	  	  }
	    }
	  }
	  if(is_name(txt)){
	    var pat = new RegExp(/(name=")(.+?)(")/);
	    var arr = txt.match(pat);
	    var nameval = "";
	    if(arr!==null){
	    	nameval = arr[2].toString();
	    	if(is_button(txt)){
	    		var gvalue = get_btn_value(txt);
	    		var galt = get_btn_alt(txt);
	    		if(gvalue!==null && galt==null){
	    			btn_focus(gvalue, null);
	    		}else if(gvalue==null && galt!==null){
	    			btn_focus(null, galt);
	    		}
	    	}else{
	    		atag_name_focus(nameval);
	    	}
	    }
	  }
	  if(is_onclick(txt)){
	    var pat = new RegExp(/(onclick="|onClick=")(.+?)(")/);
	    var arr = txt.match(pat);
	    var onclickval = "";
	    if(arr!==null){
	    	onclickval = arr[2].toString();
	    	if(is_button(txt)){
	    		var gvalue = get_btn_value(txt);
	    		var galt = get_btn_alt(txt);
	    		if(gvalue!==null && galt==null){
	    			btn_focus(gvalue, null);
	    		}else if(gvalue==null && galt!==null){
	    			btn_focus(null, galt);
	    		}
	    	}else{
	    		atag_onclick_focus(onclickval);
	    	}
	    }
	  }
	  if(is_button(txt)){
	    var pat = new RegExp(/(type="image"|type="submit")/);
	    var arr = txt.match(pat);
	    if(arr!==null){
	      var value = get_btn_value(txt);
	      var alt = get_btn_alt(txt);
	      if(value!==null && alt==null){
	      	btn_focus(value, null);
	      }else if(value==null && alt!==null){
	      	btn_focus(null, alt);
	      }
	    }
	  }
	}
	function atag_href_focus(href){
	  var atags = document.getElementsByTagName("a");
	  for(var i=0; i<atags.length; i++){
	    var atag = atags.item(i);
	    var ahref = atag.href;
	    if(ahref==href){
	      atag.focus();
	      break;
	    }
	  }
	}
	function atag_id_focus(id){
	  var atags = document.getElementsByTagName("a");
	  for(var i=0; i<atags.length; i++){
	    var atag = atags.item(i);
	    var aid = atag.id;
	    if(aid==id){
	      atag.focus();
	      break;
	    }
	  }
	}
	function atag_onclick_focus(onclick_str){
	  var atags = document.getElementsByTagName("a");
	  for(var i=0; i<atags.length; i++){
	    var atag = atags.item(i);
	    var aonclick = atag.getAttribute("onclick");
	    if(aonclick==onclick_str){
	      atag.focus();
	      break;
	    }
	  }
	}
	function btn_focus(value, alt){
		var inputs = document.getElementsByTagName("input");
		for(var i=0; i<inputs.length; i++){
			var input = inputs.item(i);
			var intype = input.type;
			var invalue = input.value;
			var inalt = input.alt;
			if(intype=="submit" || intype=="image" || intype=="reset" || intype=="button"){
				if(invalue==value && inalt==alt){
					input.focus();
					break;
				}
			}
		}
	}
	function get_btn_value(str){
		var val = null;
		var pat = new RegExp(/(value=")(.+?)(")/);
		var arr = str.match(pat);
		if(arr!==null){
			val = arr[2].toString();
		}
		return val;
	}
	function get_btn_alt(str){
		var alt = null;
		var pat = new RegExp(/(alt=")(.+?)(")/);
		var arr = str.match(pat);
		if(arr!==null){
			alt = arr[2].toString();
		}
		return alt;
	}
	function is_href(str){
	  var pat = new RegExp(/http.*\/\/.*/);
	  var arr = str.match(pat);
	  if(arr!==null){
	    return true;
	  }else{
	    return false;
	  }
	}
	function is_tag(str){
	  var pat = new RegExp(/<.+>/);
	  var arr = str.match(pat);
	  if(arr!==null){
	    return true;
	  }else{
	    return false;
	  }
	}
	function is_id(str){
	  var pat = new RegExp(/id="*.*"*/);
	  var arr = str.match(pat);
	  if(arr!==null){
	    return true;
	  }else{
	    return false;
	  }
	}
	function is_name(str){
	  var pat = new RegExp(/name="*.*"*/);
	  var arr = str.match(pat);
	  if(arr!==null){
	    return true;
	  }else{
	    return false;
	  }
	}
	function is_onclick(str){
	  var pat = new RegExp(/(onclick=".+?"|onClick=".+"?)/);
	  var arr = str.match(pat);
	  if(arr!==null){
	    return true;
	  }else{
	    return false;
	  }
	}
	function is_button(str){
	  var pat = new RegExp(/(type="*submit"*|type="*image"*|type="*button"*|type="*reset"*)/);
	  var arr = str.match(pat);
	  if(arr!==null){
	    return true;
	  }else{
	    return false;
	  }
	}
	function get_prompt(descript){
	  var str = "";
	  str = prompt(descript);
	  return str;
	}

})();

javascript:(function(){var txt = get_prompt("調査対象のURLまたはタグをペーストしてください");if(is_href(txt)){atag_href_focus(txt);}else if(is_tag(txt)){if(is_id(txt)){var pat = new RegExp(/(id=")(.+?)(")/);var arr = txt.match(pat);var idval = "";if(arr!==null){idval = arr[2].toString();if(is_button(txt)){var gvalue = get_btn_value(txt);var galt = get_btn_alt(txt);if(gvalue!==null && galt==null){btn_focus(gvalue, null);}else if(gvalue==null && galt!==null){btn_focus(null, galt);}}else{atag_id_focus(idval);}}}if(is_name(txt)){var pat = new RegExp(/(name=")(.+?)(")/);var arr = txt.match(pat);var nameval = "";if(arr!==null){nameval = arr[2].toString();if(is_button(txt)){var gvalue = get_btn_value(txt);var galt = get_btn_alt(txt);if(gvalue!==null && galt==null){btn_focus(gvalue, null);}else if(gvalue==null && galt!==null){btn_focus(null, galt);}}else{atag_name_focus(nameval);}}}if(is_onclick(txt)){var pat = new RegExp(/(onclick="|onClick=")(.+?)(")/);var arr = txt.match(pat);var onclickval = "";if(arr!==null){onclickval = arr[2].toString();if(is_button(txt)){var gvalue = get_btn_value(txt);var galt = get_btn_alt(txt);if(gvalue!==null && galt==null){btn_focus(gvalue, null);}else if(gvalue==null && galt!==null){btn_focus(null, galt);}}else{atag_onclick_focus(onclickval);}}}if(is_button(txt)){var pat = new RegExp(/(type="image"|type="submit")/);var arr = txt.match(pat);if(arr!==null){var value = get_btn_value(txt);var alt = get_btn_alt(txt);if(value!==null && alt==null){btn_focus(value, null);}else if(value==null && alt!==null){btn_focus(null, alt);}}}}function atag_href_focus(href){var atags = document.getElementsByTagName("a");for(var i=0; i<atags.length; i++){var atag = atags.item(i);var ahref = atag.href;if(ahref==href){atag.focus();break;}}}function atag_id_focus(id){var atags = document.getElementsByTagName("a");for(var i=0; i<atags.length; i++){var atag = atags.item(i);var aid = atag.id;if(aid==id){atag.focus();break;}}}function atag_onclick_focus(onclick_str){var atags = document.getElementsByTagName("a");for(var i=0; i<atags.length; i++){var atag = atags.item(i);var aonclick = atag.getAttribute("onclick");if(aonclick==onclick_str){atag.focus();break;}}}function btn_focus(value, alt){var inputs = document.getElementsByTagName("input");for(var i=0; i<inputs.length; i++){var input = inputs.item(i);var intype = input.type;var invalue = input.value;var inalt = input.alt;if(intype=="submit" || intype=="image" || intype=="reset" || intype=="button"){if(invalue==value && inalt==alt){input.focus();break;}}}}function get_btn_value(str){var val = null;var pat = new RegExp(/(value=")(.+?)(")/);var arr = str.match(pat);if(arr!==null){val = arr[2].toString();}return val;}function get_btn_alt(str){var alt = null;var pat = new RegExp(/(alt=")(.+?)(")/);var arr = str.match(pat);if(arr!==null){alt = arr[2].toString();}return alt;}function is_href(str){var pat = new RegExp(/http.*\/\/.*/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function is_tag(str){var pat = new RegExp(/<.+>/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function is_id(str){var pat = new RegExp(/id="*.*"*/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function is_name(str){var pat = new RegExp(/name="*.*"*/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function is_onclick(str){var pat = new RegExp(/(onclick=".+?"|onClick=".+"?)/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function is_button(str){var pat = new RegExp(/(type="*submit"*|type="*image"*|type="*button"*|type="*reset"*)/);var arr = str.match(pat);if(arr!==null){return true;}else{return false;}}function get_prompt(descript){var str = "";str = prompt(descript);return str;}})();



//JIS番号を選択
javascript:(function(){
	var guideline_id="7.3.3.2";
	var pat = new RegExp(guideline_id);
	var gds = document.getElementById("guideline");
	for(var i=0; i<gds.options.length; i++){
		var row = gds.options[i].text;
		if(row.match(pat)!==null){
			gds.selectedIndex = i;
			var event = document.createEvent("HTMLEvents");
			event.initEvent("change", true, false);
			gds.dispatchEvent(event);
		}
	}
})();

//JIS番号選択ブックマークレット生成
javascript:(function(){
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>GL-Selecttor</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%; margin-top:0;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('textarea {width:480px; font-size:80%; height: 8em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function create_bkm(){');
		d.writeln('var src = document.getElementById("tar_gd");');
		d.writeln('var idx = src.selectedIndex;');
		d.writeln('var guideline_id = src.options[idx].value;');
		d.writeln('var str = "";');
		d.writeln('str += "javascript:(function(){";');
		d.writeln('str += \'var pat = new RegExp("\' + guideline_id + \'");\';');
		d.writeln('str += \'var gds = document.getElementById("guideline");\';');
		d.writeln('str += \'for(var i=0; i<gds.options.length; i++){\';');
		d.writeln('str += "var row = gds.options[i].text;";');
		d.writeln('str += "if(row.match(pat)!==null){";');
		d.writeln('str += "gds.selectedIndex = i;";');
		d.writeln('str += \'var event = document.createEvent("HTMLEvents");\';');
		d.writeln('str += \'event.initEvent("change", true, false);\';');
		d.writeln('str += "gds.dispatchEvent(event);";');
		d.writeln('str += "break;";');
		d.writeln('str += "}";');
		d.writeln('str += "}";');
		d.writeln('str += "})();";');
		d.writeln('document.getElementById("bkm").value = str;');
		d.writeln('}');
		d.writeln('function delete_text(){');
		d.writeln('document.getElementById("bkm").value = "";');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>Guideline Selector</h1>');
		d.writeln('<label for="tar_gd">JIS番号</label>');
		d.writeln('<select id="tar_gd"></select>');
		d.writeln('<button onclick="create_bkm()">Create</button>');
		d.writeln('<button onclick="delete_text()">Delete</button><br>');
		d.writeln('<textarea id="bkm"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
		var arr = [
			"7.1.1.1",
			"7.1.2.1",
			"7.1.2.2",
			"7.1.2.3",
			"7.1.2.4",
			"7.1.2.5",
			"7.1.3.1",
			"7.1.3.2",
			"7.1.3.3",
			"7.1.4.1",
			"7.1.4.2",
			"7.1.4.3",
			"7.1.4.4",
			"7.1.4.5",
			"7.2.1.1",
			"7.2.1.2",
			"7.2.2.1",
			"7.2.2.2",
			"7.2.3.1",
			"7.2.4.1",
			"7.2.4.2",
			"7.2.4.3",
			"7.2.4.4",
			"7.2.4.5",
			"7.2.4.6",
			"7.2.4.7",
			"7.3.1.1",
			"7.3.1.2",
			"7.3.2.1",
			"7.3.2.2",
			"7.3.2.3",
			"7.3.2.4",
			"7.3.3.1",
			"7.3.3.2",
			"7.3.3.3",
			"7.3.3.4",
			"7.4.1.1",
			"7.4.1.2"
		];
		var element = d.getElementById("tar_gd");
		for(var i=0; i<arr.length; i++){
			var row = arr[i].toString();
			var opt = d.createElement("option");
			opt.setAttribute("value", row);
			opt.textContent = row;
			element.appendChild(opt);
		}
	}
})();

javascript:(function(){trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>GL-Selecttor</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%; margin-top:0;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('textarea {width:480px; font-size:80%; height: 8em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function create_bkm(){');d.writeln('var src = document.getElementById("tar_gd");');d.writeln('var idx = src.selectedIndex;');d.writeln('var guideline_id = src.options[idx].value;');d.writeln('var str = "";');d.writeln('str += "javascript:(function(){";');d.writeln('str += \'var pat = new RegExp("\' + guideline_id + \'");\';');d.writeln('str += \'var gds = document.getElementById("guideline");\';');d.writeln('str += \'for(var i=0; i<gds.options.length; i++){\';');d.writeln('str += "var row = gds.options[i].text;";');d.writeln('str += "if(row.match(pat)!==null){";');d.writeln('str += "gds.selectedIndex = i;";');d.writeln('str += \'var event = document.createEvent("HTMLEvents");\';');d.writeln('str += \'event.initEvent("change", true, false);\';');d.writeln('str += "gds.dispatchEvent(event);";');d.writeln('str += "break;";');d.writeln('str += "}";');d.writeln('str += "}";');d.writeln('str += "})();";');d.writeln('document.getElementById("bkm").value = str;');d.writeln('}');d.writeln('function delete_text(){');d.writeln('document.getElementById("bkm").value = "";');d.writeln('}');d.writeln('</script>');d.writeln('<h1>Guideline Selector</h1>');d.writeln('<label for="tar_gd">JIS番号</label>');d.writeln('<select id="tar_gd"></select>');d.writeln('<button onclick="create_bkm()">Create</button>');d.writeln('<button onclick="delete_text()">Delete</button><br>');d.writeln('<textarea id="bkm"></textarea>');d.writeln('</body>');d.writeln('</html>');var arr = ["7.1.1.1","7.1.2.1","7.1.2.2","7.1.2.3","7.1.2.4","7.1.2.5","7.1.3.1","7.1.3.2","7.1.3.3","7.1.4.1","7.1.4.2","7.1.4.3","7.1.4.4","7.1.4.5","7.2.1.1","7.2.1.2","7.2.2.1","7.2.2.2","7.2.3.1","7.2.4.1","7.2.4.2","7.2.4.3","7.2.4.4","7.2.4.5","7.2.4.6","7.2.4.7","7.3.1.1","7.3.1.2","7.3.2.1","7.3.2.2","7.3.2.3","7.3.2.4","7.3.3.1","7.3.3.2","7.3.3.3","7.3.3.4","7.4.1.1","7.4.1.2"];var element = d.getElementById("tar_gd");for(var i=0; i<arr.length; i++){var row = arr[i].toString();var opt = d.createElement("option");opt.setAttribute("value", row);opt.textContent = row;element.appendChild(opt);}}})();


//実装番号選択ブックマークレット生成
javascript:(function(){
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>TC-Selecttor</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%; margin-top:0;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('#tar_tc {width: 70px;}');
		d.writeln('textarea {width:480px; font-size:80%; height: 8em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function create_bkm(){');
		d.writeln('var tech_id = document.getElementById("tar_tc").value;');
		d.writeln('var str = "";');
		d.writeln('str += "javascript:(function(){";');
		d.writeln('str += \'var tech = document.getElementById("techList");\';');
		d.writeln('str += \'var pat = new RegExp(/.*\' + tech_id + \'/);\';');
		d.writeln('str += "for(var i=0; i<tech.options.length; i++){";');
		d.writeln('str += "var row = tech.options[i].text;";');
		d.writeln('str += "if(row.match(pat)!==null){";');
		d.writeln('str += "tech.selectedIndex = i;";');
		d.writeln('str += \'var event = document.createEvent("HTMLEvents");\';');
		d.writeln('str += \'event.initEvent("change", true, false);\';');
		d.writeln('str += "tech.dispatchEvent(event);";');
		d.writeln('str += "break;";');
		d.writeln('str += "}";');
		d.writeln('str += "}";');
		d.writeln('str += "})();";');
		d.writeln('document.getElementById("bkm").value = str;');
		d.writeln('}');
		d.writeln('function delete_text(){');
		d.writeln('document.getElementById("bkm").value = "";');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>Technique Selector</h1>');
		d.writeln('<label for="tar_tc">実装番号</label>');
		d.writeln('<input type="text" id="tar_tc">');
		d.writeln('<button onclick="create_bkm()">Create</button>');
		d.writeln('<button onclick="delete_text()">Delete</button><br>');
		d.writeln('<textarea id="bkm"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
	}
})();


javascript:(function(){trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>TC-Selecttor</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%; margin-top:0;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('#tar_tc {width: 70px;}');d.writeln('textarea {width:480px; font-size:80%; height: 8em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function create_bkm(){');d.writeln('var tech_id = document.getElementById("tar_tc").value;');d.writeln('var str = "";');d.writeln('str += "javascript:(function(){";');d.writeln('str += \'var tech = document.getElementById("techList");\';');d.writeln('str += \'var pat = new RegExp(/.*\' + tech_id + \'/);\';');d.writeln('str += "for(var i=0; i<tech.options.length; i++){";');d.writeln('str += "var row = tech.options[i].text;";');d.writeln('str += "if(row.match(pat)!==null){";');d.writeln('str += "tech.selectedIndex = i;";');d.writeln('str += \'var event = document.createEvent("HTMLEvents");\';');d.writeln('str += \'event.initEvent("change", true, false);\';');d.writeln('str += "tech.dispatchEvent(event);";');d.writeln('str += "break;";');d.writeln('str += "}";');d.writeln('str += "}";');d.writeln('str += "})();";');d.writeln('document.getElementById("bkm").value = str;');d.writeln('}');d.writeln('function delete_text(){');d.writeln('document.getElementById("bkm").value = "";');d.writeln('}');d.writeln('</script>');d.writeln('<h1>Technique Selector</h1>');d.writeln('<label for="tar_tc">実装番号</label>');d.writeln('<input type="text" id="tar_tc">');d.writeln('<button onclick="create_bkm()">Create</button>');d.writeln('<button onclick="delete_text()">Delete</button><br>');d.writeln('<textarea id="bkm"></textarea>');d.writeln('</body>');d.writeln('</html>');}})();


//次のJIS番号を選択
javascript:(function(){
	var type = "c";/*c:complete uc:un-complete*/
	var gds = document.getElementById("guideline");
	var min = 0;
	var max = gds.options.length;
	var idx = gds.selectedIndex;
	if(type=="uc"){
		select_next(idx);
	}else{
		select_normal_next();
	}
	function select_normal_next(){
		idx++;
		if(!is_max_ov(idx)){
			gds.selectedIndex = idx;
			var event = document.createEvent("HTMLEvents");
			event.initEvent("change", true, false);
			gds.dispatchEvent(event);
		}else{
			alert("これ以上進めません！");
		}
	}
	function select_next(num){
		num++;
		if(!is_max_ov(num)){
			var next_str = gds.options[num].text;
			var pat = new RegExp(/【完】.*/);
			var arr = next_str.match(pat);
			if(arr!==null){
				select_next(num);
			}else{
				gds.selectedIndex = num;
				var event = document.createEvent("HTMLEvents");
				event.initEvent("change", true, false);
				gds.dispatchEvent(event);
			}
		}else{
			alert("これ以上進めません！");
		}
	}
	function is_max_ov(num){
		if(num >= max){
			return true;
		}else{
			return false;
		}
	}
})();

javascript:(function(){var type = "c";/*c:complete uc:un-complete*/var gds = document.getElementById("guideline");var min = 0;var max = gds.options.length;var idx = gds.selectedIndex;if(type=="uc"){select_next(idx);}else{select_normal_next();}function select_normal_next(){idx++;if(!is_max_ov(idx)){gds.selectedIndex = idx;var event = document.createEvent("HTMLEvents");event.initEvent("change", true, false);gds.dispatchEvent(event);}else{alert("これ以上進めません！");}}function select_next(num){num++;if(!is_max_ov(num)){var next_str = gds.options[num].text;var pat = new RegExp(/【完】.*/);var arr = next_str.match(pat);if(arr!==null){select_next(num);}else{gds.selectedIndex = num;var event = document.createEvent("HTMLEvents");event.initEvent("change", true, false);gds.dispatchEvent(event);}}else{alert("これ以上進めません！");}}function is_max_ov(num){if(num >= max){return true;}else{return false;}}})();


//前のJIS番号を選択
javascript:(function(){
	var gds = document.getElementById("guideline");
	var min = 0;
	var max = gds.options.length;
	var idx = gds.selectedIndex;
	select_prev();
	function select_prev(){
		idx--;
		if(!is_min_ov(idx)){
			gds.selectedIndex = idx;
			var event = document.createEvent("HTMLEvents");
			event.initEvent("change", true, false);
			gds.dispatchEvent(event);
		}else{
			alert("これ以上戻れません！");
		}
	}
	function is_min_ov(num){
		if(num <= min){
			return true;
		}else{
			return false;
		}
	}
})();

javascript:(function(){var gds = document.getElementById("guideline");var min = 0;var max = gds.options.length;var idx = gds.selectedIndex;select_prev();function select_prev(){idx--;if(!is_min_ov(idx)){gds.selectedIndex = idx;var event = document.createEvent("HTMLEvents");event.initEvent("change", true, false);gds.dispatchEvent(event);}else{alert("これ以上戻れません！");}}function is_min_ov(num){if(num <= min){return true;}else{return false;}}})();

//次の実装番号を選択
javascript:(function(){
	var type="uc";/*c:complete uc:un-complete*/
	var tech = document.getElementById("techList");
	var min = 0;
	var max = tech.options.length;
	var idx = tech.selectedIndex;
	if(type=="uc"){
		select_next(idx);
	}else{
		select_normal_next();
	}
	function select_normal_next(){
		idx++;
		if(!is_max_ov(idx)){
			tech.selectedIndex = idx;
			var event = document.createEvent("HTMLEvents");
			event.initEvent("change", true, false);
			tech.dispatchEvent(event);
		}else{
			alert("これ以上進めません！");
		}
	}
	function select_next(num){
		num++;
		if(!is_max_ov(num)){
			var next_str = tech.options[num].text;
			var pat = new RegExp(/【完】.*/);
			var arr = next_str.match(pat);
			if(arr!==null){
				select_next(num);
			}else{
				tech.selectedIndex = num;
				var event = document.createEvent("HTMLEvents");
				event.initEvent("change", true, false);
				tech.dispatchEvent(event);
			}
		}else{
			alert("これ以上進めません！");
		}
	}
	function is_max_ov(num){
		if(num >= max){
			return true;
		}else{
			return false;
		}
	}
})();

javascript:(function(){var type="uc";/*c:complete uc:un-complete*/var tech = document.getElementById("techList");var min = 0;var max = tech.options.length;var idx = tech.selectedIndex;if(type=="uc"){select_next(idx);}else{select_normal_next();}function select_normal_next(){idx++;if(!is_max_ov(idx)){tech.selectedIndex = idx;var event = document.createEvent("HTMLEvents");event.initEvent("change", true, false);tech.dispatchEvent(event);}else{alert("これ以上進めません！");}}function select_next(num){num++;if(!is_max_ov(num)){var next_str = tech.options[num].text;var pat = new RegExp(/【完】.*/);var arr = next_str.match(pat);if(arr!==null){select_next(num);}else{tech.selectedIndex = num;var event = document.createEvent("HTMLEvents");event.initEvent("change", true, false);tech.dispatchEvent(event);}}else{alert("これ以上進めません！");}}function is_max_ov(num){if(num >= max){return true;}else{return false;}}})();


//Br挿入
javascript:(function(){
	br_insert("comments");
	function get_caret(target){
		var ta = document.getElementById(target);
		var start = ta.selectionStart;
		return start;
	}
	function text_insert(target, str){
		var ta = document.getElementById(target);
		var taval = ta.value;
		var caret = get_caret(target);
		var first2caret = taval.substring(0, caret);
		var caret2end = taval.substring(caret, taval.length);
		var rdmstr = first2caret + str + caret2end;
		ta.value = rdmstr;
	}
	function br_insert(target){
		text_insert(target, "\n");
	}
})();

javascript:(function(){br_insert("comments");function get_caret(target){var ta = document.getElementById(target);var start = ta.selectionStart;return start;}function text_insert(target, str){var ta = document.getElementById(target);var taval = ta.value;var caret = get_caret(target);var first2caret = taval.substring(0, caret);var caret2end = taval.substring(caret, taval.length);var rdmstr = first2caret + str + caret2end;ta.value = rdmstr;}function br_insert(target){text_insert(target, "\n");}})();



//ローカルソースを別タブで
javascript:(function(){
	var src = document.getElementById("source").innerHTML;
	src = src.replace(/<br>/g, "");
	src = src.replace(/&lt;/g, "<");
	src = src.replace(/&gt;/g, ">");
	trgr();
	function trgr(){
		d = window.open().document;
		d.writeln('<!DOCTYPE html><html lang="ja"><head>');
		d.writeln('<meta charset="utf-8"><title>Source</title>');
		d.writeln('<style>');
		d.writeln('textarea {width:100%; height:25em;}');
		d.writeln('</style></head>');
		d.writeln('<body></body></html>');
		var bd = d.getElementsByTagName("body").item(0);
		var ta = d.createElement("textarea");
		ta.setAttribute("id", "source");
		ta.textContent = src;
		bd.appendChild(ta);
		var cta = d.getElementById("source");
		cta.focus();
		cta.select();
	}
})();

javascript:(function(){var src = document.getElementById("source").innerHTML;src = src.replace(/<br>/g, "");src = src.replace(/&lt;/g, "<");src = src.replace(/&gt;/g, ">");trgr();function trgr(){d = window.open().document;d.writeln('<!DOCTYPE html><html lang="ja"><head>');d.writeln('<meta charset="utf-8"><title>Source</title>');d.writeln('<style>');d.writeln('textarea {width:100%; height:25em;}');d.writeln('</style></head>');d.writeln('<body></body></html>');var bd = d.getElementsByTagName("body").item(0);var ta = d.createElement("textarea");ta.textContent = src;bd.appendChild(ta);}})();

//w3cを別タブで
javascript:(function(){window.open("http://validator.w3.org/#validate_by_input");})();


//W3Cのエラー数を別タブで選択状態で開く
javascript:(function(){
	var tbl = document.getElementsByTagName("table").item(0);
	var tr = tbl.rows;
	var td = tr.item(0).cells.item(1).innerHTML;
	td = clean(td);
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">');
		d.writeln('<title>Result:</title></head></body>');
		d.writeln('<textarea id="result" style="width:450px;height:4em">'+td+'</textarea>');
		d.writeln('</body></html>');
		var ta = d.getElementById("result");
		ta.focus();
		ta.select();
	}
	function clean(str){
	    str=str.replace(/^ +/m,"");
	    str=str.replace(/  +/mg,"");
	    str=str.replace(/\t+/mg,"");
	    str=str.replace(/(\r\n|\r|\n)/g,""); 
	    return str;
	}
})();

javascript:(function(){var tbl = document.getElementsByTagName("table").item(0);var tr = tbl.rows;var td = tr.item(0).cells.item(1).innerHTML;td = clean(td);trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">');d.writeln('<title>Result:</title></head></body>');d.writeln('<textarea id="result" style="width:450px;height:4em">'+td+'</textarea>');d.writeln('</body></html>');var ta = d.getElementById("result");ta.focus();ta.select();}function clean(str){str=str.replace(/^ +/m,"");str=str.replace(/  +/mg,"");str=str.replace(/\t+/mg,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;}})();



//labelサーチ
javascript:(function(){
	var tag = document.getElementsByTagName("label");
	var tartag = tag.item(0);
	for(var i=0; i<tag.length; i++){
		var tartag = tag.item(i);
		var tartag_for = tag.item(i).getAttribute("for");
		var span = document.createElement("span");
		span.innerHTML = "label";
		if(tartag_for!==null){
			span.setAttribute("style", "background:#FFFF00;font-size:80%;padding:1px;");
		}else{
			span.setAttribute("style", "background:#C00000;color:#ffffff;font-size:80%;padding:1px;");	
		}
		tartag.insertBefore(span, tartag.firstChild.nextSibling);
	}
})();

javascript:(function(){var tag = document.getElementsByTagName("label");var tartag = tag.item(0);for(var i=0; i<tag.length; i++){var tartag = tag.item(i);var tartag_for = tag.item(i).getAttribute("for");var span = document.createElement("span");span.innerHTML = "label";if(tartag_for!==null){span.setAttribute("style", "background:#FFFF00;font-size:80%;padding:1px;");}else{span.setAttribute("style", "background:#C00000;color:#ffffff;font-size:80%;padding:1px;");	}tartag.insertBefore(span, tartag.firstChild.nextSibling);}})();


//検索エラー不適合判定
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){
			return document.getElementById("comments").value;
		},
		set_comment: function(str){
			document.getElementById("comments").value = str;
		},
		get_description: function(){
			return document.getElementById("description").value;
		},
		set_description: function(str){
			document.getElementById("description").value = str;
		},
		get_srccode: function(){
			return document.getElementById("srccode").value;
		},
		set_srccode: function(str){
			document.getElementById("srccode").value = str;
		},
		click_for: function(flag) {
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].value;
				if(obj==flag){
					form.elements[i].click();
					break;
				}
			}
		},
		click_for_submit: function(){
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].type;
				if(obj=="submit"){
					form.elements[i].click();
					break;
				}
			}
		},
		text_clean: function(str){
		    str=str.replace(/^ +/m,"");
		    str=str.replace(/\t+/m,"");
		    str=str.replace(/(\r\n|\r|\n)/g,""); 
		    return str;
		},
		set_height: function(tg, ht){
			var src = document.getElementById(tg);
			src.setAttribute("style", "height:"+ht+"em;");
		}
	};
	/* Dialog Class End */
	var MyDiag = Object(Diag);
	MyDiag.click_for("FAIL");
	MyDiag.set_comment("キーワード空で検索実行してもエラーが表示されない");
	var srccode = MyDiag.get_srccode();
	srccode = '<span class="hidden">キーワードを空で検索実行しても検索結果は表示されません</span>\n'+srccode;
	MyDiag.set_srccode(srccode);
	MyDiag.set_height("srccode", "15");
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},set_height: function(tg, ht){var src = document.getElementById(tg);src.setAttribute("style", "height:"+ht+"em;");}};/* Dialog Class End */var MyDiag = Object(Diag);MyDiag.click_for("FAIL");MyDiag.set_comment("キーワード空で検索実行してもエラーが表示されない");var srccode = MyDiag.get_srccode();srccode = '<span class="hidden">キーワードを空で検索実行しても検索結果は表示されません</span>\n'+srccode;MyDiag.set_srccode(srccode);MyDiag.set_height("srccode", "15");})();

//IFC1019コメント自動化
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){
			return document.getElementById("comments").value;
		},
		set_comment: function(str){
			document.getElementById("comments").value = str;
		},
		get_description: function(){
			return document.getElementById("description").value;
		},
		set_description: function(str){
			document.getElementById("description").value = str;
		},
		get_srccode: function(){
			return document.getElementById("srccode").value;
		},
		set_srccode: function(str){
			document.getElementById("srccode").value = str;
		},
		click_for: function(flag) {
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].value;
				if(obj==flag){
					form.elements[i].click();
					break;
				}
			}
		},
		click_for_submit: function(){
			var form=document.forms["diag_form"];
			for(var i=0;i<form.elements.length;i++){
				var obj=form.elements[i].type;
				if(obj=="submit"){
					form.elements[i].click();
					break;
				}
			}
		},
		text_clean: function(str){
		    str=str.replace(/^ +/m,"");
		    str=str.replace(/\t+/m,"");
		    str=str.replace(/(\r\n|\r|\n)/g,""); 
		    return str;
		},
		set_height: function(tg, ht){
			var src = document.getElementById(tg);
			src.setAttribute("style", "height:"+ht+"em;");
		}
	};
	/* Dialog Class End */
	var MyDiag = Object(Diag);
	var result = prompt("エラー数を入力");
	MyDiag.click_for("FAIL");
	MyDiag.set_comment("バリデートエラーあり "+result);
	MyDiag.set_srccode("");
	MyDiag.click_for_submit();
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},set_height: function(tg, ht){var src = document.getElementById(tg);src.setAttribute("style", "height:"+ht+"em;");}};/* Dialog Class End */var MyDiag = Object(Diag);var result = prompt("エラー数を入力");MyDiag.click_for("FAIL");MyDiag.set_comment("バリデートエラーあり "+result);MyDiag.set_srccode("");MyDiag.click_for_submit();})();


//一括検査画面出す
javascript:(function(){
	var parent = document.getElementById("all_btn");
	var child = parent.childNodes;
	child[0].click();
})();

javascript:(function(){var parent = document.getElementById("all_btn");var child = parent.childNodes;child[0].click();})();

//事前検証登録ボタンクリック
javascript:(function(){
	document.getElementById("entry").click();
})();

javascript:(function(){document.getElementById("entry").click();})();

//URLをプロンプトで
javascript:(function(){
	var urlval="";
	var url="";
	var element=document.getElementById("urlList");
	for(var i=0;i<element.options.length;i++){
		if(element.options[i].selected){
			urlval=element.options[i].text;
			break;
		}
	}
	var a1=urlval.match(/http.*\/\/.*/);
	url=a1[0].toString();
	prompt("URL",url);
})();

javascript:(function(){var urlval="";var url="";var element=document.getElementById("urlList");for(var i=0;i<element.options.length;i++){if(element.options[i].selected){urlval=element.options[i].text;break;}}var a1=urlval.match(/http.*\/\/.*/);url=a1[0].toString();prompt("URL",url);})();


//GMailタイトル
javascript:(function(){
	var str = "";
	var h2s = document.getElementsByTagName("h2");
	for(var i=0; i < h2s.length; i++){
		var row = h2s.item(i);
		if(i == (h2s.length - 1)){
			str += row.innerHTML;
		}
	}
	str = str.replace(/(:|=)/mg, "");
	str = str.replace(/：/mg, "");
	str = str.replace(/<wbr>/mg, "");
	prompt("メールタイトル",str);
})();

javascript:(function(){var str = "";var h2s = document.getElementsByTagName("h2");for(var i=0; i < h2s.length; i++){var row = h2s.item(i);if(i == (h2s.length - 1)){str += row.innerHTML;}}str = str.replace(/(:|=)/mg, "");str = str.replace(/：/mg, "");str = str.replace(/<wbr>/mg, "");prompt("メールタイトル",str);})();


//labelタグ生成
javascript:(function(){
	var str = prompt("id属性値は？");
	str = '<label for="' + str + '"></label>';
	prompt("メールタイトル",str);
})();

javascript:(function(){var str = prompt("id属性値は？");str = '<label for="' + str + '"></label>';prompt("メールタイトル",str);})();


//W3C Comment Editor の ClearAllTextを実行
javascript:(function(){
	var btns = document.getElementsByTagName("button");
	for(var i=0; i<btns.length; i++){
		var tag = btns.item(i);
		if(tag.textContent=="ClearAllText"){
			tag.click();
			break;
		}
	}
	window.scroll(0, 0);
})();

javascript:(function(){var btns = document.getElementsByTagName("button");for(var i=0; i<btns.length; i++){var tag = btns.item(i);if(tag.textContent=="ClearAllText"){tag.click();break;}}window.scroll(0, 0);})();


//判定結果複写
javascript:(function(){
	/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},};	/* Dialog Class End */
	var hash = {
		PASS: "適合",
		PASS2: "適合(注記)",
		FAIL: "不適合",
		NA: "非適用"
	};
	var dg = Object(Diag);
	var txt = prompt("判定結果～修正ソースコードまでコピーして貼り付けてください");
	var arr = txt.split("\n");
	var str_sv = "";
	var str_flg = "";
	var str_comment = "";
	var str_description = "";
	var str_srccode = "";
	if(arr != null){
		str_sv = arr[1].toString();
		str_sv = str_sv.trim();
		for(var key in hash){
			if(str_sv == hash[key]){
				str_flg = key;
			}
		}
		str_comment = arr[3].toString();
		str_description = arr[5].toString().trim();
		str_srccode = arr[7].toString().trim();
		dg.click_for(str_flg);
		dg.set_comment(str_comment);
		if(str_description!="なし"){dg.set_description(str_description);}
		if(str_srccode!="なし"){dg.set_srccode(str_srccode);}
		dg.click_for_submit();
	}
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},};	/* Dialog Class End */var hash = {PASS: "適合",PASS2: "適合(注記)",FAIL: "不適合",NA: "非適用"};var dg = Object(Diag);var txt = prompt("判定結果～修正ソースコードまでコピーして貼り付けてください");var arr = txt.split("\n");var str_sv = "";var str_flg = "";var str_comment = "";var str_description = "";var str_srccode = "";if(arr != null){str_sv = arr[1].toString();str_sv = str_sv.trim();for(var key in hash){if(str_sv == hash[key]){str_flg = key;}}str_comment = arr[3].toString();str_description = arr[5].toString().trim();str_srccode = arr[7].toString().trim();dg.click_for(str_flg);dg.set_comment(str_comment);if(str_description!="なし"){dg.set_description(str_description);}if(str_srccode!="なし"){dg.set_srccode(str_srccode);}dg.click_for_submit();}})();

//IFC2001など、その場でコード置換
javascript:(function(){
	/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},};	/* Dialog Class End */
	var dg = Object(Diag);
	dg.click_for("FAIL");
	var hmtl = "";
	var src = prompt("置換前セル|置換後セルを入力");
	var code = dg.get_srccode();
	src = src.trim();
	code = code.trim();
	var tmp = src.split("|");
	if(tmp != null){
		var bft = tmp[0].toString();
		var aft = tmp[1].toString();
		var pat = new RegExp(bft, "ig");
		html = code.replace(pat, aft);
		dg.set_srccode(html);
	}
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},};	/* Dialog Class End */var dg = Object(Diag);dg.click_for("FAIL");var hmtl = "";var src = prompt("置換前セル|置換後セルを入力");var code = dg.get_srccode();src = src.trim();code = code.trim();var tmp = src.split("|");if(tmp != null){var bft = tmp[0].toString();var aft = tmp[1].toString();var pat = new RegExp(bft, "ig");html = code.replace(pat, aft);dg.set_srccode(html);}})();

//WP_ 見出し挿入
javascript:(function(){
	var level = prompt("見出しレベルを半角数字で入力","4");
	var text = "<h" + level + ">" + "</h" + level + ">";
	text_insert('content', text);
	function get_caret(target){
		var ta = document.getElementById(target);
		var start = ta.selectionStart;
		return start;
	}
	function text_insert(target, str){
		var ta = document.getElementById(target);
		var taval = ta.value;
		var caret = get_caret(target);
		var first2caret = taval.substring(0, caret);
		var caret2end = taval.substring(caret, taval.length);
		var rdmstr = first2caret + str + caret2end;
		ta.value = rdmstr;
	}
})();

javascript:(function(){var level = prompt("見出しレベルを半角数字で入力","4");var text = "<h" + level + ">" + "</h" + level + ">";text_insert('content', text);function get_caret(target){var ta = document.getElementById(target);var start = ta.selectionStart;return start;}function text_insert(target, str){var ta = document.getElementById(target);var taval = ta.value;var caret = get_caret(target);var first2caret = taval.substring(0, caret);var caret2end = taval.substring(caret, taval.length);var rdmstr = first2caret + str + caret2end;ta.value = rdmstr;}})();

//WP_画像の2列レイアウト
javascript:(function(){
	var tag = '<div class="photo-2-col">'+"\r\n";
	tag += '<div class="left">'+"\r\n";
	tag += '(ここに写真挿入)'+"\r\n";
	tag += '<span>写真説明：</span>'+"\r\n";
	tag += '</div>'+"\r\n";
	tag += '<div class="right">'+"\r\n";
	tag += '(ここに写真挿入)'+"\r\n";
	tag += '<span>写真説明：</span>'+"\r\n";
	tag += '</div>'+"\r\n";
	tag += '</div>';
	text_insert('content', tag);
	function get_caret(target){
		var ta = document.getElementById(target);
		var start = ta.selectionStart;
		return start;
	}
	function text_insert(target, str){
		var ta = document.getElementById(target);
		var taval = ta.value;
		var caret = get_caret(target);
		var first2caret = taval.substring(0, caret);
		var caret2end = taval.substring(caret, taval.length);
		var rdmstr = first2caret + str + caret2end;
		ta.value = rdmstr;
	}
})();

javascript:(function(){var tag = '<div class="photo-2-col">'+"\r\n";tag += '<div class="left">'+"\r\n";tag += '(ここに写真挿入)'+"\r\n";tag += '<span>写真説明：</span>'+"\r\n";tag += '</div>'+"\r\n";tag += '<div class="right">'+"\r\n";tag += '(ここに写真挿入)'+"\r\n";tag += '<span>写真説明：</span>'+"\r\n";tag += '</div>'+"\r\n";tag += '</div>';text_insert('content', tag);function get_caret(target){var ta = document.getElementById(target);var start = ta.selectionStart;return start;}function text_insert(target, str){var ta = document.getElementById(target);var taval = ta.value;var caret = get_caret(target);var first2caret = taval.substring(0, caret);var caret2end = taval.substring(caret, taval.length);var rdmstr = first2caret + str + caret2end;ta.value = rdmstr;}})();


//WP_画像の1列レイアウト
javascript:(function(){
	var tp="left";
	var tag = '<div class="photo-1-'+tp+'">'+"\r\n";
	tag += '(ここに写真挿入)'+"\r\n";
	tag += '<span>写真説明：</span>'+"\r\n";
	tag += '</div>'+"\r\n";
	text_insert('content', tag);
	function get_caret(target){
		var ta = document.getElementById(target);
		var start = ta.selectionStart;
		return start;
	}
	function text_insert(target, str){
		var ta = document.getElementById(target);
		var taval = ta.value;
		var caret = get_caret(target);
		var first2caret = taval.substring(0, caret);
		var caret2end = taval.substring(caret, taval.length);
		var rdmstr = first2caret + str + caret2end;
		ta.value = rdmstr;
	}
})();

javascript:(function(){var tp="left";var tag = '<div class="photo-1-'+tp+'">'+"\r\n";tag += '(ここに写真挿入)'+"\r\n";tag += '<span>写真説明：</span>'+"\r\n";tag += '</div>'+"\r\n";text_insert('content', tag);function get_caret(target){var ta = document.getElementById(target);var start = ta.selectionStart;return start;}function text_insert(target, str){var ta = document.getElementById(target);var taval = ta.value;var caret = get_caret(target);var first2caret = taval.substring(0, caret);var caret2end = taval.substring(caret, taval.length);var rdmstr = first2caret + str + caret2end;ta.value = rdmstr;}})();

//Skypeコメントエディタ
javascript:(function(){
	trgr();
	function trgr(){
		var d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>SKYPE-CE</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%; margin-top:0;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('#comments,#comments2 {min-width: 320px;}');
		d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');
		d.writeln('#ta_after_searchword,#ta_after_replaceword,#ta_sub_searchword,#ta_sub_replaceword{width:89px;margin:5px 0;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function clean_text(){');
		d.writeln('var text = "";');
		d.writeln('var src = document.getElementById("ta_before").value;');
		d.writeln('var pat1 = new RegExp(/^\\[([0-9]+:+)+[0-9]+\\] +(.+?): +/mg);');
		d.writeln('if(reg_search(pat1, src)){');
		d.writeln('text = src.replace(pat1, "");');
		d.writeln('}');
		d.writeln('var pat2 = new RegExp(/^\\[[0-9]{4}\\/[0-9]{2}\\/[0-9]{2} +([0-9]+:+)+[0-9]+\\] +(.+?): +/mg);');
		d.writeln('if(reg_search(pat2, src)){');
		d.writeln('text = src.replace(pat2, "");');
		d.writeln('}');
		d.writeln('var pat3 = new RegExp(/^\\[[0-9]{4}\\/[0-9]{2}\\/[0-9]{2} +([0-9]+:+)+[0-9]+\\] +\\*{3} (.+?)\\*{3}/mg);');
		d.writeln('if(reg_search(pat3, text)){');
		d.writeln('text = text.replace(pat3, "");');
		d.writeln('}');
		d.writeln('if(text == "") text_insert("ta_after", src);');
		d.writeln('else text_insert("ta_after", text);');
		d.writeln('}');
		d.writeln('function reg_search(pat, src){');
		d.writeln('if(src.match(pat) == null) return false;');
		d.writeln('else return true;');
		d.writeln('}');
		d.writeln('function br2_delete(target){');
		d.writeln('var src = document.getElementById(target).value;');
		d.writeln('src = clean(src);');
		d.writeln('src = src.replace(/\\n{2}/mg, "\\n");');
		d.writeln('document.getElementById(target).value=src;');
		d.writeln('}');
		d.writeln('function get_caret(target){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var start = ta.selectionStart;');
		d.writeln('return start;');
		d.writeln('}');
		d.writeln('function text_insert(target, str){');
		d.writeln('var ta = document.getElementById(target);');
		d.writeln('var taval = ta.value;');
		d.writeln('var caret = get_caret(target);');
		d.writeln('var first2caret = taval.substring(0, caret);');
		d.writeln('var caret2end = taval.substring(caret, taval.length);');
		d.writeln('var rdmstr = first2caret + str + caret2end;');
		d.writeln('ta.value = rdmstr;');
		d.writeln('}');
		d.writeln('function br_insert(target){');
		d.writeln('text_insert(target, "\\n");');
		d.writeln('}');
		d.writeln('function delete_this_text(target){');
		d.writeln('document.getElementById(target).value="";');
		d.writeln('}');
		d.writeln('function clean(str){');
		d.writeln('str=str.replace(/^ +/mg,"");');
		d.writeln('str=str.replace(/^\\t+/mg,"");');
		d.writeln('return str;');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>Skype Comment-Editor</h1>');
		d.writeln('<label for="ta_before"><strong>Before Text:</strong></label>');
		d.writeln('<button onclick="clean_text()">CleanText</button>');
		d.writeln('<button onclick="br_insert(\'ta_before\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_before"></textarea>');
		d.writeln('<br>');
		d.writeln('<label for="ta_after"><strong>After Text:</strong></label>');
		d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');
		d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');
		d.writeln('<br>');
		d.writeln('<textarea id="ta_after"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
	}
})();

javascript:(function(){trgr();function trgr(){var d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>SKYPE-CE</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%; margin-top:0;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('#comments,#comments2 {min-width: 320px;}');d.writeln('#ta_before,#ta_after,#ta_sub {font-size:80%; width:100%; max-width:800px; height: 15em;}');d.writeln('#ta_after_searchword,#ta_after_replaceword,#ta_sub_searchword,#ta_sub_replaceword{width:89px;margin:5px 0;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function clean_text(){');d.writeln('var text = "";');d.writeln('var src = document.getElementById("ta_before").value;');d.writeln('var pat1 = new RegExp(/^\\[([0-9]+:+)+[0-9]+\\] +(.+?): +/mg);');d.writeln('if(reg_search(pat1, src)){');d.writeln('text = src.replace(pat1, "");');d.writeln('}');d.writeln('var pat2 = new RegExp(/^\\[[0-9]{4}\\/[0-9]{2}\\/[0-9]{2} +([0-9]+:+)+[0-9]+\\] +(.+?): +/mg);');d.writeln('if(reg_search(pat2, src)){');d.writeln('text = src.replace(pat2, "");');d.writeln('}');d.writeln('var pat3 = new RegExp(/^\\[[0-9]{4}\\/[0-9]{2}\\/[0-9]{2} +([0-9]+:+)+[0-9]+\\] +\\*{3} (.+?)\\*{3}/mg);');d.writeln('if(reg_search(pat3, text)){');d.writeln('text = text.replace(pat3, "");');d.writeln('}');d.writeln('if(text == "") text_insert("ta_after", src);');d.writeln('else text_insert("ta_after", text);');d.writeln('}');d.writeln('function reg_search(pat, src){');d.writeln('if(src.match(pat) == null) return false;');d.writeln('else return true;');d.writeln('}');d.writeln('function br2_delete(target){');d.writeln('var src = document.getElementById(target).value;');d.writeln('src = clean(src);');d.writeln('src = src.replace(/\\n{2}/mg, "\\n");');d.writeln('document.getElementById(target).value=src;');d.writeln('}');d.writeln('function get_caret(target){');d.writeln('var ta = document.getElementById(target);');d.writeln('var start = ta.selectionStart;');d.writeln('return start;');d.writeln('}');d.writeln('function text_insert(target, str){');d.writeln('var ta = document.getElementById(target);');d.writeln('var taval = ta.value;');d.writeln('var caret = get_caret(target);');d.writeln('var first2caret = taval.substring(0, caret);');d.writeln('var caret2end = taval.substring(caret, taval.length);');d.writeln('var rdmstr = first2caret + str + caret2end;');d.writeln('ta.value = rdmstr;');d.writeln('}');d.writeln('function br_insert(target){');d.writeln('text_insert(target, "\\n");');d.writeln('}');d.writeln('function delete_this_text(target){');d.writeln('document.getElementById(target).value="";');d.writeln('}');d.writeln('function clean(str){');d.writeln('str=str.replace(/^ +/mg,"");');d.writeln('str=str.replace(/^\\t+/mg,"");');d.writeln('return str;');d.writeln('}');d.writeln('</script>');d.writeln('<h1>Skype Comment-Editor</h1>');d.writeln('<label for="ta_before"><strong>Before Text:</strong></label>');d.writeln('<button onclick="clean_text()">CleanText</button>');d.writeln('<button onclick="br_insert(\'ta_before\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_before\')">Clear</button>');d.writeln('<br>');d.writeln('<textarea id="ta_before"></textarea>');d.writeln('<br>');d.writeln('<label for="ta_after"><strong>After Text:</strong></label>');d.writeln('<button onclick="br2_delete(\'ta_after\')">BrDel</button>');d.writeln('<button onclick="br_insert(\'ta_after\')">Br</button>');d.writeln('<button onclick="delete_this_text(\'ta_after\')">Clear</button>');d.writeln('<br>');d.writeln('<textarea id="ta_after"></textarea>');d.writeln('</body>');d.writeln('</html>');}})();

//HTML属性をstyle属性へ
javascript:(function(){
	var rdsrc = "";
	var src = prompt("処理文字列をペースト");
	var pat = new RegExp(/(.+?)=\"(.+?)\"/);
	var arr = src.match(pat);
	if(arr != null){
		var attrname = arr[1].toString();
		var attrval = arr[2].toString();
		rdsrc = 'style="' + attrname + ': url(' + attrval + ');"';
		prompt("処理後文字列", rdsrc);
	}
})();

javascript:(function(){var rdsrc = "";var src = prompt("処理文字列をペースト");var pat = new RegExp(/(.+?)=\"(.+?)\"/);var arr = src.match(pat);if(arr != null){var attrname = arr[1].toString();var attrval = arr[2].toString();rdsrc = 'style="' + attrname + ': url(' + attrval + ');"';prompt("処理後文字列", rdsrc);}})();

//テーブルクリエーター
javascript:(function() {
	trgr();
	function trgr() {
		d = window.open().document;
		d.writeln('<!DOCTYPE html>');
		d.writeln('<html lang="ja">');
		d.writeln('<head>');
		d.writeln('<meta charset="utf-8">');
		d.writeln('<title>TABLE CL</title>');
		d.writeln('<style type="text/css">');
		d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');
		d.writeln('h1 {font-size: 170%; margin-top:0;}');
		d.writeln('label {font-size: 90%; margin-right: 10px;}');
		d.writeln('#comments,#comments2 {min-width: 320px;}');
		d.writeln('#coln,#rown {width: 22px;}');
		d.writeln('#ta_main {font-size:80%; width:100%; max-width:800px; height: 15em;}');
		d.writeln('</style>');
		d.writeln('</head>');
		d.writeln('<body>');
		d.writeln('<script type="text/javascript">');
		d.writeln('function delete_this_text(target) {');
		d.writeln('document.getElementById(target).value = "";');
		d.writeln('}');
		d.writeln('function create() {');
		d.writeln('var coln = parseInt(document.getElementById("coln").value);');
		d.writeln('var rown = parseInt(document.getElementById("rown").value);');
		d.writeln('var titlechk = document.getElementById("titlechk").value;');
		d.writeln('var classnm = document.getElementById("classnm").value;');
		d.writeln('var html = "";');
		d.writeln('html += "<table";');
		d.writeln('if (classnm != "") {');
		d.writeln('html += \' class="\' + classnm + \'"\';');
		d.writeln('}');
		d.writeln('html += ">\\r\\n";');
		d.writeln('if (titlechk == "yes") {');
		d.writeln('html += "  <tr>\\r\\n";');
		d.writeln('for (var i = 0; i < coln; i++) {');
		d.writeln('html += "    <th></th>\\r\\n";');
		d.writeln('}');
		d.writeln('html += "  </tr>\\r\\n";');
		d.writeln('rown -= 1;');
		d.writeln('}');
		d.writeln('for (var i = 0; i < rown; i++) {');
		d.writeln('html += "  <tr>\\r\\n";');
		d.writeln('for (var j = 0; j < coln; j++) {');
		d.writeln('html += "    <td></td>\\r\\n";');
		d.writeln('}');
		d.writeln('html += "  </tr>\\r\\n";');
		d.writeln('}');
		d.writeln('html += "</table>\\r\\n";');
		d.writeln('document.getElementById("ta_main").value = html;');
		d.writeln('');
		d.writeln('}');
		d.writeln('</script>');
		d.writeln('<h1>Table Creator</h1>');
		d.writeln('<label>行数：<input type="text" id="rown"></label>');
		d.writeln('<label>列数：<input type="text" id="coln"></label>');
		d.writeln('<label><input type="checkbox" id="titlechk" value="yes">タイトル行</label>');
		d.writeln('<label>クラス名：<input type="text" id="classnm" size="8"></label>');
		d.writeln('<button onclick="create()">Create</button>');
		d.writeln('<button onclick="delete_this_text(\'ta_main\')">Delete</button>');
		d.writeln('<textarea id="ta_main"></textarea>');
		d.writeln('</body>');
		d.writeln('</html>');
	}
})();

javascript:(function() {trgr();function trgr() {d = window.open().document;d.writeln('<!DOCTYPE html>');d.writeln('<html lang="ja">');d.writeln('<head>');d.writeln('<meta charset="utf-8">');d.writeln('<title>TABLE CL</title>');d.writeln('<style type="text/css">');d.writeln('* {font-family: "メイリオ",Meiryo,sans-serif;}');d.writeln('h1 {font-size: 170%; margin-top:0;}');d.writeln('label {font-size: 90%; margin-right: 10px;}');d.writeln('#comments,#comments2 {min-width: 320px;}');d.writeln('#coln,#rown {width: 22px;}');d.writeln('#ta_main {font-size:80%; width:100%; max-width:800px; height: 15em;}');d.writeln('</style>');d.writeln('</head>');d.writeln('<body>');d.writeln('<script type="text/javascript">');d.writeln('function delete_this_text(target) {');d.writeln('document.getElementById(target).value = "";');d.writeln('}');d.writeln('function create() {');d.writeln('var coln = parseInt(document.getElementById("coln").value);');d.writeln('var rown = parseInt(document.getElementById("rown").value);');d.writeln('var titlechk = document.getElementById("titlechk").value;');d.writeln('var classnm = document.getElementById("classnm").value;');d.writeln('var html = "";');d.writeln('html += "<table";');d.writeln('if (classnm != "") {');d.writeln('html += \' class="\' + classnm + \'"\';');d.writeln('}');d.writeln('html += ">\\r\\n";');d.writeln('if (titlechk == "yes") {');d.writeln('html += "  <tr>\\r\\n";');d.writeln('for (var i = 0; i < coln; i++) {');d.writeln('html += "    <th></th>\\r\\n";');d.writeln('}');d.writeln('html += "  </tr>\\r\\n";');d.writeln('rown -= 1;');d.writeln('}');d.writeln('for (var i = 0; i < rown; i++) {');d.writeln('html += "  <tr>\\r\\n";');d.writeln('for (var j = 0; j < coln; j++) {');d.writeln('html += "    <td></td>\\r\\n";');d.writeln('}');d.writeln('html += "  </tr>\\r\\n";');d.writeln('}');d.writeln('html += "</table>\\r\\n";');d.writeln('document.getElementById("ta_main").value = html;');d.writeln('');d.writeln('}');d.writeln('</script>');d.writeln('<h1>Table Creator</h1>');d.writeln('<label>行数：<input type="text" id="rown"></label>');d.writeln('<label>列数：<input type="text" id="coln"></label>');d.writeln('<label><input type="checkbox" id="titlechk" value="yes">タイトル行</label>');d.writeln('<label>クラス名：<input type="text" id="classnm" size="8"></label>');d.writeln('<button onclick="create()">Create</button>');d.writeln('<button onclick="delete_this_text(\'ta_main\')">Delete</button>');d.writeln('<textarea id="ta_main"></textarea>');d.writeln('</body>');d.writeln('</html>');}})();


//コメント自動修正
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){
			return document.getElementById("comments").value;
		},
		set_comment: function(str){
			document.getElementById("comments").value = str;
		},
		get_description: function(){
			return document.getElementById("description").value;
		},
		set_description: function(str){
			document.getElementById("description").value = str;
		},
		get_srccode: function(){
			return document.getElementById("srccode").value;
		},
		set_srccode: function(str){
			document.getElementById("srccode").value = str;
		},
		text_clean: function(str){
		    str=str.replace(/^ +/m,"");
		    str=str.replace(/\t+/m,"");
		    str=str.replace(/(\r\n|\r|\n)/g,""); 
		    return str;
		},
	};
	/* Dialog Class End */
	var MyDiag = Object(Diag);
	var src = MyDiag.get_comment();
	src = MyDiag.text_clean(src);
	var pat = new RegExp("該当箇所","mg");
	src = src.replace(pat, "");
	var pat2 = new RegExp(/:1/mg);
	var arr = src.match(pat2);
	src = src.replace(pat2, arr[0].toString() + "\r\n");
	MyDiag.set_comment(src);
})();


javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},};/* Dialog Class End */var MyDiag = Object(Diag);var src = MyDiag.get_comment();src = MyDiag.text_clean(src);var pat = new RegExp("該当箇所","mg");src = src.replace(pat, "");var pat2 = new RegExp(/:1/mg);var arr = src.match(pat2);src = src.replace(pat2, arr[0].toString() + "\r\n");MyDiag.set_comment(src);})();

//不適合修正ソースなし
javascript:(function(){
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){return document.getElementById("comments").value;},
		set_comment: function(str){document.getElementById("comments").value = str;},
		get_description: function(){return document.getElementById("description").value;},
		set_description: function(str){document.getElementById("description").value = str;},
		get_srccode: function(){return document.getElementById("srccode").value;},
		set_srccode: function(str){document.getElementById("srccode").value = str;},
		click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},
		click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},
		text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},
	};
	/* Dialog Class End */
	var MyDiag = Object(Diag);
	MyDiag.click_for("FAIL");
	MyDiag.set_srccode("");
})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},};/* Dialog Class End */var MyDiag = Object(Diag);MyDiag.click_for("FAIL");MyDiag.set_srccode("");})();

//titleタグを空にする
javascript:(function(){
	var type="nl"; /*nl=null nnl=not null */
	/* Dialog Class Start */
	var Diag = {
		get_comment: function(){return document.getElementById("comments").value;},
		set_comment: function(str){document.getElementById("comments").value = str;},
		get_description: function(){return document.getElementById("description").value;},
		set_description: function(str){document.getElementById("description").value = str;},
		get_srccode: function(){return document.getElementById("srccode").value;},
		set_srccode: function(str){document.getElementById("srccode").value = str;},
		click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},
		click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},
		text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},
	};
	/* Dialog Class End */
	var MyDiag = Object(Diag);
	var src = MyDiag.get_srccode();
	src = MyDiag.text_clean(src);
	switch(type){
		case "nl":
			src = src.replace(/ title=""/mg, "");
			break;
		case "nnl":
			src = src.replace(/ title=".*?"/mg, "");
			break;
		default:
			break;
	}
	MyDiag.set_srccode(src);
})();

javascript:(function(){var type="nl"; /*nl=null nnl=not null *//* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},};/* Dialog Class End */var MyDiag = Object(Diag);var src = MyDiag.get_srccode();src = MyDiag.text_clean(src);switch(type){case "nl":src = src.replace(/ title=""/mg, "");break;case "nnl":src = src.replace(/ title=".*?"/mg, "");break;default:break;}MyDiag.set_srccode(src);})();

javascript:(function(){/* Dialog Class Start */var Diag = {get_comment: function(){return document.getElementById("comments").value;},set_comment: function(str){document.getElementById("comments").value = str;},get_description: function(){return document.getElementById("description").value;},set_description: function(str){document.getElementById("description").value = str;},get_srccode: function(){return document.getElementById("srccode").value;},set_srccode: function(str){document.getElementById("srccode").value = str;},click_for: function(flag) {var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].value;if(obj==flag){form.elements[i].click();break;}}},click_for_submit: function(){var form=document.forms["diag_form"];for(var i=0;i<form.elements.length;i++){var obj=form.elements[i].type;if(obj=="submit"){form.elements[i].click();break;}}},text_clean: function(str){str=str.replace(/^ +/m,"");str=str.replace(/\t+/m,"");str=str.replace(/(\r\n|\r|\n)/g,""); return str;},};/* Dialog Class End */var MyDiag = Object(Diag);MyDiag.click_for("FAIL");MyDiag.set_comment("代替えテキストと同じテキストが直後に掲載、重複している");var src = MyDiag.get_srccode();src = MyDiag.text_clean(src);src = src.replace(/ alt=".*?"/mg, ' alt=""');MyDiag.set_srccode(src);})();

//判定結果確認用【次のページを選択】
javascript:(function(){
	var gds = document.getElementById("page_id");
	var min = 0;
	var max = gds.options.length;
	var idx = gds.selectedIndex;
	select_normal_next();
	document.getElementsByTagName("button").item(0).click();
	function select_normal_next(){
		idx++;
		if(!is_max_ov(idx)){
			gds.selectedIndex = idx;
			var event = document.createEvent("HTMLEvents");
			event.initEvent("change", true, false);
			gds.dispatchEvent(event);
		}else{
			alert("これ以上進めません！");
		}
	}
	function is_max_ov(num){
		if(num >= max){
			return true;
		}else{
			return false;
		}
	}
})();

javascript:(function(){var gds = document.getElementById("page_id");var min = 0;var max = gds.options.length;var idx = gds.selectedIndex;select_normal_next();document.getElementsByTagName("button").item(0).click();function select_normal_next(){idx++;if(!is_max_ov(idx)){gds.selectedIndex = idx;var event = document.createEvent("HTMLEvents");event.initEvent("change", true, false);gds.dispatchEvent(event);}else{alert("これ以上進めません！");}}function is_max_ov(num){if(num >= max){return true;}else{return false;}}})();


//KTaeraトップページ用
javascript:(function(){
	var filename = prompt("画像ファイル名を指定してください", "top-antique-2015-x.jpg");
	var srctag = document.getElementById("hello");
	var childs = srctag.childNodes;
	var ptag = childs[1];
	var inchilds = ptag.childNodes;
	var imgtag = inchilds[0];
	imgtag.setAttribute("src", "tmp/tmpimg/" + filename);
	imgtag.removeAttribute("height", "");
})();

javascript:(function(){var filename = prompt("画像ファイル名を指定してください", "top-antique-2015-x.jpg");var srctag = document.getElementById("hello");var childs = srctag.childNodes;var ptag = childs[1];var inchilds = ptag.childNodes;var imgtag = inchilds[0];imgtag.setAttribute("src", "tmp/tmpimg/" + filename);imgtag.removeAttribute("height", "");})();


//他の達成基準への判定ラジオボタン選択
javascript:(function(){
	var syrds = document.getElementsByName("copy");
	if(syrds!=="undefined") {
		for(var i=0; i<syrds.length; i++){
			var syvl = syrds[i].value;
			if(syvl==result_sync_val){
				syrds[i].click();
				break;
			}
		}
	}
})();

var syrds = document.getElementsByName("copy");if(syrds!=="undefined") {for(var i=0; i<syrds.length; i++){var syvl = syrds[i].value;if(syvl==result_sync_val){syrds[i].click();break;}}}
